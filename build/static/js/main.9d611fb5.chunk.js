(this.webpackJsonplevels=this.webpackJsonplevels||[]).push([[0],{40:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var o=n(9),a=null,r=function(e){return function(t){return e[t]=e[t]||[]}},i=a=a||function(){var e={};return{emit:function(t){return function(n){return r(e)(t).forEach((function(e){return e(n)}))}},subscribe:function(t){return function(n){return r(e)(t).push(n),function(){return e[t]=e[t].filter((function(e){return e!==n}))}}},showAll:function(){var t={};for(var n in e)t[n]=e[n].length;console.log(t)}}}(),l=function(e){return{startPlay:function(){return e({type:"CHANGE_ENVIRONMENT",newQuadrant:[0,-1,-50],environmentMode:"outer"})},showBackground:function(){return e({type:"CHANGE_ENVIRONMENT",newQuadrant:[0,-1,-50],environmentMode:"back"})},startFinalFog:function(){return e({type:"CHANGE_ENVIRONMENT",newQuadrant:[0,-1,-50],environmentMode:"start"})}}},s=function(e){return{clickFullScreen:function(){e({type:"CLICK_FULL_SCREEN"})},exitFullScreen:function(){e({type:"EXIT_FULL_SCREEN"})}}},c=function(e){return{clickInfo:function(t){e({type:"INFO_TOGGLE",mode:t})}}},u=function(e){return{clickPhrase:function(t){e({type:"CLICK_PHRASE",phrase:t}),setTimeout((function(){e({type:"PHRASE_EVENT",phrase:t}),t.levelEvent&&i.emit("changeLevelMode")(t.levelEvent)}),1e3)},toggleDialog:function(t){e({type:"TOGGLE_DIALOG",isDialog:t})},toggleButtonDialog:function(t){e({type:"TOGGLE_BUTTON",isButtonDialog:t})}}},d=n(5),p=Object(o.b)((function(e){return{userReplicies:e.app.ui.userReplicies}}))((function(e){return Object(d.jsx)("div",{className:"userReplicies",children:e.userReplicies.map((function(t){return Object(d.jsx)("button",{onClick:function(){u(e.dispatch).clickPhrase(t)},children:t.q},Math.floor(1e5*Math.random()))}))})})),f=Object(o.b)((function(e){return{botAnswers:e.app.ui.botAnswers}}))((function(e){return Object(d.jsx)("div",{className:"botAnswers",children:e.botAnswers.map((function(e){return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"q",children:e.q}),Object(d.jsx)("div",{className:"a",children:e.a})]},Math.floor(1e5*Math.random()))}))})})),m={ru:{"open dialog":"\u043d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","close dialog":"\u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","To be continued":"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u0435 \u0441\u043b\u0435\u0434\u0443\u0435\u0442",chapter:"\u0433\u043b\u0430\u0432\u0430","After a long wandering in the desert...":"\u041f\u043e\u0441\u043b\u0435 \u0434\u043e\u043b\u0433\u043e\u0433\u043e \u0431\u043b\u0443\u0436\u0434\u0430\u043d\u0438\u044f \u043f\u043e \u043f\u0443\u0441\u0442\u043e\u0448\u0438...","Stranger, I threw you a terminal with a pass phrase. Remember:":"\u041d\u0435\u0437\u043d\u0430\u043a\u043e\u043c\u0435\u0446, \u044f \u0441\u0431\u0440\u043e\u0441\u0438\u043b \u0442\u0435\u0431\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0441 \u043f\u0430\u0440\u043e\u043b\u044c\u043d\u043e\u0439 \u0444\u0440\u0430\u0437\u043e\u0439. \u0417\u0430\u043f\u043e\u043c\u043d\u0438:","And blood-black nothingness began to spin...":"\u041a\u0440\u043e\u0432\u0430\u0432\u043e-\u0447\u0435\u0440\u043d\u043e\u0435 \u043d\u0438\u0447\u0442\u043e \u043f\u0443\u0441\u0442\u0438\u043b\u043e\u0441\u044c \u0432\u0438\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043b\u0435\u0442\u043e\u043a,","A system of cells interlinked within cells interlinked within cells interlinked within one stem...":"\u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438, \u043a\u043b\u0435\u0442\u043e\u043a, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438, \u043a\u043b\u0435\u0442\u043e\u043a \u0432 \u0435\u0434\u0438\u043d\u043e\u043c \u0441\u0442\u0435\u0431\u043b\u0435 \u0438 \u044f\u0432\u0441\u0442\u0432\u0435\u043d\u043d\u043e,","And dreadfully distinct against the dark, a tall white fountain played.":"\u0434\u043e \u0436\u0443\u0442\u0438 \u043d\u0430 \u0444\u043e\u043d\u0435 \u0442\u044c\u043c\u044b \u0432\u0432\u044b\u0441\u044c \u0431\u0435\u043b\u044b\u043c \u0431\u0438\u043b \u0444\u043e\u043d\u0442\u0430\u043d.","Officer K-D-six-dash-three-dot-seven, let's begin. Ready?":"\u041e\u0444\u0438\u0446\u0435\u0440 \u041a\u0435\u0439 \u0414\u0438 6.3.7. \u043f\u0440\u0438\u0441\u0442\u0443\u043f\u0438\u043c. \u0413\u043e\u0442\u043e\u0432\u044b?","Yes, sir.":"\u0413\u043e\u0442\u043e\u0432","No.":"\u041d\u0435 \u0433\u043e\u0442\u043e\u0432","Recite your baseline.":"\u0412\u0430\u0448\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u0430\u044f \u0444\u0440\u0430\u0437\u0430.","I do not remember.":"\u042f \u0437\u0430\u0431\u044b\u043b.","I'll come back later.":"\u042f \u0437\u0430\u0439\u0434\u0443 \u043f\u043e\u043f\u043e\u0437\u0436\u0435.","Cells.":"\u041a\u043b\u0435\u0442\u043a\u0438.","Have you ever been in an institution? Cells.":"\u0414\u043e\u0432\u043e\u0434\u0438\u043b\u043e\u0441\u044c \u043b\u0438 \u0432\u0430\u043c \u0431\u044b\u0432\u0430\u0442\u044c \u0432 \u0442\u044e\u0440\u044c\u043c\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","Do they keep you in a cell? Cells.":"\u0412\u0430\u0441 \u0434\u0435\u0440\u0436\u0430\u0442 \u0432 \u043a\u043b\u0435\u0442\u043a\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","When you're not performing your duties do they keep you in a little box? Cells.":"\u041a\u043e\u0433\u0434\u0430 \u0432\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0435 \u043e\u0431\u044f\u0437\u0430\u043d\u043d\u043e\u0441\u0442\u0438, \u0432\u0430\u0441 \u0434\u0435\u0440\u0436\u0430\u0442 \u0432 \u043a\u043e\u0440\u043e\u0431\u043a\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","Interlinked.":"\u0421\u0432\u044f\u0437\u0430\u043d\u044b.","What's it like to hold the hand of someone you love? Interlinked.":"\u0427\u0442\u043e \u0432\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435 \u0434\u0435\u0440\u0436\u0430 \u0437\u0430 \u0440\u0443\u043a\u0443 \u0442\u043e\u0433\u043e \u043a\u043e\u0433\u043e \u043b\u044e\u0431\u0438\u0442\u0435? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Did they teach you how to feel finger to finger? Interlinked.":"\u0412\u0430\u0441 \u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u0438\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0430\u043b\u0435\u0446 \u043a \u043f\u0430\u043b\u044c\u0446\u0443? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you long for having your heart interlinked? Interlinked.":"\u0412\u044b \u0436\u0430\u0436\u0434\u0435\u0442\u0435 \u0441\u0432\u044f\u0437\u0430\u0442\u044c \u0441 \u043a\u0435\u043c-\u043d\u0438\u0431\u0443\u0434\u044c \u0441\u0435\u0440\u0434\u0446\u0435? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you dream about being interlinked? Interlinked.":"\u0412\u0430\u043c \u0441\u043d\u0438\u0442\u0441\u044f \u0441\u0432\u044f\u0437\u044c \u0441 \u043a\u0435\u043c-\u043b\u0438\u0431\u043e? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","What's it like to hold your child in your arms? Interlinked.":"\u0427\u0442\u043e \u0432\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435, \u0434\u0435\u0440\u0436\u0430 \u0432 \u0440\u0443\u043a\u0430\u0445 \u0441\u0432\u043e\u0435\u0433\u043e \u0440\u0435\u0431\u0435\u043d\u043a\u0430? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you feel that there's a part of you that's missing? Interlinked.":"\u0412\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435, \u0447\u0442\u043e \u0432\u0430\u043c \u0447\u0435\u0433\u043e-\u0442\u043e \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Within cells interlinked.":"\u041a\u043b\u0435\u0442\u043e\u043a \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438.","Why don't you say that three times: Within cells interlinked.":'\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0442\u0440\u0438 \u0440\u0430\u0437\u0430 "\u043a\u043b\u0435\u0442\u043e\u043a \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438',"We're done... Constant K, you can pick up your bonus.":"\u041d\u0430 \u044d\u0442\u043e\u043c \u0432\u0441\u0435. \u041a\u0435\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u0435\u043d, \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u043e\u0439\u0442\u0438 \u0437\u0430 \u0431\u043e\u043d\u0443\u0441\u043e\u043c.","Thank you, sir.":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0441\u044d\u0440.","...If you read it, you find dropped terminal and got top level of desert. Welcome...":"...\u0415\u0441\u043b\u0438 \u0442\u044b \u0447\u0438\u0442\u0430\u0435\u0448\u044c \u044d\u0442\u043e, \u0442\u044b \u043d\u0430\u0448\u0435\u043b \u0443\u043f\u0430\u0432\u0448\u0438\u0439 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0438 \u0434\u043e\u0431\u0440\u0430\u043b\u0441\u044f \u0434\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u043f\u0443\u0441\u0442\u043e\u0448\u0438.","Who are you?":"\u041a\u0442\u043e \u0442\u044b?","It does not matter. Later. May be..":"\u042d\u0442\u043e \u043d\u0435\u0432\u0430\u0436\u043d\u043e. \u041f\u043e\u0437\u0436\u0435. \u041c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c..","Hey...":"\u042d\u0439...",open:"\u043f\u0443\u0441\u043a","Previous part: ":"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u0447\u0430\u0441\u0442\u044c: ","Author: ":"\u0410\u0432\u0442\u043e\u0440: ",link:"\u0441\u0441\u044b\u043b\u043a\u0430"}},h="en";i.subscribe("setLanguage")((function(e){h=e}));var v=function(e){return m[h]&&m[h][e]||e};var b={dispatch:null},g=Object(o.b)((function(e){return{isButtonDialog:e.app.ui.isButtonDialog,isDialog:e.app.ui.isDialog,isShowClickFullScreen:e.app.ui.isShowButtFullScreen,isShowInfo:e.app.ui.isShowInfo,isShowFinalMessage:e.app.ui.isShowFinalMessage}}))((function(e){return!b.dispatch&&(b.dispatch=e.dispatch),Object(d.jsxs)("div",{className:"ui",children:[e.isButtonDialog&&Object(d.jsx)("button",{className:"butt-toggleDialog",onClick:function(){u(e.dispatch).toggleDialog(!e.isDialog)},children:e.isDialog?v("close dialog"):v("open dialog")}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-left control",onMouseDown:function(){return i.emit("mouseDown")("butt-left")},onTouchStart:function(){return i.emit("mouseDown")("butt-left")},onMouseUp:function(){return i.emit("mouseUp")("butt-left")},onTouchEnd:function(){return i.emit("mouseUp")("butt-left")},children:"\u25c4"}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-right control",onMouseDown:function(){return i.emit("mouseDown")("butt-right")},onTouchStart:function(){return i.emit("mouseDown")("butt-right")},onMouseUp:function(){return i.emit("mouseUp")("butt-right")},onTouchEnd:function(){return i.emit("mouseUp")("butt-right")},children:"\u25ba"}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-front control",onMouseDown:function(){return i.emit("mouseDown")("butt-front")},onTouchStart:function(){return i.emit("mouseDown")("butt-front")},onMouseUp:function(){return i.emit("mouseUp")("butt-front")},onTouchEnd:function(){return i.emit("mouseUp")("butt-front")},children:"\u25b2"}),!e.isDialog&&e.isShowClickFullScreen&&Object(d.jsx)("button",{className:"butt-fullscreen control",onClick:function(){i.emit("mouseDown")("butt-fullscreen"),s(e.dispatch).clickFullScreen()},children:"\u2752"}),!e.isDialog&&!e.isShowInfo&&Object(d.jsx)("button",{className:"butt-info control",onClick:function(){return c(e.dispatch).clickInfo(!0)},children:"i"}),e.isDialog&&Object(d.jsx)("div",{className:"dialog",children:Object(d.jsxs)("div",{className:"dialog-inner",children:[Object(d.jsx)(f,{}),Object(d.jsx)(p,{})]})}),e.isShowFinalMessage&&Object(d.jsx)("div",{className:"info",children:Object(d.jsx)("div",{className:"info-inner final-message",children:Object(d.jsx)("p",{children:v("To be continued")})})}),e.isShowInfo&&Object(d.jsx)("div",{className:"info",children:Object(d.jsxs)("div",{className:"info-inner",children:[Object(d.jsx)("button",{className:"control butt-infoClose",onClick:function(){return c(e.dispatch).clickInfo(!1)},children:"x"}),Object(d.jsxs)("p",{children:["1 ".concat(v("chapter"),": "),Object(d.jsx)("a",{href:"http://js.otrisovano.ru/factory/",target:"blank",children:v("link")})]}),Object(d.jsxs)("p",{children:["2 ".concat(v("chapter"),": "),Object(d.jsx)("a",{href:"http://js.otrisovano.ru/bridge/",target:"blank",children:v("link")})]}),Object(d.jsxs)("p",{children:[Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),v("Author: "),Object(d.jsx)("a",{href:"http://otrisovano.ru",target:"blank",children:v("link")})]}),Object(d.jsxs)("p",{children:[v("Github: "),Object(d.jsx)("a",{href:"https://github.com/fire888/levels/",target:"blank",children:v("link")})]})]})})]})}));function y(e){var t={up:!1,left:!1,right:!1,s:!1,m:!1,w:!1},n=function(n,o){switch(n){case 38:t.up=o;break;case 37:t.left=o;break;case 39:t.right=o;break;case 83:t.s=o;break;case 77:t.m=o;break;case 87:t.w=o}e.emit("keyEvent")(t)};document.addEventListener("keydown",(function(e){return n(e.keyCode,!0)})),document.addEventListener("keyup",(function(e){return n(e.keyCode,!1)})),e.subscribe("mouseDown")((function(e){"butt-left"===e&&n(37,!0),"butt-right"===e&&n(39,!0),"butt-front"===e&&n(38,!0)})),e.subscribe("mouseUp")((function(e){"butt-left"===e&&n(37,!1),"butt-right"===e&&n(39,!1),"butt-front"===e&&n(38,!1)}))}var _=n(43),w=n.p+"static/media/px.2be78f43.jpg",N=n.p+"static/media/nx.b2401269.jpg",O=n.p+"static/media/py.659ebc34.jpg",j=n.p+"static/media/ny.462f1251.jpg",S=n.p+"static/media/pz.8ea5ba14.jpg",E=n.p+"static/media/nz.7f255b96.jpg",A=n.p+"static/media/posx.be2d83a2.jpg",k=n.p+"static/media/negx.d016c8e7.jpg",M=n.p+"static/media/posy.01cfd221.jpg",D=n.p+"static/media/negy.f01f8356.jpg",R=n.p+"static/media/posz.ef37b8e1.jpg",x=n.p+"static/media/negz.f346a80a.jpg",C=n.p+"static/media/level-rooms.5251ade2.obj",T=n.p+"static/media/floor_outer_map.35e50f6e.jpg",I=n.p+"static/media/botMap.972e276e.png",F=[{type:"obj",filename:C,key:"level-rooms"},{type:"glb",filename:n.p+"static/media/botAnim2.47b6030d.glb",key:"bot"},{type:"cubeTextures",filename:{px:w,nx:N,py:O,ny:j,pz:S,nz:E},key:"skyBox"},{type:"cubeTextures",filename:{px:A,nx:k,py:M,ny:D,pz:R,nz:x},key:"ironEnv"},{type:"img",filename:I,key:"botMap"},{type:"img",filename:T,key:"mapFloorOuter",wrap:!0}],L={iron:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:13192,specular:16777215,shininess:60,bumpMap:"botMap",bumpScale:.1,envMap:"ironEnv",reflectivity:.5,map:"botMap",skinning:!0}},wall:{mat:"MeshPhongMaterial",props:{color:17510,emissive:16777215,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5,specular:2236962}},green:{mat:"MeshPhongMaterial",props:{color:17510,emissive:16777215,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5}},road:{mat:"MeshPhongMaterial",props:{color:10556063,emissive:10556063,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5}}},Q=175.335,G="FRAME_UPDATE",Y={"-2":{outer:{fogNear:-200,fogFar:500,color:1582461},corridorLight:{fogNear:-40,fogFar:150,color:7012460},default:{fogNear:-40,fogFar:150,color:8914344}},"-1":{start:{fogNear:0,fogFar:5,color:1582461},outer:{fogNear:20,fogFar:500,color:1582461},back:{fogNear:20,fogFar:500,color:1582461,backgroundImgKey:"skyBox"},firstRoomLight:{fogNear:-40,fogFar:150,color:9054},corridorLight:{fogNear:-40,fogFar:150,color:7012460},default:{fogNear:-40,fogFar:150,color:3019147}},0:{default:{fogNear:-40,fogFar:150,color:3950848}},1:{default:{fogNear:-40,fogFar:150,color:933458}},2:{default:{fogNear:0,fogFar:80,color:661347}},3:{default:{fogNear:0,fogFar:80,color:680768}},4:{default:{fogNear:0,fogFar:80,color:11272192}}},q={canId:"webgl-canvas",rendererCon:{antialias:!0},clearColor:Y[-1].outer.color,backgroundColor:Y[-1].outer.color,amb:{color:Y[-1].outer.color,strength:.7}},P={speed:.8,speedRot:.02,speedDown:-.45,offsetFromFloor:10,offsetFromFloorFactor:.5,offsetWallCollision:3.5,level:-13,startRot:[0,0,0],startPos:[100,-60,1e3],cameraData:{fov:90,ratio:window.innerWidth/window.innerHeight,near:.1,far:1e3,pos:[0,2,-.5]},frontObjPos:[0,0,-1],lightDataOne:{color:16777215,strength:5e3,pos:[0,50,5]}};var U,B,K,H,W=n(7),z=n(3),V=[{oldState:"outer",newState:"corridor",oldQuadrant:[0,-2,4],newQuadrant:[0,-2,3],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"corridorLight",backgroundImg:!1}]},{oldState:"corridor",newState:"outer",oldQuadrant:[0,-2,3],newQuadrant:[0,-2,4],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"outer"}]},{oldState:"corridor",newState:"firstRoom",oldQuadrant:[0,-1,2],newQuadrant:[0,-1,1],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"firstRoomLight"}]},{oldState:"firstRoom",newState:"corridor",oldQuadrant:[0,-1,1],newQuadrant:[0,-1,2],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"corridorLight"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:[0,-1,"ANY_MINUS_ONE"],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:["ANY_MINUS_ONE",-1,0],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:["ANY_PLUS_ONE",-1,0],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY_PLUS_ONE","ANY"],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"default"},{emitKey:"CHANGE_QUADRANT",counter:function(){return 0}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY_MINUS_ONE","ANY"],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"default"},{emitKey:"CHANGE_QUADRANT",counter:function(){return 100}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY","ANY_MINUS_ONE"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY_MINUS_ONE","ANY","ANY"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY_PLUS_ONE","ANY","ANY"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY","ANY_PLUS_ONE"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]}],X="outer",J=function(e,t){for(var n=0;n<V.length;++n){var o=Z(Object(W.a)(e),Object(W.a)(t),Object(z.a)(Object(z.a)({},V[n]),{},{oldQuadrant:Object(W.a)(V[n].oldQuadrant),newQuadrant:Object(W.a)(V[n].newQuadrant)}));if(o)return o}return{levelState:X}},Z=function(e,t,n){var o=n.oldState,a=n.newState,r=n.oldQuadrant,i=n.newQuadrant,l=n.emitData;if(X===o&&("ANY"===r[0]&&(r[0]=e[0]),"ANY"===r[1]&&(r[1]=e[1]),"ANY"===r[2]&&(r[2]=e[2]),"ANY"===i[0]&&(i[0]=t[0]),"ANY"===i[1]&&(i[1]=t[1]),"ANY"===i[2]&&(i[2]=t[2]),"ANY_PLUS_ONE"===i[0]&&(i[0]=e[0]+1),"ANY_PLUS_ONE"===i[1]&&(i[1]=e[1]+1),"ANY_PLUS_ONE"===i[2]&&(i[2]=e[2]+1),"ANY_MINUS_ONE"===i[0]&&(i[0]=e[0]-1),"ANY_MINUS_ONE"===i[1]&&(i[1]=e[1]-1),"ANY_MINUS_ONE"===i[2]&&(i[2]=e[2]-1),r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]))return X=a,l.map((function(e){return Object(z.a)(Object(z.a)({},e),{},{levelState:X,oldQuadrant:Object(W.a)(r),newQuadrant:Object(W.a)(i)})}))},$=function(){var e=[];return{update:function(t){var n=t.x,o=t.y,a=t.z,r=[Math.floor(n/Q),Math.floor(o/70),Math.floor(a/Q)];if(r[0]!==e[0]||r[1]!==e[1]||r[2]!==e[2]){var i={isChanged:!0,currentQuadrant:r,oldQuadrant:e};return e=[].concat(r),i}return{isChanged:!1}}}},ee=n(0),te=n(22),ne=n(23),oe=null,ae=null,re={},ie=0,le=function(e){"obj"===e.type&&U.load(e.filename,(function(t){re[e.key]=t,se()})),"glb"!==e.type&&"gltf"!==e.type||K.load(e.filename,(function(t){re[e.key]=t,se()})),"img"===e.type&&B.load(e.filename,(function(t){re[e.key]=t,se()})),"cubeTextures"===e.type&&H.load([e.filename.px,e.filename.nx,e.filename.py,e.filename.ny,e.filename.pz,e.filename.nz],(function(t){re[e.key]=t,se()}))},se=function(){++ie<ae.length?le(ae[ie]):oe(re)};var ce=function(e){for(var t in e)e[t].wrapS&&(e[t].wrapS=e[t].wrapT=ee.RepeatWrapping);var n=["bumpMap","envMap","map","normalMap","lightMap","aoMap"],o={},a=function(t){o[t]=new ee[L[t].mat](Object(z.a)({},L[t].props)),n.map((function(n){return L[t].props[n]&&(o[t][n]=e[L[t].props[n]])}))};for(var r in L)a(r);return o},ue=n(15),de=n(26),pe=n(24),fe=n(13),me={uniforms:{tDiffuse:{value:null}},vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\n}",fragmentShader:"\n\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = (texel * texel * texel) * vec4(3.);\n\n}"};var he=[],ve=function(e){return he.push(e)},be=function(e){return he=he.filter((function(t){return t!==e}))},ge=[],ye=function(e){return ge.push(e)},_e=function(e){return ge=ge.filter((function(t){return e!==t}))},we=[];function Ne(e){var t,n=e,o=P.startPos,a=P.startRot,r=P.cameraData,i=P.frontObjPos,s=P.lightDataOne,c=P.speed,u=P.offsetFromFloor,d=P.offsetFromFloorFactor,p=P.speedDown,f=P.offsetWallCollision,m=P.speedRot,h={},v=!1,g=!0,y=new ee.Object3D;y.position.fromArray(o),y.rotation.fromArray(a);var _=new ee.Object3D;_.position.fromArray(i),y.add(_);var w=r.fov,N=r.ratio,O=r.near,j=r.far,S=r.pos;(t=new ee.PerspectiveCamera(w,N,O,j)).position.fromArray(S),y.add(t);var E=s.color,A=s.strenth,k=s.pos,M=new ee.PointLight(E,A);M.position.fromArray(k),y.add(M);var D=function(e,t,n,o){var a=e,r=t,i=n,l=o,s=new ee.Vector3,c=new ee.Vector3(0,-1,0),u=!0;return{check:function(e){if(!u){s.copy(a.position);var t=new ee.Raycaster(s,c).intersectObjects(he);t&&t[0]&&t[0].distance>r+i?a.position.y+=l*e.count:!t||t[0]?a.position.y=t[0].point.y+r:a.position.y+=l*e.count}},start:function(){u=!1}}}(y,u,d,p),R=function(e,t,n){var o=n,a=e,r=t,i=new ee.Vector3,l=new ee.Vector3;return{check:function(){r.getWorldPosition(l),i.copy(a.position),l.sub(i);var e=new ee.Raycaster(i,l).intersectObjects(ge);return e[0]&&e[0].distance<o}}}(y,_,f),x=function(e,t){return function(){we.forEach((function(n){e.position.distanceTo(n.position)<10&&!n.userData.nearPlayer&&(n.userData.nearPlayer=!0,t.emit("nearMesh")({toNear:!0,mesh:n})),e.position.distanceTo(n.position)>=10&&n.userData.nearPlayer&&(n.userData.nearPlayer=!1,t.emit("nearMesh")({toNear:!1,mesh:n}))}))}}(y,n),C=y.position.y,T=0,I=!1;return n.subscribe("keyEvent")((function(e){return h=e})),n.subscribe(G)((function(e){if(!v&&!g&&(D.check(e),h)){if(h.up){if(R.check())return;y.translateZ(-c*e.count),x(),n.emit("playerMove")(y.position)}h.left&&(y.rotation.y+=m*e.count),h.right&&(y.rotation.y-=m*e.count),C>y.position.y?++T:T=0,C=y.position.y,T>800&&!I&&(I=!0,setTimeout((function(){l(b.dispatch).startFinalFog(),setTimeout((function(){var e;(e=b.dispatch,{toggleFinalMessage:function(t){return e({type:"TOGGLE_FINAL_MESSAGE",mode:t})}}).toggleFinalMessage(!0)}),6e3)}),1e4))}})),n.subscribe("toggleDialog")((function(e){return v=e.isOpen})),{start:function(){g=!1,D.start()},getObj:function(){return y},getCamera:function(){return t},setToPos:function(e,t,n){return y.position.set(e,t,n)}}}n(40);var Oe=document.querySelector(".progress"),je=-100,Se=!0;!function e(){Se&&setTimeout((function(){0===++je&&(je-=100),Oe.style.marginLeft=je+"%",e()}),30)}();var Ee=["room_02","room_03","room_04","room_05"],Ae=["outer_walls","outer_floor","outer_road"];var ke=n(1),Me=n(2),De={x:55,z:75},Re=function(){function e(){Object(ke.a)(this,e),this.inScene=!1,this._state="go",this._targetAngle=null,this.container=new ee.Group,this._modelGroup=new ee.Group,this._modelGroup.position.x=De.x,this._modelGroup.position.z=De.z,this._modelGroup.rotation.y=Math.random()*(2*Math.PI),this.container.add(this._modelGroup),this._objFrom=new ee.Object3D,this._modelGroup.add(this._objFrom),this._objTo=new ee.Object3D,this._objTo.position.set(0,0,1),this._modelGroup.add(this._objTo);var t=function(e){var t={animations:e.animations,scene:e.scene.clone(!0)},n={};e.scene.traverse((function(e){e.isSkinnedMesh&&(n[e.name]=e)}));var o={},a={};for(var r in t.scene.traverse((function(e){e.isBone&&(o[e.name]=e),e.isSkinnedMesh&&(a[e.name]=e)})),n){for(var i=n[r].skeleton,l=a[r],s=[],c=0;c<i.bones.length;++c){var u=o[i.bones[c].name];s.push(u)}l.bind(new ee.Skeleton(s,i.boneInverses),l.matrixWorld)}return t}(e.botScene);this.model=t.scene.children[0],this.model.children[1].material=e.botMaterial,this._animations=e.botScene.animations,this._mixer=new ee.AnimationMixer(this.model.children[1]),this._walkAction=this._mixer.clipAction(this._animations[1]),this._walkAction.play(),this._walkAction.timeScale=.7,this._speakAction=this._mixer.clipAction(this._animations[0]),this._speakAction.timeScale=.4,this._modelGroup.add(this.model)}return Object(Me.a)(e,[{key:"update",value:function(e){this._mixer.update(e.delta),this._componentCollision&&this._updateState()}},{key:"setCollisionMesh",value:function(e){this._collisionMeshes=[e],this.container.add(e),e.material.visible=!1,this._componentCollision=xe(this._objFrom,this._objTo,7,this._collisionMeshes)}},{key:"removeCollisionMesh",value:function(){this._collisionMeshes=null,this._componentCollision=null}},{key:"prepareToSay",value:function(e){this._state="say",this._walkAction.stop(),this._speakAction.play(),this._modelGroup.lookAt(e.x,this.container.position.y,e.z)}},{key:"_updateState",value:function(){"go"===this._state&&(this._componentCollision.check()?this._startRotate():this._modelGroup.translateZ(.05));"rotate"===this._state&&(this._modelGroup.rotation.y+=this._targetAngle-this._modelGroup.rotation.y<0?-.01:.01,this._modelGroup.rotation.y%=2*Math.PI,Math.abs(this._modelGroup.rotation.y-this._targetAngle)<.5&&this._startGo())}},{key:"_startGo",value:function(){this._state="go",this._walkAction.play(),this._speakAction.stop()}},{key:"_startRotate",value:function(){this._state="rotate",this._targetAngle=(this._modelGroup.rotation.y+1.5+4*Math.random())%(2*Math.PI)}}]),e}();Re.botScene=null,Re.botMaterial=null;var xe=function(e,t,n,o){var a=new ee.Vector3,r=new ee.Vector3;return{check:function(){return t.getWorldPosition(r),e.getWorldPosition(a),r.sub(a),!!new ee.Raycaster(a,r,0,20).intersectObject(o[0],!0)[0]}}},Ce=175.335,Te=(n(4),n(14)),Ie=n.n(Te),Fe=n(10),Le=n(25),Qe={sceneEnvironment:{color:Y[-1].start.color,fogNear:Y[-1].start.fogNear,fogFar:Y[-1].start.fogFar,backgroundImgKey:null},playerQuadrant:{oldDialogPlayerQuadrant:[0,0,-50],oldQuadrant:[0,0,0],newQuadrant:[0,0,0],counter:null},level:{isStartCorridorShow:!0},ui:{isShowButtFullScreen:!0,isShowInfo:!1,isShowFinalMessage:!1,botAnswers:[],userReplicies:[],history:[],isDialog:!1,isButtonDialog:!1},botIndex:-1,phraseIndex:0,phrasesData:[{phrases:[{q:"\u041f\u0440\u0438\u0432\u0435\u0442 !",a:"\u0414\u0435\u043d\u044c \u0434\u043e\u0431\u0440\u044b\u0439, \u043a\u0440\u0435\u043c\u043d\u0438\u0435\u0432\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u0436\u0438\u0437\u043d\u0438.",event:"nextReply",levelEvent:null},{q:"\u0427\u0442\u043e \u044d\u0442\u043e \u0437\u0430 \u043c\u0435\u0441\u0442\u043e?",a:"\u042d\u0442\u043e \u0432\u0445\u043e\u0434 \u0432 \u044d\u043d\u0442\u0440\u043e\u043f\u0438\u0439\u043d\u044b\u0439 \u0433\u0438\u043f\u0435\u0440-\u043a\u0443\u0431.",event:"nextReply",levelEvent:null},{q:"\u0427\u0442\u043e \u0431\u0443\u0434\u0435\u0442, \u0435\u0441\u043b\u0438 \u044f \u0432\u043e\u0439\u0434\u0443 \u0432 \u043d\u0435\u0433\u043e?",a:"\u041a\u0443\u0431 \u043f\u0440\u0438\u043c\u0435\u0442 \u0442\u0435\u0431\u044f.",event:"close",levelEvent:null}]},{phrases:[{q:"\u041a\u0443\u0434\u0430 \u0432\u0435\u0434\u0443\u0442 \u044d\u0442\u0438 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b ?",a:"\u041e\u043d\u0438 \u043f\u0440\u0438\u0432\u0435\u0434\u0443\u0442 \u0442\u0435\u0431\u044f \u043a \u0444\u0438\u043d\u0430\u043b\u0443.",event:"nextReply",levelEvent:null},{q:"\u042f \u043f\u043e\u0448\u0435\u043b \u0434\u0430\u043b\u044c\u0448\u0435.",a:"\u041c\u044b \u0435\u0449\u0435 \u0443\u0432\u0438\u0434\u0438\u043c\u0441\u044f.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0427\u0442\u043e \u0442\u044b \u0437\u0434\u0435\u0441\u044c \u0434\u0435\u043b\u0430\u0435\u0448\u044c ?",a:"\u0421\u043e\u0431\u0438\u0440\u0430\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u043d\u043e\u0447\u0438.",event:"nextReply",levelEvent:null},{q:"\u0412 \u043a\u0430\u043a\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043c\u043d\u0435 \u0438\u0434\u0442\u0438 ?",a:"\u0417\u0434\u0435\u0441\u044c \u043d\u0435\u0442 \u0441\u0442\u043e\u0440\u043e\u043d. \u0417\u0434\u0435\u0441\u044c \u0432\u0430\u0436\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u0438\u043d\u0430 \u043f\u0443\u0442\u0438.",event:"close",levelEvent:null}]},{phrases:[{q:"\u042f \u0443\u0436\u0435 \u0434\u043e\u043b\u0433\u043e \u0438\u0434\u0443.",a:"\u0422\u044b \u043f\u0440\u043e\u0448\u0435\u043b \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f.",event:"nextReply",levelEvent:null},{q:"\u0427\u0442\u043e \u044d\u0442\u043e \u0437\u043d\u0430\u0447\u0438\u0442?",a:"\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u043f\u0443\u0442\u044c \u043d\u0430 \u043e\u0434\u043d\u0443 \u0441\u0442\u0443\u043f\u0435\u043d\u044c \u0432\u044b\u0448\u0435.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u042f \u0438\u0449\u0443 \u0444\u0438\u043d\u0430\u043b.",a:"\u042f \u043f\u043e\u043c\u043d\u044e \u043e \u0442\u0432\u043e\u0435\u043c \u043f\u0443\u0442\u0438.",event:"nextReply",levelEvent:null},{q:"\u0412\u044b \u0432\u0441\u0435 \u0442\u0430\u043a \u043f\u043e\u0445\u043e\u0436\u0438.",a:"\u041c\u044b \u0435\u0449\u0435 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u043c\u0441\u044f.",event:"close",levelEvent:null}]},{phrases:[{q:"\u042d\u0442\u043e \u0441\u043d\u043e\u0432\u0430 \u0442\u044b?",a:"\u0414\u0430, \u043c\u044b \u0432\u0441\u0435 \u0435\u0434\u0438\u043d\u044b.",event:"nextReply",levelEvent:null},{q:"\u0422\u0443\u0442 \u0432\u0441\u0435 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f.",a:"\u0421\u0443\u0442\u044c \u0432\u0441\u0435\u0433\u043e \u0432 \u0435\u0434\u0438\u043d\u043e\u043c.",event:"close",levelEvent:null}]},{phrases:[{q:"\u041a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0435\u0449\u0435 \u0438\u0434\u0442\u0438.",a:"\u0422\u0435\u0431\u0435 \u0431\u0443\u0434\u0435\u0442 \u0437\u043d\u0430\u043a, \u043a\u043e\u0433\u0434\u0430 \u0442\u044b \u0431\u0443\u0434\u0435\u0448\u044c \u0433\u043e\u0442\u043e\u0432.",event:"nextReply",levelEvent:null},{q:"\u041a\u0430\u043a \u044f \u0443\u0437\u043d\u0430\u044e \u044d\u0442\u043e\u0442 \u0437\u043d\u0430\u043a.",a:"\u042f \u043f\u043e\u0434\u0430\u043c \u0435\u0433\u043e.",event:"close",levelEvent:null}]},{phrases:[{q:"\u042d\u0442\u043e \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0439 \u0441\u0435\u0433\u043c\u0435\u043d\u0442 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u0430 \u0441 \u0442\u043e\u0431\u043e\u0439.",a:"\u0422\u044b \u0433\u043e\u0442\u043e\u0432 \u043a \u043d\u043e\u0432\u043e\u043c\u0443 \u0443\u0440\u043e\u0432\u043d\u044e.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u041f\u0440\u0438\u0432\u0435\u0442 \u0441\u043d\u043e\u0432\u0430. \u041a\u0430\u043a \u0432\u044b\u0431\u0440\u0430\u0442\u044c\u0441\u044f. \u0423\u0436\u0435 \u043d\u0430\u0434\u043e\u0435\u043b\u043e.",a:"\u0422\u044b \u043d\u0435 \u043f\u043e\u0441\u0442\u0438\u0433 \u0434\u0437\u0435\u043d.",event:"nextReply",levelEvent:null},{q:"\u0422\u044b-\u0442\u043e \u043a\u0430\u043a \u0432\u044b\u0445\u043e\u0434\u0438\u0448\u044c \u043d\u0430 \u043f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u044c?",a:"\u0423 \u043c\u0435\u043d\u044f \u0441\u0432\u043e\u0439 \u043f\u0443\u0442\u044c.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0422\u044b \u0432\u0441\u0435 \u043d\u0430 \u0441\u0432\u043e\u0435\u043c \u043f\u0443\u0442\u0438?",a:"\u041a\u0430\u043a \u0438 \u0442\u044b.",event:"nextReply",levelEvent:null},{q:"\u041a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0442\u044b \u043d\u0430 \u043d\u0435\u043c?",a:"\u042d\u0442\u0438 \u0441\u0442\u0435\u043d\u044b \u043d\u0430\u0441 \u0441\u043b\u044b\u0448\u0430\u0442.",event:"close",levelEvent:null}]},{phrases:[{q:"\u041c\u043d\u0435 \u043a\u0430\u0436\u0435\u0442\u0441\u044f, \u0442\u044b \u0438\u0434\u0435\u0448\u044c \u0432 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0443 \u043a \u044d\u0442\u043e\u043c\u0443 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0443 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u0430.",a:"\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f.",a:"\u041c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u043d\u044b\u0445 \u0448\u0430\u0433\u043e\u0432.",event:"nextReply",levelEvent:null},{q:"\u042d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0441\u0447\u0438\u0442\u0430\u0435\u0442 \u0448\u0430\u0433\u0438?",a:"\u042d\u0442\u043e \u043c\u0435\u0441\u0442\u043e \u0436\u0434\u0435\u0442.",event:"close",levelEvent:null}]},{phrases:[{q:"\u041a\u0430\u043a \u0434\u0430\u0432\u043d\u043e \u0442\u044b \u0437\u0434\u0435\u0441\u044c?",a:"\u0412\u0440\u0435\u043c\u044f \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0438\u043c\u0435\u0435\u0442 \u043b\u0438\u0448\u044c \u043f\u0443\u0442\u044c.",event:"nextReply",levelEvent:null},{q:"\u041d\u043e \u0442\u044b \u0436\u0435 \u043d\u0435 \u0438\u0434\u0435\u0448\u044c.",a:"\u0417\u0430\u0442\u043e \u0442\u044b \u043a\u0430\u0436\u0434\u044b\u0439 \u0440\u0430\u0437 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0448\u044c \u043c\u0438\u043c\u043e.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0421\u0434\u0435\u043b\u0430\u0439 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c.",a:"\u0422\u044b \u0433\u043e\u0442\u043e\u0432 - \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0436\u0434\u0435\u0442 \u0442\u0435\u0431\u044f.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u0422\u044b \u0438 \u0435\u0441\u0442\u044c \u044d\u0442\u043e \u043c\u0435\u0441\u0442\u043e. \u0422\u044b \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0448\u044c \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0430\u043c\u0438.",a:"\u0422\u044b \u043f\u043e\u0447\u0442\u0438 \u0434\u043e\u0448\u0435\u043b \u0434\u043e \u043a\u0440\u0430\u044f.",event:"nextReply",levelEvent:null},{q:"\u0417\u0430\u0447\u0435\u043c \u0442\u0435\u0431\u0435 \u044d\u0442\u043e?",a:"\u042d\u0442\u043e \u0441\u043f\u043e\u0441\u043e\u0431 \u0441\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0441\u0442\u0432\u043e. \u0411\u043e\u043b\u044c\u0448\u0435 \u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f. \u0411\u043e\u043b\u044c\u0448\u0435 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432.",event:"close",levelEvent:null}]},{phrases:[{q:"\u041a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u043d\u0438\u043a\u043e\u0432 \u043f\u043e\u043f\u0430\u0434\u0430\u043b\u043e \u0441\u044e\u0434\u0430?",a:"\u041c\u043d\u043e\u0433\u0438\u0435 \u0438\u0437 \u043d\u0438\u0445 \u0434\u043e \u0441\u0438\u0445 \u043f\u043e\u0440 \u0442\u0443\u0442.",event:"nextReply",levelEvent:null},{q:"\u041f\u043e\u0447\u0435\u043c\u0443 \u044f \u0438\u0445 \u043d\u0435 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u043b?",a:"\u0423 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0441\u0432\u043e\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0422\u044b \u0432\u044b\u043f\u0443\u0441\u0442\u0438\u0448\u044c \u043c\u0435\u043d\u044f?",a:"\u0412\u0441\u0435 \u0441\u0442\u043e\u0440\u043e\u043d\u044b \u0441\u0432\u0435\u0442\u0430 \u043e\u0442\u043a\u0440\u044b\u0442\u044b \u0442\u0435\u0431\u0435.",event:"nextReply",levelEvent:null},{q:"\u042f \u0445\u043e\u0447\u0443 \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u0442\u044c \u0434\u0440\u0443\u0433\u0438\u0445.",a:"\u0422\u0435\u0431\u0435 \u043e\u0442\u043a\u0440\u044b\u0442 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u042f \u0432\u0438\u0436\u0443 \u0437\u0430\u0440\u0435\u0432\u043e?",a:"\u042d\u0442\u043e \u0437\u0430\u0440\u0435\u0432\u043e \u043f\u0440\u043e\u0441\u0432\u0435\u0442\u043b\u0435\u043d\u0438\u044f. \u0422\u044b \u0431\u043b\u0438\u0437\u043e\u043a",event:"nextReply",levelEvent:null},{q:"\u0412\u0441\u0435 \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u044b \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f.",a:"\u0412\u0441\u0435 \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0435\u0442\u0441\u044f \u0441 \u043d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0440\u0430\u0437\u043d\u0438\u0446\u0435\u0439.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0412\u0441\u0435 \u043c\u043e\u0439 \u043f\u0443\u0442\u044c \u043e\u043a\u043e\u043d\u0447\u0435\u043d.",a:"\u0422\u044b \u043e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0448\u044c\u0441\u044f \u0438\u0434\u0442\u0438?",event:"nextReply",levelEvent:null},{q:"\u0414\u0430, \u0442\u044b \u0431\u0435\u0437\u0443\u043c\u0435\u043d.",a:"\u042f \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u044e \u0442\u0435\u0431\u044f.",event:"close",levelEvent:"addWell"}]}]},Ge=Object(Fe.c)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;if("CLICK_FULL_SCREEN"===t.type)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isShowButtFullScreen:!1})});if("EXIT_FULL_SCREEN"===t.type)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isShowButtFullScreen:!0})});if("INFO_TOGGLE"===t.type)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isShowFinalMessage:!1,isShowInfo:t.mode})});if("TOGGLE_FINAL_MESSAGE"===t.type)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isShowFinalMessage:t.mode,isShowInfo:!1})});if("CHANGE_ENVIRONMENT"===t.type){var n=t.newQuadrant,o=t.environmentMode;if(!Y[n[1]])return e;var a=Y[n[1]][o],r=a.fogNear,i=a.fogFar,l=a.color,s=a.backgroundImgKey;return Object(z.a)(Object(z.a)({},e),{},{sceneEnvironment:{fogNear:r,fogFar:i,color:l,backgroundImgKey:s}})}if("CHANGE_QUADRANT"===t.type)return Object(z.a)(Object(z.a)({},e),{},{playerQuadrant:Object(z.a)(Object(z.a)({},e.playerQuadrant),t)});if("DESTROY_START_CORRIDOR"===t.type)return Object(z.a)(Object(z.a)({},e),{},{level:Object(z.a)(Object(z.a)({},e.level),{},{isStartCorridorShow:!1})});if("CLICK_PHRASE"===t.type)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{botAnswers:[].concat(Object(W.a)(e.ui.botAnswers),[t.phrase]),userReplicies:[]})});if("PHRASE_EVENT"===t.type){var c=t.phrase.event;if("nextReply"===c){var u=[e.phrasesData[e.botIndex].phrases[e.phraseIndex+1]];return Object(z.a)(Object(z.a)({},e),{},{phraseIndex:e.phraseIndex+1,ui:Object(z.a)(Object(z.a)({},e.ui),{},{userReplicies:u})})}if("close"===c)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{userReplicies:[],isButtonDialog:!0}),playerQuadrant:Object(z.a)(Object(z.a)({},e.playerQuadrant),{},{oldDialogPlayerQuadrant:Object(W.a)(e.playerQuadrant.newQuadrant)})})}if("TOGGLE_DIALOG"===t.type){var d=!1,p=e.playerQuadrant,f=p.oldDialogPlayerQuadrant,m=p.newQuadrant;if(f[0]===m[0]&&f[1]===m[1]&&f[2]===m[2]||(d=!0),!d)return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isDialog:t.isDialog,isButtonDialog:!0})});var h=0,v=e.botIndex+1,b=!1,g=e.phrasesData[v]?[e.phrasesData[v].phrases[h]]:[];return Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{userReplicies:g,botAnswers:[],isDialog:t.isDialog,isButtonDialog:b}),isCanChangeBotIndex:!1,botIndex:v,phraseIndex:h})}return"TOGGLE_BUTTON"===t.type?Object(z.a)(Object(z.a)({},e),{},{ui:Object(z.a)(Object(z.a)({},e.ui),{},{isDialog:!1,isButtonDialog:t.isButtonDialog})}):e}}),Ye=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Fe.d,qe=Object(Fe.e)(Ge,Ye(Object(Fe.a)(Le.a)));Ie.a.render(Object(d.jsx)(o.a,{store:qe,children:Object(d.jsx)(g,{})}),document.getElementById("root")),function(e){var t=document.querySelector(".app-wrapper");e.subscribe("mouseDown")((function(e){"butt-fullscreen"===e&&n()}));var n=function(){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},o=function(e){t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",t.style.fontSize=Math.max(Math.min(Math.min(window.innerWidth,window.innerHeight),400),350)/50+"px",document.fullscreenElement||s(b.dispatch).exitFullScreen()};window.addEventListener("resize",o),o()}(i);var Pe=function(e){!function(e){var t=e.emit(G),n={time:0,delta:0,count:0,oldTime:0},o=_.a((function(){return n}),(function(e){return e.time=Date.now(),e}),(function(e){return e.delta=.001*(e.time-e.oldTime),(isNaN(e.delta)||e.delta>1e3||0===e.delta)&&(e.delta=1e3/60*.001),e}),(function(e){return e.count=e.delta/(1/60),e}),(function(e){return t(e),e}),(function(e){return e.oldTime=e.time,e}),(function(e){return n=e}));!function e(){requestAnimationFrame(e),o(n)}()}(i),i.subscribe(G)((function(){return ue.b()}));var t=function(e,t,n){var o=q.canId,a=q.rendererCon,r=q.clearColor,i=q.amb,l=document.getElementById(o);a.canvas=l;var s=new ee.WebGLRenderer(a);s.setClearColor(r),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight);var c,u=new ee.Scene,d=n.getState().app.sceneEnvironment,p=d.color,f=d.fogNear,m=d.fogFar,h=d.backgroundImgKey;u.background=t[h]||null,u.fog=new ee.Fog(p,f,m);var v=i.color,b=i.strength;c=new ee.AmbientLight(v,b),u.add(c);var g=null,y=new de.a(s),_=function(){var e={width:window.innerWidth,height:window.innerHeight};s.setSize(e.width,e.height),y.setSize(e.width,e.height),g&&(g.aspect=e.width/e.height,g.updateProjectionMatrix())};window.addEventListener("resize",_),_();var w=u.add.bind(u);e.subscribe(G)((function(){return g&&y.render(u,g)}));var N=u.fog.near,O=u.fog.far,j=u.fog.color,S=n.getState().app.sceneEnvironment.backgroundImgKey;return n.subscribe((function(){var e=n.getState().app.sceneEnvironment,o=e.fogNear,a=e.fogFar,r=e.color,i=e.backgroundImgKey;if(o!==N||a!==O||r!==j){var l={color:u.fog.color,near:u.fog.near,far:u.fog.far},d={color:new ee.Color(r),near:o,far:a};N=o,O=a,j=r,new ue.a(l).to(d,3e3).onUpdate((function(){u.fog.color=l.color,u.fog.near=l.near,u.fog.far=l.far,c.color=l.color,s.setClearColor(l.color)})).start()}i!==S&&(S=i,u.background=t[i]||null)})),{setCamera:function(e){g=e,y.addPass(new pe.a(u,e)),y.addPass(new fe.a(me))},addToScene:w}}(i,e,qe);new y(i);var n=Ne(i);t.setCamera(n.getCamera()),t.addToScene(n.getObj());var o=function(e){var t=ce(e),n={},o={};return e.collisionsBotsRooms={},e["level-rooms"].traverse((function(a){if(a.name.includes("room_")){var r=new ee.Mesh(a.geometry,t.wall);n[a.name]=r,r.name=a.name,o[a.name]=r}if(a.name.includes("collision_")){var i=new ee.Mesh(a.geometry);e.collisionsBotsRooms[a.name]=i,i.name=a.name,o[a.name]=i}if(a.name.includes("outer_walls")){var l=new ee.Mesh(a.geometry,t.wall);l.name=a.name,o[a.name]=l}if(a.name.includes("outer_road")){var s=new ee.Mesh(a.geometry,t.green);s.name=a.name,o[a.name]=s}if(a.name.includes("outer_floor")){var c=new ee.Mesh(a.geometry,t.road);c.name=a.name,o[a.name]=c}})),{rooms:n,allMeshes:o,materials:t}}(e),a=o.allMeshes,r=o.rooms,s=o.materials,c=function(e,t,n,o){var a=new ee.Group,r={},i="normal",l=function n(o,i){var l=i||Ee[Math.floor(Math.random()*Ee.length)],s="r_".concat(o[0],"_").concat(o[1],"_").concat(o[2]),c=t[l].clone();c.position.set(o[0]*Q,70*o[1],o[2]*Q),ve(c),ye(c),a.add(c),r[s]=c,e.emit("levelChanged")({typeLevelChange:"createRoom",instanceKey:l,objKey:s,kv:o,isAddBot:"room_01"===l}),"room_06"===l&&n([o[0],o[1]+1,o[2]],"room_dummy")},s=function t(n){var o="r_".concat(n[0],"_").concat(n[1],"_").concat(n[2]);if(r[o]){var i=r[o].name;a.remove(r[o]),be(r[o]),_e(r[o]),delete r[o],e.emit("levelChanged")({typeLevelChange:"destroyRoom",instanceKey:i,objKey:o,kv:n,isRemoveBot:"room_01"===i}),"room_dummy"===i&&t([n[0],n[1]-1,n[2]]),"room_06"===i&&t([n[0],n[1]+1,n[2]])}};l([0,-1,0],"room_02"),l([0,-1,-1],"room_02"),l([-1,-1,0],"room_02"),l([1,-1,0],"room_02");for(var c={},u=0;u<Ae.length;++u){var d=n[Ae[u]].clone();ve(d),ye(d),a.add(d),d.position.set(0,-70,0),c[Ae[u]]=d}var p=0,f=!1,m=o.getState(),h=m.app.playerQuadrant.oldQuadrant,v=m.app.playerQuadrant.newQuadrant,b=m.app.level.isStartCorridorShow;return o.subscribe((function(){var t=o.getState();if(b&&b!==t.app.level.isStartCorridorShow)for(var n in b=!1,c)be(c[n]),_e(c[n]),a.remove(c[n]);var u=t.app.playerQuadrant,d=u.type,m=u.oldQuadrant,g=u.newQuadrant,y=u.counter;if("CHANGE_QUADRANT"===d&&(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||v[0]!==g[0]||v[1]!==g[1]||v[2]!==g[2])){h=Object(W.a)(m),v=Object(W.a)(g);var _=Ee[Math.floor(Math.random()*Ee.length)];y&&(p=y(p),f?f=!1:(p<3?i="normal":p<100?"normal"===i&&(i="addBot"):i="addStairs","addBot"===i&&(_="room_01",f=!0),"addStairs"===i&&(_="room_06",f=!0),"addWell"===i&&(_="room_07"))),e.subscribe("changeLevelMode")((function(e){return i=e}));var w=m,N=g;N[0]<w[0]&&(console.log("----------- west"),s([w[0]+1,w[1],w[2]]),r["r_".concat(N[0]+1,"_").concat(N[1],"_").concat(N[2])]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],l([w[0]-2,w[1],w[2]],_),s([w[0],w[1],w[2]-1]),l([N[0],N[1],N[2]-1],_),s([w[0],w[1],w[2]+1]),l([N[0],N[1],N[2]+1],_)),N[0]>w[0]&&(console.log("----------- east"),s([w[0]-1,w[1],w[2]]),r["r_".concat(N[0]-1,"_").concat(N[1],"_").concat(N[2])]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],l([w[0]+2,w[1],w[2]],_),s([w[0],w[1],w[2]-1]),l([N[0],N[1],N[2]-1],_),s([w[0],w[1],w[2]+1]),l([N[0],N[1],N[2]+1],_)),N[2]<w[2]&&(console.log("-----------north"),s([w[0],w[1],w[2]+1]),r["r_".concat(N[0],"_").concat(N[1],"_").concat(N[2]+1)]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],l([w[0],w[1],w[2]-2],_),s([w[0]-1,w[1],w[2]]),l([N[0]-1,N[1],N[2]],_),s([w[0]+1,w[1],w[2]]),l([N[0]+1,N[1],N[2]],_)),N[2]>w[2]&&(console.log("-----------south"),s([w[0],w[1],w[2]-1]),r["r_".concat(N[0],"_").concat(N[1],"_").concat(N[2]-1)]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],l([w[0],w[1],w[2]+2],_),s([w[0]-1,w[1],w[2]]),l([N[0]-1,N[1],N[2]],_),s([w[0]+1,w[1],w[2]]),l([N[0]+1,N[1],N[2]],_)),(N[1]>w[1]||N[1]<w[1])&&(console.log("-----------top"),s([w[0],w[1],w[2]-1]),l([N[0],N[1],N[2]-1]),s([w[0],w[1],w[2]+1]),l([N[0],N[1],N[2]+1]),s([w[0]-1,w[1],w[2]]),l([N[0]-1,N[1],N[2]]),s([w[0]+1,w[1],w[2]]),l([N[0]+1,N[1],N[2]]))}})),{group:a}}(i,r,a,qe).group;t.addToScene(c);var d=function(e,t,n,o){Re.botMaterial=t.iron,Re.botScene=e.bot;for(var a=new ee.Group,r=[],i=0;i<5;++i){var l=new Re;a.add(l.container),l.container.position.set(30*i-30,-92,750),l.inScene="aaa",l.setCollisionMesh(e.collisionsBotsRooms.collision_r_01.clone()),r.push(l)}n.subscribe(G)((function(e){for(var t=0;t<r.length;++t)r[t].inScene&&r[t].update(e)}));var s=o.getState().app.level.isStartCorridorShow;return o.subscribe((function(){var e=o.getState();if(s&&s!==e.app.level.isStartCorridorShow){s=e.app.level.isStartCorridorShow;for(var t=0;t<r.length;++t)r[t].inScene=null,r[t].container.position.y=-1e4,r[t].removeCollisionMesh()}})),n.subscribe("levelChanged")((function(t){t.typeLevelChange,t.instanceKey;var n=t.objKey,o=t.kv,a=t.isAddBot,i=t.isRemoveBot;if(a)for(var l=0;l<r.length;++l)if(!r[l].inScene){r[l].inScene=n,r[l].container.position.set(o[0]*Ce,70*o[1]+14,o[2]*Ce),r[l].setCollisionMesh(e.collisionsBotsRooms.collision_r_01.clone());break}if(i)for(var s=0;s<r.length;++s)r[s].inScene===n&&(r[s].inScene=null,r[s].container.position.y=-1e4,r[s].removeCollisionMesh())})),n.subscribe("playerMove")((function(e){for(var t=0;t<r.length;++t)if(r[t].inScene){var n=new ee.Vector3;r[t]._modelGroup.getWorldPosition(n);var o=n.distanceTo(e);"say"===r[t]._state&&o>30?(r[t]._startRotate(),u(b.dispatch).toggleButtonDialog(!1)):"say"!==r[t]._state&&o<30&&(r[t].prepareToSay(e),u(b.dispatch).toggleButtonDialog(!0))}})),{groupBots:a}}(e,s,i,qe);t.addToScene(d.groupBots),function(){var e=$();i.subscribe("playerMove")((function(t){var n=e.update(t),o=n.currentQuadrant,a=n.oldQuadrant;if(n.isChanged){var r=J(a,o);r.length&&r.forEach((function(e){return b.dispatch(Object(z.a)(Object(z.a)({},e),{},{type:e.emitKey}))}))}}))}(),setTimeout((function(){return n.start()}),500),function(e){var t=document.querySelector(".startbuttons-wrapper"),n=document.querySelector(".progress-wrapper");Se=!1,t.style.display="flex",t.addEventListener("click",(function(t){e.emit("setLanguage")(t.target.dataset.lang),document.querySelector(".start-screen").style.display="none"})),n.style.display="none"}(i),i.subscribe("setLanguage")((function(){setTimeout(l(b.dispatch).startPlay,1e3),setTimeout(l(b.dispatch).showBackground,3e3)}))};window.addEventListener("load",(function(){return(e=F,new Promise((function(t){ae=e,oe=t,ie=0,U=U||new te.a,B=B||new ee.TextureLoader,K=K||new ne.a,H=H||new ee.CubeTextureLoader,le(ae[ie])}))).then(Pe);var e}))}},[[41,1,2]]]);
//# sourceMappingURL=main.9d611fb5.chunk.js.map