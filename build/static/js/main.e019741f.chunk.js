(this.webpackJsonplevels=this.webpackJsonplevels||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var o=n(8),a=null,r=function(e){return function(t){return e[t]=e[t]||[]}},i=a=a||function(){var e={};return{emit:function(t){return function(n){return r(e)(t).forEach((function(e){return e(n)}))}},subscribe:function(t){return function(n){return r(e)(t).push(n),function(){return e[t]=e[t].filter((function(e){return e!==n}))}}},showAll:function(){var t={};for(var n in e)t[n]=e[n].length;console.log(t)}}}(),s=function(e){return{toggleFinalMessage:function(t){return e({type:"TOGGLE_FINAL_MESSAGE",mode:t})}}},l=function(e){return{clickFullScreen:function(){e({type:"CLICK_FULL_SCREEN"})},exitFullScreen:function(){e({type:"EXIT_FULL_SCREEN"})}}},c=function(e){return{clickInfo:function(t){e({type:"INFO_TOGGLE",mode:t})}}},u=function(e){return{changeBot:function(t){e({type:"CHANGE_BOT",phrase:t})},clickPhrase:function(t){e({type:"CLICK_PHRASE",phrase:t}),setTimeout((function(){e({type:"PHRASE_EVENT",phrase:t}),t.levelEvent&&i.emit("changeLevelMode")(t.levelEvent)}),1e3)},toggleDialog:function(t){e({type:"TOGGLE_DIALOG",isDialog:t})},toggleButtonDialog:function(t){e({type:"TOGGLE_BUTTON",isButtonDialog:t})}}},d=n(5),p=Object(o.b)((function(e){return{userReplicies:e.app.ui.userReplicies}}))((function(e){return Object(d.jsx)("div",{className:"userReplicies",children:e.userReplicies.map((function(t){return Object(d.jsx)("button",{onClick:function(){u(e.dispatch).clickPhrase(t)},children:t.q},Math.floor(1e5*Math.random()))}))})})),f=Object(o.b)((function(e){return{botAnswers:e.app.ui.botAnswers}}))((function(e){return Object(d.jsx)("div",{className:"botAnswers",children:e.botAnswers.map((function(e){return Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"q",children:e.q}),Object(d.jsx)("div",{className:"a",children:e.a})]},Math.floor(1e5*Math.random()))}))})})),m={ru:{"open dialog":"\u043d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","close dialog":"\u0437\u0430\u043a\u043e\u043d\u0447\u0438\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","The end.":"\u042d\u0442\u043e \u043a\u043e\u043d\u0435\u0446.","After a long wandering in the desert...":"\u041f\u043e\u0441\u043b\u0435 \u0434\u043e\u043b\u0433\u043e\u0433\u043e \u0431\u043b\u0443\u0436\u0434\u0430\u043d\u0438\u044f \u043f\u043e \u043f\u0443\u0441\u0442\u043e\u0448\u0438...","Stranger, I threw you a terminal with a pass phrase. Remember:":"\u041d\u0435\u0437\u043d\u0430\u043a\u043e\u043c\u0435\u0446, \u044f \u0441\u0431\u0440\u043e\u0441\u0438\u043b \u0442\u0435\u0431\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0441 \u043f\u0430\u0440\u043e\u043b\u044c\u043d\u043e\u0439 \u0444\u0440\u0430\u0437\u043e\u0439. \u0417\u0430\u043f\u043e\u043c\u043d\u0438:","And blood-black nothingness began to spin...":"\u041a\u0440\u043e\u0432\u0430\u0432\u043e-\u0447\u0435\u0440\u043d\u043e\u0435 \u043d\u0438\u0447\u0442\u043e \u043f\u0443\u0441\u0442\u0438\u043b\u043e\u0441\u044c \u0432\u0438\u0442\u044c \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u043a\u043b\u0435\u0442\u043e\u043a,","A system of cells interlinked within cells interlinked within cells interlinked within one stem...":"\u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438, \u043a\u043b\u0435\u0442\u043e\u043a, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438, \u043a\u043b\u0435\u0442\u043e\u043a \u0432 \u0435\u0434\u0438\u043d\u043e\u043c \u0441\u0442\u0435\u0431\u043b\u0435 \u0438 \u044f\u0432\u0441\u0442\u0432\u0435\u043d\u043d\u043e,","And dreadfully distinct against the dark, a tall white fountain played.":"\u0434\u043e \u0436\u0443\u0442\u0438 \u043d\u0430 \u0444\u043e\u043d\u0435 \u0442\u044c\u043c\u044b \u0432\u0432\u044b\u0441\u044c \u0431\u0435\u043b\u044b\u043c \u0431\u0438\u043b \u0444\u043e\u043d\u0442\u0430\u043d.","Officer K-D-six-dash-three-dot-seven, let's begin. Ready?":"\u041e\u0444\u0438\u0446\u0435\u0440 \u041a\u0435\u0439 \u0414\u0438 6.3.7. \u043f\u0440\u0438\u0441\u0442\u0443\u043f\u0438\u043c. \u0413\u043e\u0442\u043e\u0432\u044b?","Yes, sir.":"\u0413\u043e\u0442\u043e\u0432","No.":"\u041d\u0435 \u0433\u043e\u0442\u043e\u0432","Recite your baseline.":"\u0412\u0430\u0448\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u0430\u044f \u0444\u0440\u0430\u0437\u0430.","I do not remember.":"\u042f \u0437\u0430\u0431\u044b\u043b.","I'll come back later.":"\u042f \u0437\u0430\u0439\u0434\u0443 \u043f\u043e\u043f\u043e\u0437\u0436\u0435.","Cells.":"\u041a\u043b\u0435\u0442\u043a\u0438.","Have you ever been in an institution? Cells.":"\u0414\u043e\u0432\u043e\u0434\u0438\u043b\u043e\u0441\u044c \u043b\u0438 \u0432\u0430\u043c \u0431\u044b\u0432\u0430\u0442\u044c \u0432 \u0442\u044e\u0440\u044c\u043c\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","Do they keep you in a cell? Cells.":"\u0412\u0430\u0441 \u0434\u0435\u0440\u0436\u0430\u0442 \u0432 \u043a\u043b\u0435\u0442\u043a\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","When you're not performing your duties do they keep you in a little box? Cells.":"\u041a\u043e\u0433\u0434\u0430 \u0432\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0435 \u043e\u0431\u044f\u0437\u0430\u043d\u043d\u043e\u0441\u0442\u0438, \u0432\u0430\u0441 \u0434\u0435\u0440\u0436\u0430\u0442 \u0432 \u043a\u043e\u0440\u043e\u0431\u043a\u0435? \u041a\u043b\u0435\u0442\u043a\u0438.","Interlinked.":"\u0421\u0432\u044f\u0437\u0430\u043d\u044b.","What's it like to hold the hand of someone you love? Interlinked.":"\u0427\u0442\u043e \u0432\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435 \u0434\u0435\u0440\u0436\u0430 \u0437\u0430 \u0440\u0443\u043a\u0443 \u0442\u043e\u0433\u043e \u043a\u043e\u0433\u043e \u043b\u044e\u0431\u0438\u0442\u0435? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Did they teach you how to feel finger to finger? Interlinked.":"\u0412\u0430\u0441 \u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u0438\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0430\u043b\u0435\u0446 \u043a \u043f\u0430\u043b\u044c\u0446\u0443? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you long for having your heart interlinked? Interlinked.":"\u0412\u044b \u0436\u0430\u0436\u0434\u0435\u0442\u0435 \u0441\u0432\u044f\u0437\u0430\u0442\u044c \u0441 \u043a\u0435\u043c-\u043d\u0438\u0431\u0443\u0434\u044c \u0441\u0435\u0440\u0434\u0446\u0435? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you dream about being interlinked? Interlinked.":"\u0412\u0430\u043c \u0441\u043d\u0438\u0442\u0441\u044f \u0441\u0432\u044f\u0437\u044c \u0441 \u043a\u0435\u043c-\u043b\u0438\u0431\u043e? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","What's it like to hold your child in your arms? Interlinked.":"\u0427\u0442\u043e \u0432\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435, \u0434\u0435\u0440\u0436\u0430 \u0432 \u0440\u0443\u043a\u0430\u0445 \u0441\u0432\u043e\u0435\u0433\u043e \u0440\u0435\u0431\u0435\u043d\u043a\u0430? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Do you feel that there's a part of you that's missing? Interlinked.":"\u0412\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435, \u0447\u0442\u043e \u0432\u0430\u043c \u0447\u0435\u0433\u043e-\u0442\u043e \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442? \u0421\u0432\u044f\u0437\u0430\u043d\u044b.","Within cells interlinked.":"\u041a\u043b\u0435\u0442\u043e\u043a \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438.","Why don't you say that three times: Within cells interlinked.":'\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0442\u0440\u0438 \u0440\u0430\u0437\u0430 "\u043a\u043b\u0435\u0442\u043e\u043a \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0432\u043d\u0443\u0442\u0440\u0438',"We're done... Constant K, you can pick up your bonus.":"\u041d\u0430 \u044d\u0442\u043e\u043c \u0432\u0441\u0435. \u041a\u0435\u0439 \u0441\u0442\u0430\u0431\u0438\u043b\u0435\u043d, \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u043e\u0439\u0442\u0438 \u0437\u0430 \u0431\u043e\u043d\u0443\u0441\u043e\u043c.","Thank you, sir.":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e, \u0441\u044d\u0440.","...If you read it, you find dropped terminal and got top level of desert. Welcome...":"...\u0415\u0441\u043b\u0438 \u0442\u044b \u0447\u0438\u0442\u0430\u0435\u0448\u044c \u044d\u0442\u043e, \u0442\u044b \u043d\u0430\u0448\u0435\u043b \u0443\u043f\u0430\u0432\u0448\u0438\u0439 \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0438 \u0434\u043e\u0431\u0440\u0430\u043b\u0441\u044f \u0434\u043e \u0432\u0435\u0440\u0445\u043d\u0435\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u043f\u0443\u0441\u0442\u043e\u0448\u0438.","Who are you?":"\u041a\u0442\u043e \u0442\u044b?","It does not matter. Later. May be..":"\u042d\u0442\u043e \u043d\u0435\u0432\u0430\u0436\u043d\u043e. \u041f\u043e\u0437\u0436\u0435. \u041c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c..","Hey...":"\u042d\u0439...",open:"\u043f\u0443\u0441\u043a","Previous part: ":"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u0447\u0430\u0441\u0442\u044c: ","Author: ":"\u0410\u0432\u0442\u043e\u0440: ",link:"\u0441\u0441\u044b\u043b\u043a\u0430"}},h="en";i.subscribe("setLanguage")((function(e){h=e}));var b=function(e){return m[h]&&m[h][e]||e};var g={dispatch:null},v=Object(o.b)((function(e){return{isButtonDialog:e.app.ui.isButtonDialog,isDialog:e.app.ui.isDialog,isShowClickFullScreen:e.app.ui.isShowButtFullScreen,isShowInfo:e.app.ui.isShowInfo,isShowFinalMessage:e.app.ui.isShowFinalMessage}}))((function(e){return!g.dispatch&&(g.dispatch=e.dispatch),Object(d.jsxs)("div",{className:"ui",children:[e.isShowClickFullScreen&&Object(d.jsx)("button",{className:"butt-fullscreen control",onClick:function(){i.emit("mouseDown")("butt-fullscreen"),l(e.dispatch).clickFullScreen()},children:"\u2752"}),!e.isDialog&&!e.isShowInfo&&Object(d.jsx)("button",{className:"butt-info control",onClick:function(){return c(e.dispatch).clickInfo(!0)},children:"i"}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-left control",onMouseDown:function(){return i.emit("mouseDown")("butt-left")},onTouchStart:function(){return i.emit("mouseDown")("butt-left")},onMouseUp:function(){return i.emit("mouseUp")("butt-left")},onTouchEnd:function(){return i.emit("mouseUp")("butt-left")},children:"\u25c4"}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-right control",onMouseDown:function(){return i.emit("mouseDown")("butt-right")},onTouchStart:function(){return i.emit("mouseDown")("butt-right")},onMouseUp:function(){return i.emit("mouseUp")("butt-right")},onTouchEnd:function(){return i.emit("mouseUp")("butt-right")},children:"\u25ba"}),!e.isDialog&&Object(d.jsx)("button",{className:"butt-front control",onMouseDown:function(){return i.emit("mouseDown")("butt-front")},onTouchStart:function(){return i.emit("mouseDown")("butt-front")},onMouseUp:function(){return i.emit("mouseUp")("butt-front")},onTouchEnd:function(){return i.emit("mouseUp")("butt-front")},children:"\u25b2"}),e.isButtonDialog&&Object(d.jsx)("button",{className:"butt-toggleDialog",onClick:function(){u(e.dispatch).toggleDialog(!e.isDialog)},children:e.isDialog?b("close dialog"):b("open dialog")}),e.isDialog&&Object(d.jsx)("div",{className:"dialog",children:Object(d.jsxs)("div",{className:"dialog-inner",children:[Object(d.jsx)(f,{}),Object(d.jsx)(p,{})]})}),e.isShowFinalMessage&&Object(d.jsx)("div",{className:"info",children:Object(d.jsxs)("div",{className:"info-inner final-message",children:[Object(d.jsx)("button",{className:"control butt-infoClose",onClick:function(){return s(e.dispatch).toggleFinalMessage(!1)},children:"x"}),Object(d.jsx)("p",{children:b("The end")})]})}),e.isShowInfo&&Object(d.jsx)("div",{className:"info",children:Object(d.jsxs)("div",{className:"info-inner",children:[Object(d.jsx)("button",{className:"control butt-infoClose",onClick:function(){return c(e.dispatch).clickInfo(!1)},children:"x"}),Object(d.jsxs)("p",{children:[b("Previous part: "),Object(d.jsx)("a",{href:"http://js.otrisovano.ru/bridge",target:"blank",children:b("link")})]}),Object(d.jsxs)("p",{children:[b("Author: "),Object(d.jsx)("a",{href:"http://otrisovano.ru",target:"blank",children:b("link")})]}),Object(d.jsxs)("p",{children:[b("Github: "),Object(d.jsx)("a",{href:"https://github.com/fire888/levels\\",target:"blank",children:b("link")})]})]})})]})}));function y(e){var t={up:!1,left:!1,right:!1,s:!1,m:!1,w:!1},n=function(n,o){switch(n){case 38:t.up=o;break;case 37:t.left=o;break;case 39:t.right=o;break;case 83:t.s=o;break;case 77:t.m=o;break;case 87:t.w=o}e.emit("keyEvent")(t)};document.addEventListener("keydown",function(e){n(e.keyCode,!0)}.bind(this)),document.addEventListener("keyup",function(e){n(e.keyCode,!1)}.bind(this)),e.subscribe("mouseDown")((function(e){"butt-left"===e&&n(37,!0),"butt-right"===e&&n(39,!0),"butt-front"===e&&n(38,!0)})),e.subscribe("mouseUp")((function(e){"butt-left"===e&&n(37,!1),"butt-right"===e&&n(39,!1),"butt-front"===e&&n(38,!1)}))}var _=n(39),w=n.p+"static/media/px.2be78f43.jpg",O=n.p+"static/media/nx.b2401269.jpg",N=n.p+"static/media/py.659ebc34.jpg",j=n.p+"static/media/ny.462f1251.jpg",S=n.p+"static/media/pz.8ea5ba14.jpg",A=n.p+"static/media/nz.7f255b96.jpg",E=n.p+"static/media/posx.be2d83a2.jpg",C=n.p+"static/media/negx.d016c8e7.jpg",M=n.p+"static/media/posy.01cfd221.jpg",k=n.p+"static/media/negy.f01f8356.jpg",D=n.p+"static/media/posz.ef37b8e1.jpg",x=n.p+"static/media/negz.f346a80a.jpg",R=n.p+"static/media/map-walls-bump.40f05869.png",T=n.p+"static/media/level-rooms.5251ade2.obj",I=n.p+"static/media/floor_outer_map.35e50f6e.jpg",L=n.p+"static/media/botMap.972e276e.png",F=[{type:"obj",filename:T,key:"level-rooms"},{type:"glb",filename:n.p+"static/media/botAnim.5bfca6de.glb",key:"bot"},{type:"cubeTextures",filename:{px:w,nx:O,py:N,ny:j,pz:S,nz:A},key:"skyBox"},{type:"cubeTextures",filename:{px:E,nx:C,py:M,ny:k,pz:D,nz:x},key:"ironEnv"},{type:"img",filename:L,key:"botMap"},{type:"img",filename:R,key:"bumpWalls"},{type:"img",filename:I,key:"mapFloorOuter",wrap:!0}],G={iron:{mat:"MeshPhongMaterial",props:{color:16777215,emissive:13192,specular:16777215,shininess:60,bumpMap:"botMap",bumpScale:.1,envMap:"ironEnv",reflectivity:.5,map:"botMap",skinning:!0}},wall:{mat:"MeshPhongMaterial",props:{color:17510,emissive:16777215,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5,specular:2236962}},green:{mat:"MeshPhongMaterial",props:{color:17510,emissive:16777215,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5}},road:{mat:"MeshPhongMaterial",props:{color:10556063,emissive:10556063,map:"mapFloorOuter",bumpMap:"mapFloorOuter",bumpScale:1,envMap:"skyBox",reflectivity:.5}}},Q=175.335,Y="FRAME_UPDATE",B={"-2":{outer:{fogNear:-200,fogFar:500,color:1582461},corridorLight:{fogNear:-40,fogFar:150,color:7012460},default:{fogNear:-40,fogFar:150,color:8914344}},"-1":{outer:{fogNear:20,fogFar:500,color:1582461},firstRoomLight:{fogNear:-40,fogFar:150,color:9054},corridorLight:{fogNear:-40,fogFar:150,color:7012460},default:{fogNear:-40,fogFar:150,color:3019147}},0:{default:{fogNear:-40,fogFar:150,color:3950848}},1:{default:{fogNear:-40,fogFar:150,color:933458}},2:{default:{fogNear:0,fogFar:80,color:661347}},3:{default:{fogNear:0,fogFar:80,color:680768}},4:{default:{fogNear:0,fogFar:80,color:11272192}}},U={canId:"webgl-canvas",rendererCon:{antialias:!0},clearColor:B[-1].outer.color,backgroundColor:B[-1].outer.color,amb:{color:B[-1].outer.color,strength:.7}},P={speed:.8,speedRot:.02,speedDown:-.45,offsetFromFloor:10,offsetFromFloorFactor:.5,offsetWallCollision:3.5,level:-13,startRot:[0,0,0],startPos:[100,-60,1e3],cameraData:{fov:90,ratio:window.innerWidth/window.innerHeight,near:.1,far:1e3,pos:[0,2,-.5]},frontObjPos:[0,0,-1],lightDataOne:{color:16777215,strength:5e3,pos:[0,50,5]}};var H,K,q,W,z=n(7),V=n(3),X=[{oldState:"outer",newState:"corridor",oldQuadrant:[0,-2,4],newQuadrant:[0,-2,3],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"corridorLight",backgroundImg:!1}]},{oldState:"corridor",newState:"outer",oldQuadrant:[0,-2,3],newQuadrant:[0,-2,4],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"outer"}]},{oldState:"corridor",newState:"firstRoom",oldQuadrant:[0,-1,2],newQuadrant:[0,-1,1],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"firstRoomLight"}]},{oldState:"firstRoom",newState:"corridor",oldQuadrant:[0,-1,1],newQuadrant:[0,-1,2],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"corridorLight"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:[0,-1,"ANY_MINUS_ONE"],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:["ANY_MINUS_ONE",-1,0],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"firstRoom",newState:"playLevel",oldQuadrant:[0,-1,0],newQuadrant:["ANY_PLUS_ONE",-1,0],emitData:[{emitKey:"DESTROY_START_CORRIDOR"},{emitKey:"CHANGE_QUADRANT"}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY_PLUS_ONE","ANY"],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"default"},{emitKey:"CHANGE_QUADRANT",counter:function(){return 0}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY_MINUS_ONE","ANY"],emitData:[{emitKey:"CHANGE_ENVIRONMENT",environmentMode:"default"},{emitKey:"CHANGE_QUADRANT",counter:function(){return 100}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY","ANY_MINUS_ONE"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY_MINUS_ONE","ANY","ANY"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY_PLUS_ONE","ANY","ANY"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]},{oldState:"playLevel",newState:"playLevel",oldQuadrant:["ANY","ANY","ANY"],newQuadrant:["ANY","ANY","ANY_PLUS_ONE"],emitData:[{emitKey:"CHANGE_QUADRANT",counter:function(e){return++e}}]}],J="outer",Z=function(e,t){for(var n=0;n<X.length;++n){var o=$(Object(z.a)(e),Object(z.a)(t),Object(V.a)(Object(V.a)({},X[n]),{},{oldQuadrant:Object(z.a)(X[n].oldQuadrant),newQuadrant:Object(z.a)(X[n].newQuadrant)}));if(o)return o}return{levelState:J}},$=function(e,t,n){var o=n.oldState,a=n.newState,r=n.oldQuadrant,i=n.newQuadrant,s=n.emitData;if(J===o&&("ANY"===r[0]&&(r[0]=e[0]),"ANY"===r[1]&&(r[1]=e[1]),"ANY"===r[2]&&(r[2]=e[2]),"ANY"===i[0]&&(i[0]=t[0]),"ANY"===i[1]&&(i[1]=t[1]),"ANY"===i[2]&&(i[2]=t[2]),"ANY_PLUS_ONE"===i[0]&&(i[0]=e[0]+1),"ANY_PLUS_ONE"===i[1]&&(i[1]=e[1]+1),"ANY_PLUS_ONE"===i[2]&&(i[2]=e[2]+1),"ANY_MINUS_ONE"===i[0]&&(i[0]=e[0]-1),"ANY_MINUS_ONE"===i[1]&&(i[1]=e[1]-1),"ANY_MINUS_ONE"===i[2]&&(i[2]=e[2]-1),r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]))return J=a,s.map((function(e){return Object(V.a)(Object(V.a)({},e),{},{levelState:J,oldQuadrant:Object(z.a)(r),newQuadrant:Object(z.a)(i)})}))},ee=function(){var e=[];return{update:function(t){var n=t.x,o=t.y,a=t.z,r=[Math.floor(n/Q),Math.floor(o/70),Math.floor(a/Q)];if(r[0]!==e[0]||r[1]!==e[1]||r[2]!==e[2]){var i={isChanged:!0,currentQuadrant:r,oldQuadrant:e};return e=[].concat(r),i}return{isChanged:!1}}}},te=n(0),ne=n(20),oe=n(21),ae=null,re=null,ie={},se=0,le=function(e){"obj"===e.type&&H.load(e.filename,(function(t){ie[e.key]=t,ce()})),"glb"!==e.type&&"gltf"!==e.type||q.load(e.filename,(function(t){ie[e.key]=t,ce()})),"img"===e.type&&K.load(e.filename,(function(t){ie[e.key]=t,ce()})),"cubeTextures"===e.type&&W.load([e.filename.px,e.filename.nx,e.filename.py,e.filename.ny,e.filename.pz,e.filename.nz],(function(t){ie[e.key]=t,ce()}))},ce=function(){++se<re.length?le(re[se]):ae(ie)};var ue=function(e){for(var t in e)e[t].wrapS&&(e[t].wrapS=e[t].wrapT=te.RepeatWrapping);var n=["bumpMap","envMap","map","normalMap","lightMap","aoMap"],o={},a=function(t){o[t]=new te[G[t].mat](Object(V.a)({},G[t].props)),n.map((function(n){return G[t].props[n]&&(o[t][n]=e[G[t].props[n]])}))};for(var r in G)a(r);return o},de=n(13);var pe=[],fe=function(e){return pe.push(e)},me=function(e){return pe=pe.filter((function(t){return t!==e}))},he=[],be=function(e){return he.push(e)},ge=function(e){return he=he.filter((function(t){return e!==t}))},ve=[];function ye(e){var t,n=e,o=P.startPos,a=P.startRot,r=P.cameraData,i=P.frontObjPos,l=P.lightDataOne,c=P.speed,u=P.offsetFromFloor,d=P.offsetFromFloorFactor,p=P.speedDown,f=P.offsetWallCollision,m=P.speedRot,h={},b=!1,v=!0,y=new te.Object3D;y.position.fromArray(o),y.rotation.fromArray(a);var _=new te.Object3D;_.position.fromArray(i),y.add(_);var w=r.fov,O=r.ratio,N=r.near,j=r.far,S=r.pos;(t=new te.PerspectiveCamera(w,O,N,j)).position.fromArray(S),y.add(t);var A=l.color,E=l.strenth,C=l.pos,M=new te.PointLight(A,E);M.position.fromArray(C),y.add(M);var k=function(e,t,n,o){var a=e,r=t,i=n,s=o,l=new te.Vector3,c=new te.Vector3(0,-1,0),u=!0;return{check:function(e){if(!u){l.copy(a.position);var t=new te.Raycaster(l,c).intersectObjects(pe);t&&t[0]&&t[0].distance>r+i?a.position.y+=s*e.count:!t||t[0]?a.position.y=t[0].point.y+r:a.position.y+=s*e.count}},start:function(){u=!1}}}(y,u,d,p),D=function(e,t,n){var o=n,a=e,r=t,i=new te.Vector3,s=new te.Vector3;return{check:function(){r.getWorldPosition(s),i.copy(a.position),s.sub(i);var e=new te.Raycaster(i,s).intersectObjects(he);return e[0]&&e[0].distance<o}}}(y,_,f),x=function(e,t){return function(){ve.forEach((function(n){e.position.distanceTo(n.position)<10&&!n.userData.nearPlayer&&(n.userData.nearPlayer=!0,t.emit("nearMesh")({toNear:!0,mesh:n})),e.position.distanceTo(n.position)>=10&&n.userData.nearPlayer&&(n.userData.nearPlayer=!1,t.emit("nearMesh")({toNear:!1,mesh:n}))}))}}(y,n),R=y.position.y,T=0,I=!1;return n.subscribe("keyEvent")((function(e){return h=e})),n.subscribe(Y)((function(e){if(!b&&!v&&(k.check(e),h)){if(h.up){if(D.check())return;y.translateZ(-c*e.count),x(),n.emit("playerMove")(y.position)}h.left&&(y.rotation.y+=m*e.count),h.right&&(y.rotation.y-=m*e.count),R>y.position.y?++T:T=0,R=y.position.y,T>800&&!I&&(I=!0,setTimeout((function(){s(g.dispatch).toggleFinalMessage(!0)}),2e4))}})),n.subscribe("toggleDialog")((function(e){return b=e.isOpen})),{start:function(){v=!1,k.start()},getObj:function(){return y},getCamera:function(){return t},setToPos:function(e,t,n){return y.position.set(e,t,n)}}}n(36);var _e=document.querySelector(".progress"),we=-100,Oe=!0;!function e(){Oe&&setTimeout((function(){0==++we&&(we=-100),_e.style.marginLeft=we+"%",e()}),30)}();var Ne=["room_02","room_03","room_04","room_05"],je=["outer_walls","outer_floor","outer_road"];var Se=n(1),Ae=n(2),Ee={x:55,z:75},Ce=function(){function e(){Object(Se.a)(this,e),this.inScene=!1,this._state="go",this._targetAngle=null,this.container=new te.Group,this._modelGroup=new te.Group,this._modelGroup.position.x=Ee.x,this._modelGroup.position.z=Ee.z,this._modelGroup.rotation.y=Math.random()*(2*Math.PI),this.container.add(this._modelGroup),this._objFrom=new te.Object3D,this._modelGroup.add(this._objFrom),this._objTo=new te.Object3D,this._objTo.position.set(0,0,1),this._modelGroup.add(this._objTo);var t=function(e){var t={animations:e.animations,scene:e.scene.clone(!0)},n={};e.scene.traverse((function(e){e.isSkinnedMesh&&(n[e.name]=e)}));var o={},a={};for(var r in t.scene.traverse((function(e){e.isBone&&(o[e.name]=e),e.isSkinnedMesh&&(a[e.name]=e)})),n){for(var i=n[r].skeleton,s=a[r],l=[],c=0;c<i.bones.length;++c){var u=o[i.bones[c].name];l.push(u)}s.bind(new te.Skeleton(l,i.boneInverses),s.matrixWorld)}return t}(e.botScene);this.model=t.scene.children[0],this.model.children[1].material=e.botMaterial,this._animations=e.botScene.animations,this._mixer=new te.AnimationMixer(this.model.children[1]),this._walkAction=this._mixer.clipAction(this._animations[0]),this._walkAction.play(),this._modelGroup.add(this.model)}return Object(Ae.a)(e,[{key:"update",value:function(e){this._mixer.update(e.delta),this._componentCollision&&this._updateState()}},{key:"setCollisionMesh",value:function(e){this._collisionMeshes=[e],this.container.add(e),e.material.visible=!1,this._componentCollision=Me(this._objFrom,this._objTo,7,this._collisionMeshes)}},{key:"removeCollisionMesh",value:function(){this._collisionMeshes=null,this._componentCollision=null}},{key:"prepareToSay",value:function(e){this._state="say",this._modelGroup.lookAt(e.x,this.container.position.y,e.z)}},{key:"_updateState",value:function(){"go"===this._state&&(this._componentCollision.check()?this._startRotate():this._modelGroup.translateZ(.1));"rotate"===this._state&&(this._modelGroup.rotation.y+=this._targetAngle-this._modelGroup.rotation.y<0?-.01:.01,this._modelGroup.rotation.y%=2*Math.PI,Math.abs(this._modelGroup.rotation.y-this._targetAngle)<.5&&this._startGo())}},{key:"_startGo",value:function(){this._state="go"}},{key:"_startRotate",value:function(){this._state="rotate",this._targetAngle=(this._modelGroup.rotation.y+1.5+4*Math.random())%(2*Math.PI)}}]),e}();Ce.botScene=null,Ce.botMaterial=null;var Me=function(e,t,n,o){var a=new te.Vector3,r=new te.Vector3;return{check:function(){return t.getWorldPosition(r),e.getWorldPosition(a),r.sub(a),!!new te.Raycaster(a,r,0,20).intersectObject(o[0],!0)[0]}}},ke=175.335,De=(n(4),n(12)),xe=n.n(De),Re=n(9),Te=n(22),Ie={sceneEnvironment:{color:B[-1].outer.color,fogNear:B[-1].outer.fogNear,fogFar:B[-1].outer.fogFar,backgroundImgKey:"skyBox"},playerQuadrant:{oldQuadrant:[0,0,0],newQuadrant:[0,0,0],counter:null},level:{isStartCorridorShow:!0},ui:{isShowButtFullScreen:!0,isShowInfo:!1,isShowFinalMessage:!1,botAnswers:[],userReplicies:[],history:[],isDialog:!1,isButtonDialog:!1},botIndex:-1,phraseIndex:0,phrasesData:[{phrases:[{q:"\u041f\u0440\u0438\u0432\u0435\u0442 !",a:"\u0414\u0435\u043d\u044c \u0434\u043e\u0431\u0440\u044b\u0439, \u043a\u0440\u0435\u043c\u043d\u0438\u0435\u0432\u0430\u044f \u0444\u043e\u0440\u043c\u0430 \u0436\u0438\u0437\u043d\u0438.",event:"nextReply",levelEvent:null},{q:"\u0427\u0442\u043e \u044d\u0442\u043e \u0437\u0430 \u043c\u0435\u0441\u0442\u043e ?",a:"\u042d\u0442\u043e \u0432\u0445\u043e\u0434 \u0432 \u044d\u043d\u0442\u0440\u043e\u043f\u0438\u0439\u043d\u044b\u0439 \u0433\u0438\u043f\u043f\u0435\u0440-\u043b\u0430\u0431\u0438\u0440\u0438\u043d\u0442.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0427\u0442\u043e \u0442\u044b \u0441\u0434\u0435\u0441\u044c \u0434\u0435\u043b\u0430\u0435\u0448\u044c ?",a:"\u0421\u043e\u0431\u0438\u0440\u0430\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u043d\u043e\u0447\u0438.",event:"nextReply",levelEvent:null},{q:"\u0412 \u043a\u0430\u043a\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043c\u043d\u0435 \u0438\u0434\u0442\u0438 ?",a:"\u0417\u0434\u0435\u0441\u044c \u043d\u0435\u0442 \u0441\u0442\u043e\u0440\u043e\u043d. \u0417\u0434\u0435\u0441\u044c \u0432\u0430\u0436\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u0438\u043d\u043d\u0430 \u043f\u0443\u0442\u0438.",event:"close",levelEvent:null}]},{phrases:[{q:"\u0412 \u043a\u0430\u043a\u0443\u044e \u0441\u0442\u043e\u0440\u043e\u043d\u0443 \u043c\u043d\u0435 \u0438\u0434\u0442\u0438?",a:"\u0422\u044b \u0443\u0436\u0435 \u0441\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u043b.",event:"nextReply",levelEvent:null},{q:"\u041a\u0430\u043a \u0434\u043e\u043b\u0433\u043e \u0438\u0434\u0442\u0438?",a:"\u0422\u0432\u043e\u0439 \u043f\u0443\u0442\u044c \u0435\u0449\u0435 \u043d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d.",event:"close",levelEvent:"addStairs"}]},{phrases:[{q:"\u0427\u0442\u043e \u0442\u044b \u0441\u0434\u0435\u0441\u044c \u0434\u0435\u043b\u0430\u0435\u0448\u044c ?",a:"\u0421\u043e\u0431\u0438\u0440\u0430\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u0434\u043d\u044f.",event:"close",levelEvent:"addWell"}]},null],isCanChangeBotIndex:!0,isCanChangeBotCounter:0},Le=Object(Re.c)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;if("CLICK_FULL_SCREEN"===t.type)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isShowButtFullScreen:!1})});if("EXIT_FULL_SCREEN"===t.type)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isShowButtFullScreen:!0})});if("INFO_TOGGLE"===t.type)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isShowFinalMessage:!1,isShowInfo:t.mode})});if("TOGGLE_FINAL_MESSAGE"===t.type)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isShowFinalMessage:t.mode,isShowInfo:!1})});if("CHANGE_ENVIRONMENT"===t.type){var n=t.newQuadrant,o=t.environmentMode;if(!B[n[1]])return e;var a=B[n[1]][o],r=a.fogNear,i=a.fogFar,s=a.color;return Object(V.a)(Object(V.a)({},e),{},{sceneEnvironment:{fogNear:r,fogFar:i,color:s}})}if("CHANGE_QUADRANT"===t.type){console.log();var l=e.isCanChangeBotCounter+1,c=e.isCanChangeBotIndex;return l>2&&(c=!0,l=0),Object(V.a)(Object(V.a)({},e),{},{playerQuadrant:Object(V.a)({},t),isCanChangeBotIndex:c,isCanChangeBotCounter:l})}if("DESTROY_START_CORRIDOR"===t.type)return Object(V.a)(Object(V.a)({},e),{},{level:Object(V.a)(Object(V.a)({},e.level),{},{isStartCorridorShow:!1})});if("CLICK_PHRASE"===t.type)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{botAnswers:[].concat(Object(z.a)(e.ui.botAnswers),[t.phrase]),userReplicies:[]})});if("PHRASE_EVENT"===t.type){var u=t.phrase.event;if("nextReply"===u){var d=e.phrasesData[e.botIndex],p=[d.phrases[e.phraseIndex+1]];return Object(V.a)(Object(V.a)({},e),{},{phraseIndex:e.phraseIndex++,ui:Object(V.a)(Object(V.a)({},e.ui),{},{userReplicies:p})})}if("close"===u)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{userReplicies:[],isButtonDialog:!0})})}if("CHANGE_BOT"===t.type)return Object(V.a)(Object(V.a)({},e),{},{isCanChangeBotIndex:!0});if("TOGGLE_DIALOG"===t.type){if(!e.isCanChangeBotIndex)return Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isDialog:t.isDialog,isButtonDialog:!0})});var f=e.isCanChangeBotIndex?e.botIndex+1:e.botIndex,m=!1,h=e.phrasesData[f]?[e.phrasesData[f].phrases[e.phraseIndex]]:[];return Object(V.a)(Object(V.a)({},e),{},{botIndex:f,ui:Object(V.a)(Object(V.a)({},e.ui),{},{userReplicies:h,botAnswers:[],isDialog:t.isDialog,isButtonDialog:m}),isCanChangeBotIndex:!1})}return"TOGGLE_BUTTON"===t.type?Object(V.a)(Object(V.a)({},e),{},{ui:Object(V.a)(Object(V.a)({},e.ui),{},{isDialog:!1,isButtonDialog:t.isButtonDialog})}):e}}),Fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Re.d,Ge=Object(Re.e)(Le,Fe(Object(Re.a)(Te.a)));xe.a.render(Object(d.jsx)(o.a,{store:Ge,children:Object(d.jsx)(v,{})}),document.getElementById("root")),function(e){var t=document.querySelector(".app-wrapper");e.subscribe("mouseDown")((function(e){"butt-fullscreen"===e&&n()}));var n=function(){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},o=function(e){t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",t.style.fontSize=Math.max(Math.min(Math.min(window.innerWidth,window.innerHeight),400),350)/50+"px",document.fullscreenElement||l(g.dispatch).exitFullScreen()};window.addEventListener("resize",o),o()}(i);var Qe=function(e){!function(e){var t=e.emit(Y),n={time:0,delta:0,count:0,oldTime:0},o=_.a((function(){return n}),(function(e){return e.time=Date.now(),e}),(function(e){return e.delta=.001*(e.time-e.oldTime),(isNaN(e.delta)||e.delta>1e3||0==e.delta)&&(e.delta=1e3/60*.001),e}),(function(e){return e.count=e.delta/(1/60),e}),(function(e){return t(e),e}),(function(e){return e.oldTime=e.time,e}),(function(e){return n=e}));!function e(){requestAnimationFrame(e),o(n)}()}(i),i.subscribe(Y)((function(){return de.b()}));var t=function(e,t,n){var o=U.canId,a=U.rendererCon,r=U.clearColor,i=U.amb,s=document.getElementById(o);a.canvas=s;var l=new te.WebGLRenderer(a);l.setClearColor(r),l.setPixelRatio(window.devicePixelRatio),l.setSize(window.innerWidth,window.innerHeight);var c,u=new te.Scene,d=n.getState().app.sceneEnvironment,p=d.color,f=d.fogNear,m=d.fogFar,h=d.backgroundImgKey;u.background=t[h]||null,u.fog=new te.Fog(p,f,m);var b=i.color,g=i.strength;c=new te.AmbientLight(b,g),u.add(c);var v=null,y=function(){var e={width:window.innerWidth,height:window.innerHeight};l.setSize(e.width,e.height),v&&(v.aspect=e.width/e.height,v.updateProjectionMatrix())};window.addEventListener("resize",y),y();var _=u.add.bind(u);e.subscribe(Y)((function(){return v&&l.render(u,v)}));var w=u.fog.near,O=u.fog.far,N=u.fog.color,j=n.getState().app.sceneEnvironment.backgroundImgKey;return n.subscribe((function(){var e=n.getState().app.sceneEnvironment,o=e.fogNear,a=e.fogFar,r=e.color,i=e.backgroundImgKey;if(o!==w||a!==O||r!==N){var s={color:u.fog.color,near:u.fog.near,far:u.fog.far},d={color:new te.Color(r),near:o,far:a};w=o,O=a,N=r,new de.a(s).to(d,3e3).onUpdate((function(){u.fog.color=s.color,u.fog.near=s.near,u.fog.far=s.far,c.color=s.color,l.setClearColor(s.color)})).start()}i!==j&&(u.background=t[i]||null)})),{setCamera:function(e){return v=e},addToScene:_}}(i,e,Ge);new y(i);var n=ye(i);t.setCamera(n.getCamera()),t.addToScene(n.getObj());var o=function(e){var t=ue(e),n={},o={};return e.collisionsBotsRooms={},e["level-rooms"].traverse((function(a){if(a.name.includes("room_")){var r=new te.Mesh(a.geometry,t.wall);n[a.name]=r,r.name=a.name,o[a.name]=r}if(a.name.includes("collision_")){var i=new te.Mesh(a.geometry);e.collisionsBotsRooms[a.name]=i,i.name=a.name,o[a.name]=i}if(a.name.includes("outer_walls")){var s=new te.Mesh(a.geometry,t.wall);s.name=a.name,o[a.name]=s}if(a.name.includes("outer_road")){var l=new te.Mesh(a.geometry,t.green);l.name=a.name,o[a.name]=l}if(a.name.includes("outer_floor")){var c=new te.Mesh(a.geometry,t.road);c.name=a.name,o[a.name]=c}})),{rooms:n,allMeshes:o,materials:t}}(e),a=o.allMeshes,r=o.rooms,s=o.materials,l=function(e,t,n,o){var a=new te.Group,r={},i="normal",s=function n(o,i){var s=i||Ne[Math.floor(Math.random()*Ne.length)],l="r_".concat(o[0],"_").concat(o[1],"_").concat(o[2]),c=t[s].clone();c.position.set(o[0]*Q,70*o[1],o[2]*Q),fe(c),be(c),a.add(c),r[l]=c,e.emit("levelChanged")({typeLevelChange:"createRoom",instanceKey:s,objKey:l,kv:o,isAddBot:"room_01"===s}),"room_06"===s&&n([o[0],o[1]+1,o[2]],"room_dummy")},l=function t(n){var o="r_".concat(n[0],"_").concat(n[1],"_").concat(n[2]);if(r[o]){var i=r[o].name;a.remove(r[o]),me(r[o]),ge(r[o]),delete r[o],e.emit("levelChanged")({typeLevelChange:"destroyRoom",instanceKey:i,objKey:o,kv:n,isRemoveBot:"room_01"===i}),"room_dummy"===i&&t([n[0],n[1]-1,n[2]]),"room_06"===i&&t([n[0],n[1]+1,n[2]])}};s([0,-1,0],"room_02"),s([0,-1,-1],"room_02"),s([-1,-1,0],"room_02"),s([1,-1,0],"room_02");for(var c={},u=0;u<je.length;++u){var d=n[je[u]].clone();fe(d),be(d),a.add(d),d.position.set(0,-70,0),c[je[u]]=d}var p=0,f=!1,m=o.getState(),h=m.app.playerQuadrant.oldQuadrant,b=m.app.playerQuadrant.newQuadrant,g=m.app.level.isStartCorridorShow;return o.subscribe((function(){var t=o.getState();if(g&&g!==t.app.level.isStartCorridorShow)for(var n in g=!1,c)me(c[n]),ge(c[n]),a.remove(c[n]);var u=t.app.playerQuadrant,d=u.type,m=(u.levelState,u.oldQuadrant),v=u.newQuadrant,y=u.counter;if("CHANGE_QUADRANT"===d&&(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||b[0]!==v[0]||b[1]!==v[1]||b[2]!==v[2])){h=Object(z.a)(m),b=Object(z.a)(v);var _=Ne[Math.floor(Math.random()*Ne.length)];y&&(p=y(p),f?f=!1:(p<3?i="normal":p<100?"normal"===i&&(i="addBot"):i="addStairs","addBot"===i&&(_="room_01",f=!0),"addStairs"===i&&(_="room_06",f=!0),"addWell"===i&&(_="room_07"))),e.subscribe("changeLevelMode")((function(e){return i=e}));var w=m,O=v;O[0]<w[0]&&(console.log("----------- west"),l([w[0]+1,w[1],w[2]]),r["r_".concat(O[0]+1,"_").concat(O[1],"_").concat(O[2])]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],s([w[0]-2,w[1],w[2]],_),l([w[0],w[1],w[2]-1]),s([O[0],O[1],O[2]-1],_),l([w[0],w[1],w[2]+1]),s([O[0],O[1],O[2]+1],_)),O[0]>w[0]&&(console.log("----------- east"),l([w[0]-1,w[1],w[2]]),r["r_".concat(O[0]-1,"_").concat(O[1],"_").concat(O[2])]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],s([w[0]+2,w[1],w[2]],_),l([w[0],w[1],w[2]-1]),s([O[0],O[1],O[2]-1],_),l([w[0],w[1],w[2]+1]),s([O[0],O[1],O[2]+1],_)),O[2]<w[2]&&(console.log("-----------north"),l([w[0],w[1],w[2]+1]),r["r_".concat(O[0],"_").concat(O[1],"_").concat(O[2]+1)]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],s([w[0],w[1],w[2]-2],_),l([w[0]-1,w[1],w[2]]),s([O[0]-1,O[1],O[2]],_),l([w[0]+1,w[1],w[2]]),s([O[0]+1,O[1],O[2]],_)),O[2]>w[2]&&(console.log("-----------south"),l([w[0],w[1],w[2]-1]),r["r_".concat(O[0],"_").concat(O[1],"_").concat(O[2]-1)]=r["r_".concat(w[0],"_").concat(w[1],"_").concat(w[2])],s([w[0],w[1],w[2]+2],_),l([w[0]-1,w[1],w[2]]),s([O[0]-1,O[1],O[2]],_),l([w[0]+1,w[1],w[2]]),s([O[0]+1,O[1],O[2]],_)),(O[1]>w[1]||O[1]<w[1])&&(console.log("-----------top"),l([w[0],w[1],w[2]-1]),s([O[0],O[1],O[2]-1]),l([w[0],w[1],w[2]+1]),s([O[0],O[1],O[2]+1]),l([w[0]-1,w[1],w[2]]),s([O[0]-1,O[1],O[2]]),l([w[0]+1,w[1],w[2]]),s([O[0]+1,O[1],O[2]]))}})),{group:a}}(i,r,a,Ge).group;t.addToScene(l);var c=function(e,t,n,o){Ce.botMaterial=t.iron,Ce.botScene=e.bot;for(var a=new te.Group,r=[],i=0;i<5;++i){var s=new Ce;a.add(s.container),s.container.position.set(30*i-30,-92,750),s.inScene="aaa",s.setCollisionMesh(e.collisionsBotsRooms.collision_r_01.clone()),r.push(s)}n.subscribe(Y)((function(e){for(var t=0;t<r.length;++t)r[t].inScene&&r[t].update(e)}));var l=o.getState().app.level.isStartCorridorShow;return o.subscribe((function(){var e=o.getState();if(l&&l!==e.app.level.isStartCorridorShow){l=e.app.level.isStartCorridorShow;for(var t=0;t<r.length;++t)r[t].inScene=null,r[t].container.position.y=-1e4,r[t].removeCollisionMesh()}})),n.subscribe("levelChanged")((function(t){t.typeLevelChange,t.instanceKey;var n=t.objKey,o=t.kv,a=t.isAddBot,i=t.isRemoveBot;if(a)for(var s=0;s<r.length;++s)if(!r[s].inScene){r[s].inScene=n,r[s].container.position.set(o[0]*ke,70*o[1]+14,o[2]*ke),r[s].setCollisionMesh(e.collisionsBotsRooms.collision_r_01.clone());break}if(i)for(var l=0;l<r.length;++l)r[l].inScene===n&&(r[l].inScene=null,r[l].container.position.y=-1e4,r[l].removeCollisionMesh())})),n.subscribe("playerMove")((function(e){for(var t=0;t<r.length;++t)if(r[t].inScene){var n=new te.Vector3;r[t]._modelGroup.getWorldPosition(n);var o=n.distanceTo(e);"say"===r[t]._state&&o>30?(r[t]._startRotate(),u(g.dispatch).toggleButtonDialog(!1)):"say"!==r[t]._state&&o<30&&(r[t].prepareToSay(e),u(g.dispatch).toggleButtonDialog(!0))}})),{groupBots:a}}(e,s,i,Ge);t.addToScene(c.groupBots),function(){var e=ee();i.subscribe("playerMove")((function(t){var n=e.update(t),o=n.currentQuadrant,a=n.oldQuadrant;if(n.isChanged){var r=Z(a,o);r.length&&r.forEach((function(e){return g.dispatch(Object(V.a)(Object(V.a)({},e),{},{type:e.emitKey}))}))}}))}(),setTimeout((function(){return n.start()}),500),function(){var e=document.createElement("div");e.style.display="none",e.classList.add("info-cont");var t=document.createElement("div");t.classList.add("info-wrap"),e.appendChild(t);var n=document.createElement("div");n.innerHTML=b('Previous part "Factory": '),n.innerHTML+="<a href='http://js.otrisovano.ru".concat(b("/bridge"),'\' target="blanck">').concat(b("link"),"</a></br>"),n.innerHTML+=b("Author: "),n.innerHTML+="<a href='http://otrisovano.ru' target=\"blanck\">".concat(b("link"),"</a></br>"),n.innerHTML+=b("Github: "),n.innerHTML+="<a href='https://github.com/fire888/levels' target=\"blanck\">".concat(b("link"),"</a></br>"),t.appendChild(n);var o=document.createElement("button");o.classList.add("control"),o.innerText="x",o.addEventListener("click",(function(){e.style.display="none"})),t.appendChild(o),document.querySelector(".butt-info").addEventListener("click",(function(){e.style.display="flex"})),document.querySelector(".app-wrapper").appendChild(e)}(),function(e){var t=document.querySelector(".startbuttons-wrapper"),n=document.querySelector(".progress-wrapper");Oe=!1,t.style.display="flex",t.addEventListener("click",(function(t){e.emit("setLanguage")(t.target.dataset.lang),document.querySelector(".start-screen").style.display="none"})),n.style.display="none"}(i)};window.addEventListener("load",(function(){return(e=F,new Promise((function(t){re=e,ae=t,se=0,H=H||new ne.a,K=K||new te.TextureLoader,q=q||new oe.a,W=W||new te.CubeTextureLoader,le(re[se])}))).then(Qe);var e}))}},[[37,1,2]]]);
//# sourceMappingURL=main.e019741f.chunk.js.map