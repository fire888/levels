{"version":3,"sources":["helpers/util_emitter.js","store/actions.js","componentsReact/UserReplicies.js","componentsReact/BotAnswers.js","constants/constants_replicies.js","helpers/util_translate.js","componentsReact/App.js","helpers/util_keyBoard.js","assets/skybox/px.jpg","assets/skybox/nx.jpg","assets/skybox/py.jpg","assets/skybox/ny.jpg","assets/skybox/pz.jpg","assets/skybox/nz.jpg","assets/matIronBox/posx.jpg","assets/matIronBox/negx.jpg","assets/matIronBox/posy.jpg","assets/matIronBox/negy.jpg","assets/matIronBox/posz.jpg","assets/matIronBox/negz.jpg","assets/level-rooms.obj","assets/floor_outer_map.jpg","assets/botMap.png","constants/constants_elements.js","assets/botAnim2.glb","helpers/utils_loadAssets.js","store/actionByChangeQuadrant.js","helpers/helper_prepareMeshesFromAssets.js","shaders/saturate.js","components/component_collisionFloor.js","components/component_collisionWalls.js","components/component_checkNearItem.js","entities/createPlayer.js","systems/systemHtml_intro.js","systems/system_level.js","entities/Bot.js","helpers/util_GLTFcopy.js","systems/system_bots.js","store/createStore.js","index.js","helpers/util_deviceResizer.js","helpers/util_frameUpater.js","entities/createStudio.js"],"names":["eventEmitter","getOrCreateArrFromObj","obj","key","emitter","storage","emit","id","data","forEach","action","subscribe","callback","push","filter","item","showAll","s","length","console","log","createEmitter","startPlay","dispatch","type","newQuadrant","environmentMode","showBackground","startFinalFog","clickFullScreen","exitFullScreen","clickInfo","val","mode","toggleDialog","clickPhrase","r","phrase","setTimeout","levelEvent","is","isDialog","toggleButtonDialog","isButtonDialog","UserReplicies","connect","state","userReplicies","app","ui","props","className","map","onClick","q","Math","floor","random","BotAnswers","botAnswers","a","TRANSLATE_WORLDS","currentLanguage","keyLanguage","t","pr","isShowClickFullScreen","isShowButtFullScreen","isShowInfo","isShowFinalMessage","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","href","target","KeyBoard","keys","keyUpdate","keyCode","isDown","document","addEventListener","event","ASSETS_TO_LOAD","filename","levelRoomsSrc","px","pxjpg","nx","nxjpg","py","pyjpg","ny","nyjpg","pz","pzjpg","nz","nzjpg","pxjpg2","nxjpg2","pyjpg2","nyjpg2","pzjpg2","nzjpg2","botMap","mapFloorOuter","wrap","MATERIALS_CONFIG","mat","color","emissive","specular","shininess","bumpMap","bumpScale","envMap","reflectivity","skinning","S","FRAME_UPDATE","FLOORS_CONF","fogNear","fogFar","backgroundImgKey","studioConfig","canId","rendererCon","antialias","clearColor","backgroundColor","amb","strength","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","lightDataOne","objLoader","textureLoader","gltfLoader","cubeTextureLoader","CHANGE_LAYER_STATE","oldState","newState","oldQuadrant","emitData","emitKey","backgroundImg","counter","levelState","getEmitsByChangeQuadrant","playerOldQ","playerNewQ","i","getData","conf","createCheckerNewQuadrant","update","x","y","z","currentQuadrant","isChanged","dataToLoad","assets","index","loadAsset","load","model","checkComplete","result","createMaterials","wrapS","wrapT","THREE","mapsKeys","materials","keyMap","Saturate","uniforms","value","vertexShader","fragmentShader","FLOORS_ARRAY","setItemToFloorsCollision","removeItemFromFloorsCollision","mesh","WALLS_ARRAY","setItemToWallCollision","removeItemFromWallCollision","arrItems","createPlayer","emitterLink","camera","isButtonsDisabled","isBlocked","mainObj","position","fromArray","rotation","frontObj","add","strenth","light","checkFloors","objFromLink","offset","delta","objFrom","vec3Src","vec3Ray","isDisable","check","updateData","copy","intersectsFloor","intersectObjects","distance","count","point","start","createComponentCollisionFloors","checkWalls","objToLink","objTo","vec3Src2","vec3Ray2","getWorldPosition","sub","intersectsWalls","createComponentCollisionWalls","checkNearItem","distanceTo","userData","nearPlayer","toNear","createCheckerNearItem","oldY","countDropped","isGameComplete","translateZ","toggleFinalMessage","isOpen","getObj","getCamera","setToPos","set","loader","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","style","marginLeft","STANDART_ROOMS","START_ROOMS","OFFSETS","Bot","this","inScene","_state","_targetAngle","container","_modelGroup","PI","_objFrom","_objTo","gltf","clone","animations","scene","skinnedMeshes","traverse","node","isSkinnedMesh","name","cloneBones","cloneSkinnedMeshes","isBone","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","bind","boneInverses","matrixWorld","GLTFCopy","botScene","children","material","botMaterial","_animations","_mixer","_walkAction","clipAction","play","timeScale","_speakAction","_componentCollision","_updateState","_collisionMeshes","visible","stop","lookAt","_startRotate","abs","_startGo","arrWalls","intersectObject","appData","sceneEnvironment","playerQuadrant","oldDialogPlayerQuadrant","isStartCorridorShow","history","botIndex","phraseIndex","phrasesData","phrases","rootReducer","combineReducers","isNewBot","isCanChangeBotIndex","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","ReactDOM","render","getElementById","appWrapper","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","resize","e","width","height","fontSize","max","min","fullscreenElement","createDeviceResizer","init","emitFrameUpdate","time","oldTime","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","createFrameUpdater","TWEEN","studio","canvas","renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","lightA","getState","background","fog","composer","EffectComposer","size","aspect","updateProjectionMatrix","addToScene","oldFogNear","oldFogFar","oldColor","oldBackgroundImgKey","startData","endData","to","onUpdate","setCamera","cam","addPass","RenderPass","ShaderPass","createStudio","player","rooms","allMeshes","collisionsBotsRooms","child","includes","geometry","wall","green","road","prepareMeshesFromAssets","group","objRooms","createRoom","kv","instanceKey","objKey","typeLevelChange","isAddBot","removeRoom","remove","isRemoveBot","startL","l","wentLevels","flagIsSpecial","initState","saveOldQuadrant","saveNewQuadrant","saveIsStartCorridorShow","keyCreateRoom","newMode","oldKv","curKv","createLevel","systemBots","iron","bot","groupBots","arrBots","setCollisionMesh","removeCollisionMesh","botWorldPos","prepareToSay","createSystemBots","checkerNewQuadrant","arrEmitData","createActionByChangedQuadrant","startButtons","progressWrapper","display","dataset","lang","showStartButton","Promise","resolve","OBJLoader","GLTFLoader","then"],"mappings":"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","file":"static/js/main.9d611fb5.chunk.js","sourcesContent":["let eventEmitter = null\r\n\r\nconst createEmitter = () => {\r\n    const storage = {}\r\n    return {\r\n        emit: id => data => getOrCreateArrFromObj(storage)(id).forEach(action => action(data)),\r\n        subscribe: id => callback => {\r\n            getOrCreateArrFromObj(storage)(id).push(callback)\r\n            return () => storage[id] = storage[id].filter(item => item !== callback)\r\n        },\r\n        showAll () {\r\n            const s = {}\r\n            for (let key in storage) {\r\n                s[key] = storage[key].length\r\n            }\r\n            console.log(s)\r\n        },\r\n    }\r\n}\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\nexport const emitter = eventEmitter = eventEmitter || createEmitter()\r\n\r\n\r\n\r\n\r\n\r\n","import { emitter } from '../helpers/util_emitter'\r\n\r\n\r\nexport const startPlay = dispatch => ({\r\n    startPlay: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'outer',\r\n    }),\r\n    showBackground: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'back',\r\n    }),\r\n    startFinalFog: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'start',\r\n    }),\r\n})\r\n\r\n\r\nexport const showMessages = dispatch => ({\r\n    toggleFinalMessage: val => dispatch({\r\n        type: 'TOGGLE_FINAL_MESSAGE',\r\n        mode: val,\r\n    })\r\n})\r\n\r\n\r\nexport const clickFullScreen = dispatch => ({\r\n    clickFullScreen: () => {\r\n        dispatch({\r\n            type: 'CLICK_FULL_SCREEN',\r\n        })\r\n    },\r\n\r\n    exitFullScreen: () => {\r\n        dispatch({\r\n            type: 'EXIT_FULL_SCREEN',\r\n        })\r\n    },\r\n})\r\n\r\n\r\nexport const clickInfo = dispatch => {\r\n    return ({\r\n        clickInfo: val => {\r\n            dispatch({\r\n                type: 'INFO_TOGGLE',\r\n                mode: val,\r\n            })\r\n        },\r\n    })\r\n}\r\n\r\n\r\n\r\nexport const toggleDialog = dispatch => ({\r\n    clickPhrase: r => {\r\n        dispatch({\r\n            type: 'CLICK_PHRASE',\r\n            phrase: r,\r\n        })\r\n\r\n        setTimeout(() => {\r\n            dispatch({\r\n                type: 'PHRASE_EVENT',\r\n                phrase: r,\r\n            })\r\n\r\n            r.levelEvent && emitter.emit('changeLevelMode')(r.levelEvent)\r\n        }, 1000)\r\n    },\r\n\r\n\r\n    toggleDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_DIALOG',\r\n            isDialog: is,\r\n        })\r\n    },\r\n\r\n\r\n    toggleButtonDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_BUTTON',\r\n            isButtonDialog: is,\r\n        })\r\n    }\r\n})\r\n","import { connect } from 'react-redux'\r\nimport { toggleDialog } from '../store/actions'\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    userReplicies: state.app.ui.userReplicies,\r\n})\r\n\r\n\r\n\r\n\r\nexport const UserReplicies = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"userReplicies\">\r\n            {props.userReplicies.map(item => (<button\r\n                    key={Math.floor(Math.random()* 100000)}\r\n                    onClick={() => {\r\n                        toggleDialog(props.dispatch).clickPhrase(item)\r\n                    }}>\r\n                    {item.q}\r\n                </button>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { connect } from 'react-redux'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    botAnswers: state.app.ui.botAnswers,\r\n})\r\n\r\n\r\n\r\n\r\nexport const BotAnswers = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"botAnswers\">\r\n            {props.botAnswers.map(item => (<div key={Math.floor(Math.random() * 100000)}>\r\n                    <div className=\"q\">{item.q}</div>\r\n                    <div className=\"a\">{item.a}</div>\r\n                </div>)\r\n            )}\r\n        </div>\r\n    )\r\n})","export const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'open dialog': 'начать диалог',\r\n        'close dialog': 'закончить диалог',\r\n        'To be continued': 'Продолжение следует',\r\n        'chapter': 'глава',\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        'After a long wandering in the desert...': 'После долгого блуждания по пустоши...',\r\n        'Stranger, I threw you a terminal with a pass phrase. Remember:': 'Незнакомец, я сбросил тебе терминал с парольной фразой. Запомни:',\r\n        'And blood-black nothingness began to spin...': 'Кроваво-черное ничто пустилось вить систему клеток,',\r\n        'A system of cells interlinked within cells interlinked within cells interlinked within one stem...' : 'связанных внутри, клеток, связанных внутри, клеток в едином стебле и явственно,',\r\n        'And dreadfully distinct against the dark, a tall white fountain played.': 'до жути на фоне тьмы ввысь белым бил фонтан.',\r\n        'Officer K-D-six-dash-three-dot-seven, let\\'s begin. Ready?': 'Офицер Кей Ди 6.3.7. приступим. Готовы?',\r\n        'Yes, sir.': 'Готов',\r\n        'No.': 'Не готов',\r\n        'Recite your baseline.': 'Ваша контрольная фраза.',\r\n        'I do not remember.': 'Я забыл.',\r\n        'I\\'ll come back later.': 'Я зайду попозже.',\r\n        'Cells.': 'Клетки.',\r\n        'Have you ever been in an institution? Cells.': 'Доводилось ли вам бывать в тюрьме? Клетки.',\r\n        'Do they keep you in a cell? Cells.': 'Вас держат в клетке? Клетки.',\r\n        'When you\\'re not performing your duties do they keep you in a little box? Cells.': 'Когда вы не исполняете обязанности, вас держат в коробке? Клетки.',\r\n        'Interlinked.': 'Связаны.',\r\n        'What\\'s it like to hold the hand of someone you love? Interlinked.': 'Что вы чувствуете держа за руку того кого любите? Связаны.',\r\n        'Did they teach you how to feel finger to finger? Interlinked.': 'Вас учили приставлять палец к пальцу? Связаны.',\r\n        'Do you long for having your heart interlinked? Interlinked.': 'Вы жаждете связать с кем-нибудь сердце? Связаны.',\r\n        'Do you dream about being interlinked? Interlinked.': 'Вам снится связь с кем-либо? Связаны.',\r\n        'What\\'s it like to hold your child in your arms? Interlinked.': 'Что вы чувствуете, держа в руках своего ребенка? Связаны.',\r\n        'Do you feel that there\\'s a part of you that\\'s missing? Interlinked.': 'Вы чувствуете, что вам чего-то не хватает? Связаны.',\r\n        'Within cells interlinked.': 'Клеток связанных внутри.',\r\n        'Why don\\'t you say that three times: Within cells interlinked.': 'Повторите три раза \"клеток связанных внутри',\r\n        'We\\'re done... Constant K, you can pick up your bonus.': 'На этом все. Кей стабилен, можете пройти за бонусом.',\r\n        'Thank you, sir.': 'Спасибо, сэр.',\r\n        '...If you read it, you find dropped terminal and got top level of desert. Welcome...': '...Если ты читаешь это, ты нашел упавший терминал и добрался до верхнего уровня пустоши.',\r\n        'Who are you?': 'Кто ты?',\r\n        'It does not matter. Later. May be..': 'Это неважно. Позже. Может быть..',\r\n        'Hey...': 'Эй...',\r\n\r\n        'open': 'пуск',\r\n\r\n        'Previous part: ': 'Предыдущая часть: ',\r\n        'Author: ': 'Автор: ',\r\n        'link': 'ссылка',\r\n    }\r\n}","import { emitter } from './util_emitter'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\n\r\nlet currentLanguage = 'en'\r\n\r\nemitter.subscribe('setLanguage')(keyLanguage => {\r\n    currentLanguage = keyLanguage\r\n})\r\n\r\n\r\nexport const t = val => (TRANSLATE_WORLDS[currentLanguage] && TRANSLATE_WORLDS[currentLanguage][val]) || val\r\n","import { UserReplicies } from './UserReplicies'\r\nimport { BotAnswers } from './BotAnswers'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { toggleDialog, clickFullScreen, clickInfo } from '../store/actions'\r\nimport { emitter } from '../helpers/util_emitter'\r\nimport { t } from '../helpers/util_translate'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    isButtonDialog: state.app.ui.isButtonDialog,\r\n    isDialog: state.app.ui.isDialog,\r\n    isShowClickFullScreen: state.app.ui.isShowButtFullScreen,\r\n    isShowInfo: state.app.ui.isShowInfo,\r\n    isShowFinalMessage: state.app.ui.isShowFinalMessage,\r\n})\r\n\r\n\r\n\r\n\r\nfunction App(props) {\r\n    !pr.dispatch && (pr.dispatch = props.dispatch)\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"ui\">\r\n            {props.isButtonDialog && (\r\n                <button\r\n                    className=\"butt-toggleDialog\"\r\n                    onClick={() => {toggleDialog(props.dispatch).toggleDialog(!props.isDialog)}}>\r\n                    {props.isDialog ? t('close dialog') : t('open dialog') }\r\n                </button>)}\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-left control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-left')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-left')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-left')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-left')}>\r\n                    &#9668;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-right control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-right')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-right')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-right')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-right')}>\r\n                    &#9658;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-front control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-front')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-front')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-front')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-front')}>\r\n                    &#9650;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && props.isShowClickFullScreen && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        emitter.emit('mouseDown')('butt-fullscreen')\r\n                        clickFullScreen(props.dispatch).clickFullScreen()\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && !props.isShowInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => clickInfo(props.dispatch).clickInfo(true)}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n\r\n\r\n            {props.isDialog && (\r\n                <div className=\"dialog\">\r\n                    <div className=\"dialog-inner\">\r\n                        <BotAnswers />\r\n                        <UserReplicies />\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n\r\n            {props.isShowFinalMessage && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner final-message\">\r\n                        {/*<button*/}\r\n                            {/*className=\"control butt-infoClose\"*/}\r\n                            {/*onClick={() => showMessages(props.dispatch).toggleFinalMessage(false)}>*/}\r\n                            {/*x*/}\r\n                        {/*</button>*/}\r\n                        <p>{t('To be continued')}</p>\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n\r\n            {props.isShowInfo && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner\">\r\n                        <button\r\n                            className=\"control butt-infoClose\"\r\n                            onClick={() => clickInfo(props.dispatch).clickInfo(false)}>\r\n                            x\r\n                        </button>\r\n                        <p>\r\n                            {`1 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/factory/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {`2 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/bridge/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p><br /><br />\r\n                            {t('Author: ')}\r\n                            <a href=\"http://otrisovano.ru\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {t('Github: ')}\r\n                            <a href=\"https://github.com/fire888/levels/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                    </div>\r\n                </div>)}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport const pr = { dispatch: null }\r\n\r\nexport default connect(mapStateToProps)(App);\r\n","\r\n\r\n\r\nexport function KeyBoard (emitter) {\r\n    const keys = {\r\n        'up': false,\r\n        'left': false,\r\n        'right': false,\r\n        's': false,\r\n        'm': false,\r\n        'w': false,\r\n    }\r\n\r\n\r\n    const keyUpdate = function ( keyCode, isDown ) {\r\n        switch( keyCode ) {\r\n          case 38:\r\n            keys['up'] = isDown\r\n            break\r\n          case 37:\r\n            keys['left'] = isDown\r\n            break\r\n          case 39:\r\n            keys['right'] = isDown\r\n            break\r\n          case 83:\r\n            keys['s'] = isDown\r\n            break\r\n          case 77:\r\n            keys['m'] = isDown\r\n            break\r\n          case 87:\r\n            keys['w'] = isDown\r\n            break\r\n        }\r\n        emitter.emit('keyEvent')(keys)\r\n    }\r\n\r\n\r\n\r\n    document.addEventListener('keydown', event => keyUpdate(event.keyCode, true))\r\n    document.addEventListener('keyup', event => keyUpdate(event.keyCode, false))\r\n\r\n\r\n\r\n    emitter.subscribe('mouseDown')(key => {\r\n        if (key === 'butt-left') keyUpdate(37, true)\r\n        if (key === 'butt-right') keyUpdate(39, true)\r\n        if (key === 'butt-front') keyUpdate(38, true)\r\n    })\r\n    emitter.subscribe('mouseUp')(key => {\r\n        if (key === 'butt-left') keyUpdate(37, false)\r\n        if (key === 'butt-right') keyUpdate(39, false)\r\n        if (key === 'butt-front') keyUpdate(38, false)\r\n    })\r\n}\r\n\r\n","export default __webpack_public_path__ + \"static/media/px.2be78f43.jpg\";","export default __webpack_public_path__ + \"static/media/nx.b2401269.jpg\";","export default __webpack_public_path__ + \"static/media/py.659ebc34.jpg\";","export default __webpack_public_path__ + \"static/media/ny.462f1251.jpg\";","export default __webpack_public_path__ + \"static/media/pz.8ea5ba14.jpg\";","export default __webpack_public_path__ + \"static/media/nz.7f255b96.jpg\";","export default __webpack_public_path__ + \"static/media/posx.be2d83a2.jpg\";","export default __webpack_public_path__ + \"static/media/negx.d016c8e7.jpg\";","export default __webpack_public_path__ + \"static/media/posy.01cfd221.jpg\";","export default __webpack_public_path__ + \"static/media/negy.f01f8356.jpg\";","export default __webpack_public_path__ + \"static/media/posz.ef37b8e1.jpg\";","export default __webpack_public_path__ + \"static/media/negz.f346a80a.jpg\";","export default __webpack_public_path__ + \"static/media/level-rooms.5251ade2.obj\";","export default __webpack_public_path__ + \"static/media/floor_outer_map.35e50f6e.jpg\";","export default __webpack_public_path__ + \"static/media/botMap.972e276e.png\";","import pxjpg from '../assets/skybox/px.jpg'\r\nimport nxjpg from '../assets/skybox/nx.jpg'\r\nimport pyjpg from '../assets/skybox/py.jpg'\r\nimport nyjpg from '../assets/skybox/ny.jpg'\r\nimport pzjpg from '../assets/skybox/pz.jpg'\r\nimport nzjpg from '../assets/skybox/nz.jpg'\r\n\r\nimport pxjpg2 from '../assets/matIronBox/posx.jpg'\r\nimport nxjpg2 from '../assets/matIronBox/negx.jpg'\r\nimport pyjpg2 from '../assets/matIronBox/posy.jpg'\r\nimport nyjpg2 from '../assets/matIronBox/negy.jpg'\r\nimport pzjpg2 from '../assets/matIronBox/posz.jpg'\r\nimport nzjpg2 from '../assets/matIronBox/negz.jpg'\r\n\r\nimport levelRoomsSrc from '../assets/level-rooms.obj'\r\nimport mapFloorOuter from '../assets/floor_outer_map.jpg'\r\n\r\nimport botMap from '../assets/botMap.png'\r\nimport botSrc from '../assets/botAnim2.glb'\r\n\r\n\r\n\r\nexport const ASSETS_TO_LOAD = [\r\n    {\r\n        type: 'obj',\r\n        filename: levelRoomsSrc,\r\n        key: 'level-rooms'\r\n    }, {\r\n        type: 'glb',\r\n        filename: botSrc,\r\n        key: 'bot'\r\n    }, {\r\n        type: 'cubeTextures',\r\n        filename: { px: pxjpg, nx: nxjpg, py: pyjpg, ny: nyjpg, pz: pzjpg, nz: nzjpg, },\r\n        key: 'skyBox'\r\n    }, {\r\n        type: 'cubeTextures',\r\n        filename: { px: pxjpg2, nx: nxjpg2, py: pyjpg2, ny: nyjpg2, pz: pzjpg2, nz: nzjpg2, },\r\n        key: 'ironEnv',\r\n    }, {\r\n        type: 'img',\r\n        filename: botMap,\r\n        key: 'botMap',\r\n    }, {\r\n        type: 'img',\r\n        filename: mapFloorOuter,\r\n        key: 'mapFloorOuter',\r\n        wrap: true,\r\n},]\r\n\r\n\r\n\r\n\r\nexport const MATERIALS_CONFIG = {\r\n\r\n    'iron': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x003388,\r\n            specular: 0xffffff,\r\n            shininess: 60,\r\n            bumpMap: 'botMap',\r\n            bumpScale: 0.1,\r\n            envMap: 'ironEnv',\r\n            reflectivity: 0.5,\r\n            map: 'botMap',\r\n            skinning: true,\r\n        },\r\n    },\r\n\r\n    'wall': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n            specular: 0x222222,\r\n        },\r\n    },\r\n\r\n\r\n    'green': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    },\r\n\r\n    'road': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xa1129f,\r\n            emissive: 0xa1129f,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    } \r\n}\r\n\r\n\r\n\r\n\r\n/** size element */\r\nexport const S = 175.335\r\nexport const H = 70\r\n\r\n\r\n\r\n/** emitter constants */\r\nexport const FRAME_UPDATE = 'FRAME_UPDATE'\r\n\r\n\r\n\r\n\r\nexport const FLOORS_CONF = {\r\n    '-2': {\r\n        'outer': { fogNear: -200, fogFar: 500, color: 0x18257d },\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x8805a8 },\r\n    },\r\n\r\n   \r\n\r\n    '-1': {\r\n        'start': { fogNear: 0, fogFar: 5, color: 0x18257d },\r\n        'outer': { fogNear: 20, fogFar: 500, color: 0x18257d },\r\n        'back': { fogNear: 20, fogFar: 500, color: 0x18257d, backgroundImgKey: 'skyBox' },\r\n        'firstRoomLight': { fogNear: -40, fogFar: 150, color: 0x00235e},\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x2e118b },\r\n    },\r\n\r\n\r\n    '0': { 'default': { fogNear: -40, fogFar: 150, color: 0x3c4900 }, },\r\n\r\n    \r\n    '1': { 'default': { fogNear: -40, fogFar: 150, color: 0x0e3e52 }, },\r\n\r\n\r\n    '2': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a1763 }, },\r\n\r\n\r\n    '3': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a6340 }, },\r\n\r\n\r\n    '4': { 'default': { fogNear: 0, fogFar: 80, color: 0xac0000 }, },\r\n}\r\n\r\n\r\n\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    clearColor: FLOORS_CONF[-1]['outer'].color,\r\n    backgroundColor: FLOORS_CONF[-1]['outer'].color,\r\n    amb: {\r\n        color: FLOORS_CONF[-1]['outer'].color,\r\n        strength: 0.7,\r\n    },\r\n}\r\n\r\n\r\nexport const playerConfig = {\r\n    //speed: 0.35,\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 10.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    startPos: [100, -60, 1000],\r\n    //startPos: [90, -10, 360.7140705920112], // beginPlay\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 1000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    lightDataOne: {\r\n        //color: 0xc2d4f3,\r\n        color: 0xffffff,\r\n        strength: 5000,\r\n        pos: [0, 50, 5],\r\n    },\r\n    // lightDataTwo: {\r\n    //     color: 0xff0000,\r\n    //     strength: 0.2,\r\n    //     pos: [0, -30, 40],\r\n    // },\r\n}\r\n","export default __webpack_public_path__ + \"static/media/botAnim2.47b6030d.glb\";","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\nlet callback = null\r\nlet dataToLoad = null\r\nconst assets = {}\r\nlet objLoader, textureLoader, gltfLoader, cubeTextureLoader\r\nlet index = 0\r\n\r\n\r\n\r\nconst loadAsset = function (data) {\r\n    if (data.type === 'obj') {\r\n        objLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }\r\n    if (data.type === 'glb' || data.type === 'gltf') {\r\n        gltfLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }        \r\n    if (data.type === 'img') {\r\n        textureLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }\r\n    if (data.type === 'cubeTextures') {\r\n        cubeTextureLoader.load(\r\n            [\r\n                data.filename['px'],\r\n                data.filename['nx'],\r\n                data.filename['py'],\r\n                data.filename['ny'],\r\n                data.filename['pz'],\r\n                data.filename['nz'],\r\n            ],\r\n            result => {\r\n                assets[data.key] = result\r\n                checkComplete()\r\n            }\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\nconst checkComplete = () => {\r\n    index ++\r\n    index < dataToLoad.length \r\n        ? loadAsset(dataToLoad[index])\r\n        : callback(assets)\r\n}\r\n\r\n\r\n\r\nexport const loadAssets = data => {\r\n    return new Promise(resolve => {\r\n        dataToLoad = data\r\n        callback = resolve\r\n        index = 0\r\n\r\n        objLoader = objLoader || new OBJLoader()\r\n        textureLoader = textureLoader || new THREE.TextureLoader()\r\n        gltfLoader = gltfLoader || new GLTFLoader()\r\n        cubeTextureLoader = cubeTextureLoader || new THREE.CubeTextureLoader()\r\n\r\n        loadAsset(dataToLoad[index])\r\n    })\r\n}\r\n\r\n","import { emitter } from '../helpers/util_emitter'\r\nimport { S, H } from '../constants/constants_elements'\r\nimport { pr } from '../componentsReact/App'\r\n\r\n\r\nexport const START_LAYER_STATE = 'outer'\r\n\r\n\r\n\r\n\r\n\r\nexport const CHANGE_LAYER_STATE = [\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'outer', newState: 'corridor',\r\n        oldQuadrant: [0, -2, 4], newQuadrant: [0, -2, 3],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n                backgroundImg: false\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'corridor', newState: 'outer',\r\n        oldQuadrant: [0, -2, 3], newQuadrant: [0, -2, 4],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'outer',\r\n            },\r\n        ]\r\n    },\r\n\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'corridor', newState: 'firstRoom',\r\n        oldQuadrant: [0, -1, 2], newQuadrant: [0, -1, 1],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'firstRoomLight',\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'corridor',\r\n        oldQuadrant: [0, -1, 1], newQuadrant: [0, -1, 2],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: [0, -1, 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_MINUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_PLUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_PLUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 0,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_MINUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 100,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            },\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_MINUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_PLUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_PLUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n\r\n    /** **********************************************************/\r\n\r\n    // {\r\n    //     oldState: 'addWell', newState: 'addWell',\r\n    //     oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_MINUS_ONE', 'ANY'],\r\n    //     emitData: [\r\n    //         {\r\n    //             emitKey: 'CHANGE_QUADRANT',\r\n    //             counter: val => ++val,\r\n    //         }\r\n    //     ],\r\n    // },\r\n]\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createActionByChangedQuadrant = () => {\r\n    const checkerNewQuadrant = createCheckerNewQuadrant()\r\n\r\n\r\n    emitter.subscribe('playerMove')(pos => {\r\n        const data = checkerNewQuadrant.update(pos)\r\n        const { currentQuadrant, oldQuadrant, isChanged } = data\r\n\r\n        if (!isChanged) return;\r\n\r\n        const arrEmitData = getEmitsByChangeQuadrant(oldQuadrant, currentQuadrant)\r\n\r\n        arrEmitData.length && arrEmitData.forEach(item => pr.dispatch({\r\n            ...item,\r\n            type: item.emitKey,\r\n        }))\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet levelState = START_LAYER_STATE\r\n\r\n\r\nexport const getEmitsByChangeQuadrant = (playerOldQ, playerNewQ) => {\r\n    for (let i = 0; i < CHANGE_LAYER_STATE.length; ++i) {\r\n        const data = getData(\r\n            [...playerOldQ],\r\n            [...playerNewQ],\r\n            {\r\n                ...CHANGE_LAYER_STATE[i],\r\n                oldQuadrant: [...CHANGE_LAYER_STATE[i].oldQuadrant],\r\n                newQuadrant: [...CHANGE_LAYER_STATE[i].newQuadrant],\r\n            }\r\n        )\r\n        if (data) return data;\r\n    }\r\n    return { levelState }\r\n}\r\n\r\n\r\n\r\n\r\nconst getData = (playerOldQ, playerNewQ, conf) => {\r\n    const { oldState, newState, oldQuadrant, newQuadrant, emitData } = conf\r\n\r\n    if (levelState !== oldState)\r\n        return;\r\n\r\n\r\n    if (oldQuadrant[0] === 'ANY') oldQuadrant[0] = playerOldQ[0]\r\n    if (oldQuadrant[1] === 'ANY') oldQuadrant[1] = playerOldQ[1]\r\n    if (oldQuadrant[2] === 'ANY') oldQuadrant[2] = playerOldQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY') newQuadrant[0] = playerNewQ[0]\r\n    if (newQuadrant[1] === 'ANY') newQuadrant[1] = playerNewQ[1]\r\n    if (newQuadrant[2] === 'ANY') newQuadrant[2] = playerNewQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY_PLUS_ONE') newQuadrant[0] = playerOldQ[0] + 1\r\n    if (newQuadrant[1] === 'ANY_PLUS_ONE') newQuadrant[1] = playerOldQ[1] + 1\r\n    if (newQuadrant[2] === 'ANY_PLUS_ONE') newQuadrant[2] = playerOldQ[2] + 1\r\n\r\n    if (newQuadrant[0] === 'ANY_MINUS_ONE') newQuadrant[0] = playerOldQ[0] - 1\r\n    if (newQuadrant[1] === 'ANY_MINUS_ONE') newQuadrant[1] = playerOldQ[1] - 1\r\n    if (newQuadrant[2] === 'ANY_MINUS_ONE') newQuadrant[2] = playerOldQ[2] - 1\r\n\r\n\r\n    if (\r\n        oldQuadrant[0] !== playerOldQ[0] ||\r\n        oldQuadrant[1] !== playerOldQ[1] ||\r\n        oldQuadrant[2] !== playerOldQ[2] ||\r\n        newQuadrant[0] !== playerNewQ[0] ||\r\n        newQuadrant[1] !== playerNewQ[1] ||\r\n        newQuadrant[2] !== playerNewQ[2]\r\n    ) return;\r\n\r\n\r\n    levelState = newState\r\n\r\n    return emitData.map(item => ({\r\n        ...item,\r\n        levelState,\r\n        oldQuadrant: [...oldQuadrant],\r\n        newQuadrant: [...newQuadrant],\r\n    }))\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst createCheckerNewQuadrant = function () {\r\n    let oldQuadrant = []\r\n\r\n    return {\r\n        update ({ x, y, z}) {\r\n            const currentQuadrant = [Math.floor(x / S), Math.floor(y / H), Math.floor(z / S)]\r\n\r\n            if (\r\n                currentQuadrant[0] !== oldQuadrant[0] ||\r\n                currentQuadrant[1] !== oldQuadrant[1] ||\r\n                currentQuadrant[2] !== oldQuadrant[2]\r\n            ) {\r\n                const data = {\r\n                    isChanged: true,\r\n                    currentQuadrant,\r\n                    oldQuadrant,\r\n                }\r\n                oldQuadrant = [...currentQuadrant]\r\n\r\n                return data\r\n            } else {\r\n                return { isChanged: false }\r\n            }\r\n        },\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import { MATERIALS_CONFIG } from '../constants/constants_elements'\r\nimport * as THREE from 'three'\r\n\r\n\r\n\r\nexport function prepareMeshesFromAssets (assets) {\r\n    const\r\n        materials = createMaterials(assets),\r\n        rooms = {},\r\n        allMeshes = {}\r\n\r\n    assets.collisionsBotsRooms = {}\r\n\r\n    assets['level-rooms'].traverse(child => {\r\n        if (child.name.includes(\"room_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            rooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"collision_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry)\r\n            assets.collisionsBotsRooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_walls\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_road\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.green)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_floor\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.road)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }  \r\n    })\r\n\r\n    return {\r\n        rooms,\r\n        allMeshes,\r\n        materials,\r\n    }\r\n}\r\n\r\n\r\n\r\nconst createMaterials = assets => {\r\n    for (let key in assets) \r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}\r\n","// import saturateVert from './saturate.vert'\r\n// import saturateFrag from './saturate.frag'\r\n\r\n\r\nexport const Saturate = {\r\n    uniforms: {\r\n        \"tDiffuse\": { value: null },\r\n    },\r\n\r\n    //vertexShader: saturateVert,\r\n    //fragmentShader: saturateFrag,\r\n\r\n\r\n\r\n    vertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n    vUv = uv;\r\n    gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n    fragmentShader: `\r\n\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n    vec4 texel = texture2D( tDiffuse, vUv );\r\n    gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet FLOORS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionFloors = (objFromLink, offset, delta, speed) => {\r\n    const objFrom = objFromLink\r\n    const offsetFromFloor = offset\r\n    const offsetFromFloorFactor = delta\r\n    const speedDown = speed\r\n\r\n    const vec3Src = new THREE.Vector3()\r\n    const vec3Ray = new THREE.Vector3(0, -1, 0)\r\n\r\n    let isDisable = true\r\n\r\n    return {\r\n        check: updateData => {\r\n            if (isDisable) return;\r\n\r\n            vec3Src.copy(objFrom.position)\r\n            const raycasterDown = new THREE.Raycaster(vec3Src, vec3Ray)\r\n            const intersectsFloor = raycasterDown.intersectObjects(FLOORS_ARRAY)\r\n            if (intersectsFloor && intersectsFloor[0] && intersectsFloor[0].distance > offsetFromFloor + offsetFromFloorFactor) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            }\r\n            if (intersectsFloor && !intersectsFloor[0]) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            } \r\n            objFrom.position.y = intersectsFloor[0].point.y + offsetFromFloor\r\n        },\r\n        start: () => {\r\n            isDisable = false\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport const setItemToFloorsCollision = item => FLOORS_ARRAY.push(item)\r\nexport const removeItemFromFloorsCollision = item => FLOORS_ARRAY = FLOORS_ARRAY.filter(mesh => mesh !== item) \r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet WALLS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFromLink, objToLink, offset) => {\r\n    const offsetWallCollision = offset\r\n    const objFrom = objFromLink\r\n    const objTo = objToLink\r\n\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            vec3Src2.copy(objFrom.position)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2)\r\n            const intersectsWalls = raycasterWalls.intersectObjects(WALLS_ARRAY)\r\n\r\n            return intersectsWalls[0] && intersectsWalls[0].distance < offsetWallCollision\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport const setItemToWallCollision = item => WALLS_ARRAY.push(item)\r\nexport const removeItemFromWallCollision = item => WALLS_ARRAY = WALLS_ARRAY.filter(mesh => item !== mesh)\r\n","\r\n\r\nlet arrItems = []\r\n\r\n\r\n\r\nexport const addItemToNearChecker = item => arrItems.push(item)\r\n\r\n\r\n\r\nexport const removeItemByName = name => arrItems = arrItems.filter(item => item.name !== name)\r\n\r\n\r\n\r\nexport const createCheckerNearItem = (mesh, emitter) => () => {\r\n    arrItems.forEach(item => {\r\n        if (mesh.position.distanceTo(item.position) < 10 && !item.userData.nearPlayer) {\r\n            item.userData.nearPlayer = true\r\n            emitter.emit('nearMesh')({ toNear: true, mesh: item })\r\n        }\r\n        if (mesh.position.distanceTo(item.position) >= 10 && item.userData.nearPlayer) {\r\n            item.userData.nearPlayer = false\r\n            emitter.emit('nearMesh')({ toNear: false, mesh: item })\r\n        }\r\n    })\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\nimport { playerConfig } from '../constants/constants_elements'\r\n\r\nimport { createComponentCollisionFloors } from '../components/component_collisionFloor'\r\nimport { createComponentCollisionWalls } from '../components/component_collisionWalls'\r\nimport { createCheckerNearItem } from '../components/component_checkNearItem'\r\n\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { showMessages, startPlay } from '../store/actions'\r\nimport { pr } from '../componentsReact/App'\r\n\r\n\r\n\r\nexport function createPlayer (emitterLink) {\r\n    const emitter = emitterLink\r\n\r\n    const {\r\n        startPos,\r\n        startRot,\r\n        cameraData,\r\n        frontObjPos,\r\n        lightDataOne,\r\n        speed,\r\n        offsetFromFloor,\r\n        offsetFromFloorFactor,\r\n        speedDown,\r\n        offsetWallCollision,\r\n        speedRot,\r\n    } = playerConfig\r\n\r\n\r\n    let camera\r\n    let keys = {}\r\n    let isButtonsDisabled = false\r\n    let isBlocked = true\r\n\r\n    const mainObj = new THREE.Object3D()\r\n    mainObj.position.fromArray(startPos)\r\n    mainObj.rotation.fromArray(startRot)\r\n\r\n    const frontObj = new THREE.Object3D()\r\n    frontObj.position.fromArray(frontObjPos)\r\n    mainObj.add(frontObj)\r\n  \r\n    {\r\n        const { fov, ratio, near, far, pos } = cameraData\r\n        camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n        camera.position.fromArray(pos)\r\n        mainObj.add(camera)\r\n    }\r\n\r\n    {\r\n        const { color, strenth, pos } = lightDataOne\r\n        const light = new THREE.PointLight(color, strenth)\r\n        light.position.fromArray(pos)\r\n        mainObj.add(light)\r\n    }\r\n\r\n\r\n    const checkFloors = createComponentCollisionFloors(mainObj, offsetFromFloor, offsetFromFloorFactor, speedDown)\r\n    const checkWalls = createComponentCollisionWalls(mainObj, frontObj, offsetWallCollision)\r\n    const checkNearItem = createCheckerNearItem(mainObj, emitter)\r\n\r\n    let oldY = mainObj.position.y\r\n    let countDropped = 0\r\n    let isGameComplete = false\r\n\r\n    const update = data => {\r\n        if (isButtonsDisabled) return;\r\n        if (isBlocked) return;\r\n\r\n        checkFloors.check(data)\r\n\r\n        if (!keys) return;\r\n\r\n        if (keys['up']) {\r\n            if (checkWalls.check()) return;\r\n\r\n            mainObj.translateZ(-speed * data.count)\r\n            //console.log(mainObj.position.x,  mainObj.position.y, mainObj.position.z)\r\n            checkNearItem()\r\n            emitter.emit('playerMove')(mainObj.position)\r\n        }\r\n        keys['left'] && (mainObj.rotation.y += (speedRot * data.count))\r\n        keys['right'] && (mainObj.rotation.y -= (speedRot * data.count))\r\n\r\n\r\n        if (oldY > mainObj.position.y) {\r\n            ++countDropped\r\n        } else {\r\n            countDropped = 0\r\n        }\r\n        oldY = mainObj.position.y\r\n\r\n        if (countDropped > 800 && !isGameComplete) {\r\n            isGameComplete = true\r\n            setTimeout(() => {\r\n                startPlay(pr.dispatch).startFinalFog()\r\n                setTimeout(() => {\r\n                    showMessages(pr.dispatch).toggleFinalMessage(true)\r\n                }, 6000)\r\n            }, 10000)\r\n        }\r\n    }\r\n\r\n\r\n    emitter.subscribe('keyEvent')(data => keys = data)\r\n    emitter.subscribe(FRAME_UPDATE)(update)\r\n    emitter.subscribe('toggleDialog')(val => isButtonsDisabled = val.isOpen)\r\n\r\n\r\n    return {\r\n        start: () => { \r\n            isBlocked = false\r\n            checkFloors.start()\r\n        },\r\n        getObj: () => mainObj,\r\n        getCamera: () => camera,\r\n        setToPos: (x, y, z) => mainObj.position.set(x, y, z)\r\n    }\r\n}\r\n\r\n","import '../stylesheets/style.css'\r\n\r\n\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n      if (!isAnimateLoader) return;\r\n\r\n      setTimeout(() => {\r\n            offsetLoader ++;\r\n            offsetLoader === 0 && (offsetLoader -= 100)\r\n            loader.style.marginLeft = offsetLoader + '%'\r\n            loaderTimeOut()\r\n      }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport const showStartButton = emitter => {\r\n    const startButtons = document.querySelector('.startbuttons-wrapper')\r\n    const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n    const hideStartScreen = e => {\r\n        emitter.emit('setLanguage')(e.target.dataset.lang)\r\n        document.querySelector('.start-screen').style.display = 'none'\r\n    }\r\n\r\n    isAnimateLoader = false\r\n    startButtons.style.display = 'flex'\r\n    startButtons.addEventListener('click', hideStartScreen)\r\n    progressWrapper.style.display = 'none'\r\n}\r\n\r\n","import {\r\n    setItemToFloorsCollision,\r\n    removeItemFromFloorsCollision, \r\n} from '../components/component_collisionFloor'\r\nimport {\r\n    setItemToWallCollision,\r\n    removeItemFromWallCollision,\r\n} from '../components/component_collisionWalls'\r\nimport * as THREE from 'three'\r\nimport { S, H } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst STANDART_ROOMS = ['room_02', 'room_03', 'room_04', 'room_05']\r\nconst START_ROOMS = ['outer_walls', 'outer_floor', 'outer_road']\r\n\r\n\r\n\r\n\r\n\r\nexport function createLevel (emitter, rooms, allMeshes, store) {\r\n    const group = new THREE.Group()\r\n    const objRooms = {}\r\n\r\n\r\n    //let isCanAddStairs = false\r\n    let state = 'normal' // 'addBot' || 'addStairs' || 'addWell'\r\n\r\n\r\n    const createRoom = (kv, key) => {\r\n        const instanceKey = key || STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n        \r\n        const objKey = `r_${kv[0]}_${kv[1]}_${kv[2]}` \r\n\r\n        const mesh = rooms[instanceKey].clone()\r\n        mesh.position.set(kv[0] * S, kv[1] * H, kv[2] * S)\r\n        setItemToFloorsCollision(mesh)\r\n        setItemToWallCollision(mesh)\r\n        group.add(mesh)\r\n        objRooms[objKey] = mesh\r\n\r\n\r\n        emitter.emit('levelChanged')({\r\n            typeLevelChange: 'createRoom',\r\n            instanceKey,\r\n            objKey,\r\n            kv,\r\n            isAddBot: instanceKey === 'room_01'\r\n        })    \r\n\r\n        instanceKey === 'room_06' && createRoom([kv[0], kv[1] + 1, kv[2]], 'room_dummy')\r\n    }\r\n\r\n\r\n    const removeRoom = kv => {\r\n        const objKey = `r_${ kv[0] }_${ kv[1] }_${ kv[2] }`\r\n        if (!objRooms[objKey]) return;\r\n\r\n    \r\n        const instanceKey = objRooms[objKey].name\r\n\r\n        // objRooms[objKey].children[0].geometry.dispose()\r\n        // objRooms[objKey].children[0].material.dispose()\r\n        group.remove(objRooms[objKey])\r\n        removeItemFromFloorsCollision(objRooms[objKey])\r\n        removeItemFromWallCollision(objRooms[objKey])\r\n        delete objRooms[objKey]\r\n\r\n\r\n        emitter.emit('levelChanged')({\r\n            typeLevelChange: 'destroyRoom',\r\n            instanceKey,\r\n            objKey,\r\n            kv,\r\n            isRemoveBot: instanceKey === 'room_01'\r\n        })    \r\n\r\n        instanceKey === 'room_dummy' && removeRoom([kv[0], kv[1] - 1, kv[2]])\r\n        instanceKey === 'room_06' && removeRoom([kv[0], kv[1] + 1, kv[2]])\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    createRoom([0, -1, 0], 'room_02')\r\n    createRoom([0, -1, -1], 'room_02')\r\n    createRoom([-1, -1, 0], 'room_02')\r\n    createRoom([1, -1, 0], 'room_02')\r\n\r\n\r\n\r\n    /** add remove start corridors */\r\n    const startL = {}\r\n    for (let i = 0; i < START_ROOMS.length; ++i) {\r\n        const l = allMeshes[START_ROOMS[i]].clone()\r\n        setItemToFloorsCollision(l)\r\n        setItemToWallCollision(l)\r\n        group.add(l)\r\n        l.position.set(0, -1 * H, 0)\r\n        startL[START_ROOMS[i]] = l\r\n    }\r\n\r\n\r\n\r\n\r\n    let wentLevels = 0\r\n    let flagIsSpecial = false\r\n\r\n    const initState = store.getState()\r\n    let saveOldQuadrant = initState.app.playerQuadrant.oldQuadrant\r\n    let saveNewQuadrant = initState.app.playerQuadrant.newQuadrant\r\n    let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n\r\n\r\n\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n\r\n        if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n            saveIsStartCorridorShow = false\r\n            for (let key in startL) {\r\n                removeItemFromFloorsCollision(startL[key])\r\n                removeItemFromWallCollision(startL[key])\r\n                group.remove(startL[key])\r\n            }\r\n        }\r\n\r\n\r\n        const { type, oldQuadrant, newQuadrant, counter } = newState.app.playerQuadrant\r\n\r\n\r\n        if ( type !== 'CHANGE_QUADRANT' ) return;\r\n\r\n\r\n        if (\r\n            saveOldQuadrant[0] !== oldQuadrant[0] ||\r\n            saveOldQuadrant[1] !== oldQuadrant[1] ||\r\n            saveOldQuadrant[2] !== oldQuadrant[2] ||\r\n            saveNewQuadrant[0] !== newQuadrant[0] ||\r\n            saveNewQuadrant[1] !== newQuadrant[1] ||\r\n            saveNewQuadrant[2] !== newQuadrant[2]\r\n        ) {\r\n            saveOldQuadrant = [...oldQuadrant]\r\n            saveNewQuadrant = [...newQuadrant]\r\n        } else {\r\n            return;\r\n        }\r\n\r\n\r\n        //let keyCreateRoom = false\r\n        let keyCreateRoom = STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n        if (counter) {\r\n            wentLevels = counter(wentLevels)\r\n\r\n            if (flagIsSpecial) {\r\n                flagIsSpecial = false\r\n            } else {\r\n                if (wentLevels < 3) {\r\n                    state = 'normal'\r\n                } else if (wentLevels < 100) {\r\n                    if (state === 'normal') {\r\n                        state = 'addBot'\r\n                    }\r\n                } else {\r\n                    state = 'addStairs'\r\n                }\r\n\r\n\r\n                if (state === 'addBot') {\r\n                    keyCreateRoom = 'room_01'\r\n                    flagIsSpecial = true\r\n                }\r\n                if (state === 'addStairs') {\r\n                    keyCreateRoom = 'room_06'\r\n                    flagIsSpecial = true\r\n                }\r\n                if (state === 'addWell') {\r\n                    keyCreateRoom = 'room_07'\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        emitter.subscribe('changeLevelMode')(newMode => state = newMode)\r\n\r\n\r\n        const oldKv = oldQuadrant, curKv = newQuadrant\r\n        // move west\r\n        if (curKv[0] < oldKv[0]) {\r\n            console.log('----------- west')\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n\r\n            // set center to east\r\n            objRooms[`r_${curKv[0] + 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n            // create west\r\n            createRoom([oldKv[0] - 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create soush\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n        }\r\n\r\n        // move east\r\n        if (curKv[0] > oldKv[0]) {\r\n            console.log('----------- east')\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n\r\n            // set center to east\r\n            objRooms[`r_${curKv[0] - 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n            // create east\r\n            createRoom([oldKv[0] + 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create south\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n        }\r\n\r\n\r\n        // move north\r\n        if (curKv[2] < oldKv[2]) {\r\n            console.log('-----------north')\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n\r\n            // set center to south\r\n            objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] + 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n            // create north\r\n            createRoom([oldKv[0], oldKv[1], oldKv[2] - 2], keyCreateRoom)\r\n\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create west\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create east\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n        }\r\n\r\n\r\n        // move south\r\n        if (curKv[2] > oldKv[2]) {\r\n            console.log('-----------south')\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n\r\n            // set center to north\r\n            objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] - 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n            // create south\r\n            createRoom([oldKv[0], oldKv[1], oldKv[2] + 2], keyCreateRoom)\r\n\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create west\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create east\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n        }\r\n\r\n        // move top\r\n        if (curKv[1] > oldKv[1] || curKv[1] < oldKv[1]) {\r\n            console.log('-----------top')\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1])\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create south\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1])\r\n            // remove left\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create left\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]])\r\n            // remove right\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create right\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]])\r\n        }\r\n\r\n    })\r\n\r\n    return { group }\r\n}\r\n\r\n\r\n\r\n// const geometry = mesh.geometry\r\n// const wireframe = new THREE.WireframeGeometry( geometry );\r\n// const line = new THREE.LineSegments( wireframe );\r\n// line.material.color = { r: 0.5, g: 0.5, b: 0.5}\r\n// line.material.linewidth = 50\r\n// line.material.opacity = 0.5;\r\n// line.material.transparent = true;\r\n// mesh.add( line );","import * as THREE from 'three'\r\nimport { GLTFCopy } from '../helpers/util_GLTFcopy'\r\n\r\n\r\nconst OFFSETS = {\r\n    'room_01': { x: 55, z: 75}\r\n}\r\n\r\nexport class Bot {\r\n    constructor () {\r\n        this.inScene = false\r\n\r\n        this._state = 'go' // || 'rotate' || 'say'\r\n\r\n        this._targetAngle = null\r\n\r\n\r\n        this.container = new THREE.Group()\r\n\r\n        this._modelGroup = new THREE.Group()\r\n        this._modelGroup.position.x = OFFSETS['room_01'].x\r\n        this._modelGroup.position.z = OFFSETS['room_01'].z\r\n        this._modelGroup.rotation.y = Math.random() * (2 * Math.PI)\r\n        this.container.add(this._modelGroup)\r\n\r\n        this._objFrom = new THREE.Object3D()\r\n        this._modelGroup.add(this._objFrom)\r\n\r\n\r\n        this._objTo = new THREE.Object3D()\r\n        this._objTo.position.set(0, 0, 1)\r\n        this._modelGroup.add(this._objTo)\r\n\r\n\r\n        const copy = GLTFCopy(Bot.botScene)\r\n        this.model = copy.scene.children[0]\r\n        this.model.children[1].material = Bot.botMaterial\r\n        this._animations = Bot.botScene.animations\r\n        this._mixer = new THREE.AnimationMixer(this.model.children[1])\r\n        this._walkAction = this._mixer.clipAction(this._animations[1])\r\n        this._walkAction.play()\r\n        this._walkAction.timeScale = .7\r\n\r\n        this._speakAction = this._mixer.clipAction(this._animations[0])\r\n        this._speakAction.timeScale = .4\r\n\r\n        this._modelGroup.add(this.model)\r\n    }\r\n\r\n\r\n    update (data) {\r\n        this._mixer.update(data.delta)\r\n\r\n        if (!this._componentCollision) return;\r\n\r\n        this._updateState()\r\n    }\r\n\r\n\r\n    setCollisionMesh (mesh) {\r\n        this._collisionMeshes = [mesh]\r\n        this.container.add(mesh)\r\n        mesh.material.visible = false\r\n\r\n\r\n        this._componentCollision = createComponentCollisionWalls(this._objFrom, this._objTo, 7, this._collisionMeshes)\r\n    }\r\n\r\n    removeCollisionMesh () {\r\n        this._collisionMeshes = null\r\n        this._componentCollision = null\r\n    }\r\n\r\n\r\n    prepareToSay (pos) {\r\n        this._state = 'say'\r\n        this._walkAction.stop()\r\n        this._speakAction.play()\r\n        this._modelGroup.lookAt(pos.x, this.container.position.y, pos.z)\r\n    }\r\n\r\n\r\n    /** internal *****************************/\r\n\r\n    _updateState () {\r\n        if (this._state === 'go') {\r\n            const isNear = this._componentCollision.check()\r\n            if (!isNear) {\r\n                this._modelGroup.translateZ(0.05)\r\n            } else {\r\n                this._startRotate()\r\n            }\r\n        }\r\n\r\n        if (this._state === 'rotate') {\r\n            this._modelGroup.rotation.y += ((this._targetAngle - this._modelGroup.rotation.y) < 0) ? -.01 : .01\r\n            this._modelGroup.rotation.y %= 2 * Math.PI\r\n            const isComplete = Math.abs(this._modelGroup.rotation.y - this._targetAngle) < .5\r\n            isComplete && this._startGo()\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _startGo () {\r\n        this._state = 'go'\r\n        this._walkAction.play()\r\n        this._speakAction.stop()\r\n    }\r\n\r\n\r\n    _startRotate() {\r\n        this._state = 'rotate'\r\n        this._targetAngle = (this._modelGroup.rotation.y + 1.5 + Math.random() * 4) % (2 * Math.PI)\r\n    }\r\n}\r\n\r\nBot.botScene = null\r\nBot.botMaterial = null\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFrom, objTo, offset, arrWalls) => {\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            objFrom.getWorldPosition(vec3Src2)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2, 0, 20)\r\n            const intersectsWalls = raycasterWalls.intersectObject(arrWalls[0], true)\r\n\r\n            return !!intersectsWalls[0]\r\n        }\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport const GLTFCopy = gltf => {\r\n    const clone = {\r\n          animations: gltf.animations,\r\n          scene: gltf.scene.clone(true)\r\n    };\r\n  \r\n    const skinnedMeshes = {};\r\n  \r\n    gltf.scene.traverse(node => {\r\n        if (node.isSkinnedMesh) {\r\n            skinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    const cloneBones = {};\r\n    const cloneSkinnedMeshes = {};\r\n  \r\n    clone.scene.traverse(node => {\r\n        if (node.isBone) {\r\n            cloneBones[node.name] = node;\r\n        }\r\n  \r\n        if (node.isSkinnedMesh) {\r\n            cloneSkinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    for (let name in skinnedMeshes) {\r\n        const skinnedMesh = skinnedMeshes[name];\r\n        const skeleton = skinnedMesh.skeleton;\r\n        const cloneSkinnedMesh = cloneSkinnedMeshes[name];\r\n  \r\n        const orderedCloneBones = [];\r\n  \r\n        for (let i = 0; i < skeleton.bones.length; ++i) {\r\n            const cloneBone = cloneBones[skeleton.bones[i].name];\r\n            orderedCloneBones.push(cloneBone);\r\n        }\r\n  \r\n        cloneSkinnedMesh.bind(\r\n            new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses),\r\n            cloneSkinnedMesh.matrixWorld);\r\n    }\r\n  \r\n    return clone;\r\n}","import * as THREE from 'three'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { Bot } from '../entities/Bot'\r\nimport { pr } from '../componentsReact/App'\r\nimport { toggleDialog } from '../store/actions'\r\n\r\n\r\nconst S = 175.335\r\nconst H = 70\r\nconst H_BOT = 14\r\n\r\n\r\n\r\n\r\nexport const createSystemBots = (assets, materials, emitter, store) => {\r\n    Bot.botMaterial = materials.iron\r\n    Bot.botScene = assets.bot\r\n\r\n\r\n\r\n    const groupBots = new THREE.Group()\r\n    const arrBots = []\r\n\r\n\r\n\r\n    for (let i = 0; i < 5; ++i) {\r\n        const bot = new Bot()\r\n        groupBots.add(bot.container)\r\n        bot.container.position.set(-30 + i * 30, -92, 750)\r\n        bot.inScene = 'aaa'\r\n        bot.setCollisionMesh(assets.collisionsBotsRooms['collision_r_01'].clone())\r\n        arrBots.push(bot)\r\n    }\r\n\r\n\r\n\r\n\r\n    emitter.subscribe(FRAME_UPDATE)(data => {\r\n        for (let i = 0; i < arrBots.length; ++i) arrBots[i].inScene && arrBots[i].update(data)\r\n    })\r\n\r\n\r\n\r\n\r\n    const initState = store.getState()\r\n    let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n        if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n            saveIsStartCorridorShow = newState.app.level.isStartCorridorShow\r\n\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                arrBots[i].inScene = null\r\n                arrBots[i].container.position.y = -10000\r\n                arrBots[i].removeCollisionMesh()\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    emitter.subscribe('levelChanged')(({ typeLevelChange, instanceKey, objKey, kv, isAddBot, isRemoveBot }) => {\r\n        if (isAddBot) {\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                if (!arrBots[i].inScene) {\r\n                    arrBots[i].inScene = objKey\r\n                    arrBots[i].container.position.set(kv[0] * S, kv[1] * H + H_BOT, kv[2] * S)\r\n                    arrBots[i].setCollisionMesh(assets.collisionsBotsRooms['collision_r_01'].clone())\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (isRemoveBot) {\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                if (arrBots[i].inScene === objKey) {\r\n                    arrBots[i].inScene = null\r\n                    arrBots[i].container.position.y = -10000\r\n                    arrBots[i].removeCollisionMesh()\r\n                }\r\n            } \r\n        }\r\n    })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    emitter.subscribe('playerMove')(pos => {\r\n        for (let i = 0; i < arrBots.length; ++i) {\r\n            if (!arrBots[i].inScene) continue;\r\n\r\n            const botWorldPos = new THREE.Vector3()\r\n            arrBots[i]._modelGroup.getWorldPosition(botWorldPos)\r\n            const distance = botWorldPos.distanceTo(pos)\r\n\r\n\r\n            if (arrBots[i]._state === 'say' && distance > 30) {\r\n                arrBots[i]._startRotate()\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(false)\r\n                continue;\r\n            }\r\n\r\n\r\n            if (arrBots[i]._state !== 'say' && distance < 30) {\r\n                arrBots[i].prepareToSay(pos)\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(true)\r\n                continue;\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n    return {\r\n        groupBots,\r\n    } \r\n}\r\n\r\n\r\n","import { createStore , applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\nimport { FLOORS_CONF } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\nconst DIALOGS_DATA = [\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Привет !',\r\n                a: 'День добрый, кремниевая форма жизни.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Что это за место?',\r\n                a: 'Это вход в энтропийный гипер-куб.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Что будет, если я войду в него?',\r\n                a: 'Куб примет тебя.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Куда ведут эти коридоры ?',\r\n                a: 'Они приведут тебя к финалу.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Я пошел дальше.',\r\n                a: 'Мы еще увидимся.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Что ты здесь делаешь ?',\r\n                a: 'Собираю энергию ночи.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'В какую сторону мне идти ?',\r\n                a: 'Здесь нет сторон. Здесь важна только длина пути.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Я уже долго иду.',\r\n                a: 'Ты прошел достаточно для этого уровня.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },{\r\n                q: 'Что это значит?',\r\n                a: 'Тебе открыт путь на одну ступень выше.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    // %%%%%%%%%%%%%%%%%%%%%%% 22222222222222222 %%%%%%%%%%%%%%%%%%%%\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Я ищу финал.',\r\n                a: 'Я помню о твоем пути.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Вы все так похожи.',\r\n                a: 'Мы еще встретимся.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Это снова ты?',\r\n                a: 'Да, мы все едины.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Тут все коридоры повторяются.',\r\n                a: 'Суть всего в едином.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как долго еще идти.',\r\n                a: 'Тебе будет знак, когда ты будешь готов.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Как я узнаю этот знак.',\r\n                a: 'Я подам его.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Это одинаковый сегмент коридора с тобой.',\r\n                a: 'Ты готов к новому уровню.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    // %%%%%%%%%%%%%%%%%%%%% 33333333 %%%%%%%%%%%%%%%%%%%%%%\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Привет снова. Как выбраться. Уже надоело.',\r\n                a: 'Ты не постиг дзен.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Ты-то как выходишь на поверхность?',\r\n                a: 'У меня свой путь.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ты все на своем пути?',\r\n                a: 'Как и ты.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Как долго ты на нем?',\r\n                a: 'Эти стены нас слышат.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Мне кажется, ты идешь в нагрузку к этому сегменту коридора.',\r\n                a: 'Тебе открыт следующий уровень.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    // %%%%%%%%%%%%%%%%%%%%% 444444444444444 %%%%%%%%%%%%%%\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ничего не меняется.',\r\n                a: 'Меняется количество пройденных шагов.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Это место считает шаги?',\r\n                a: 'Это место ждет.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как давно ты здесь?',\r\n                a: 'Время не имеет значения, значение имеет лишь путь.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Но ты же не идешь.',\r\n                a: 'Зато ты каждый раз проходишь мимо.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Сделай новый уровень.',\r\n                a: 'Ты готов - новый уровень ждет тебя.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    // %%%%%%%%%%%%%%%%%% 5555555 %%%%%%%%%%%%%%%%%%%\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ты и есть это место. Ты управляешь сегментами.',\r\n                a: 'Ты почти дошел до края.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Зачем тебе это?',\r\n                a: 'Это способ свернуть пространство. Больше движения. Больше сегментов.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как много путников попадало сюда?',\r\n                a: 'Многие из них до сих пор тут.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Почему я их не встретил?',\r\n                a: 'У каждого своя система сегментов.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ты выпустишь меня?',\r\n                a: 'Все стороны света открыты тебе.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Я хочу встретить других.',\r\n                a: 'Тебе открыт новый уровень.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n// %%%%%%%%%%%%%%%%%%% 6666666666666666 %%%%%%%%%%%%%%%%%%\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Я вижу зарево?',\r\n                a: 'Это зарево просветления. Ты близок',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Все коридоры повторяются.',\r\n                a: 'Все повторяется с небольшой разницей.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Все мой путь окончен.',\r\n                a: 'Ты отказываешься идти?',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Да, ты безумен.',\r\n                a: 'Я освобождаю тебя.',\r\n                event: 'close',\r\n                levelEvent: 'addWell',\r\n            },\r\n        ]\r\n    }\r\n]\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst appData = {\r\n    sceneEnvironment: {\r\n        color: FLOORS_CONF['-1']['start'].color,\r\n        fogNear: FLOORS_CONF['-1']['start'].fogNear,\r\n        fogFar: FLOORS_CONF['-1']['start'].fogFar,\r\n        backgroundImgKey: null,\r\n    },\r\n\r\n    playerQuadrant: {\r\n        oldDialogPlayerQuadrant: [0, 0, -50],\r\n        oldQuadrant: [0, 0, 0],\r\n        newQuadrant: [0, 0, 0],\r\n        counter: null,\r\n    },\r\n\r\n    level: {\r\n        isStartCorridorShow: true,\r\n    },\r\n\r\n    ui: {\r\n        isShowButtFullScreen: true,\r\n        isShowInfo: false,\r\n        isShowFinalMessage: false,\r\n        botAnswers: [],\r\n        userReplicies: [],\r\n        history: [],\r\n        isDialog: false,\r\n        isButtonDialog: false,\r\n    },\r\n\r\n    botIndex: -1,\r\n    phraseIndex: 0,\r\n    phrasesData: DIALOGS_DATA,\r\n}\r\n\r\n\r\n\r\nconst app = function(state = appData, action) {\r\n    if (action.type === 'CLICK_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'EXIT_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: true,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'INFO_TOGGLE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: false,\r\n                isShowInfo: action.mode,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'TOGGLE_FINAL_MESSAGE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: action.mode,\r\n                isShowInfo: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_ENVIRONMENT') {\r\n        const { newQuadrant, environmentMode } = action\r\n\r\n        if (!FLOORS_CONF[newQuadrant[1]]) return state;\r\n\r\n        const { fogNear, fogFar, color, backgroundImgKey } = FLOORS_CONF[newQuadrant[1]][environmentMode]\r\n\r\n        return ({\r\n            ...state,\r\n            sceneEnvironment: {\r\n                fogNear,\r\n                fogFar,\r\n                color,\r\n                backgroundImgKey,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_QUADRANT') {\r\n        return ({\r\n            ...state,\r\n            playerQuadrant: {\r\n                ...state.playerQuadrant,\r\n                ...action,\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'DESTROY_START_CORRIDOR') {\r\n        return ({\r\n            ...state,\r\n            level: {\r\n                ...state.level,\r\n                isStartCorridorShow: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'CLICK_PHRASE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                botAnswers: [\r\n                    ...state.ui.botAnswers,\r\n                    action.phrase,\r\n                ],\r\n                userReplicies: [],\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'PHRASE_EVENT') {\r\n        const { event } = action.phrase\r\n\r\n        if (event === 'nextReply') {\r\n            const userReplicies = [state.phrasesData[state.botIndex].phrases[state.phraseIndex + 1]]\r\n\r\n            return ({\r\n                ...state,\r\n                phraseIndex: state.phraseIndex + 1,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies,\r\n                }\r\n            })\r\n\r\n        }\r\n\r\n        if (event === 'close') {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies: [],\r\n                    isButtonDialog: true,\r\n                },\r\n                playerQuadrant: {\r\n                    ...state.playerQuadrant,\r\n                    oldDialogPlayerQuadrant: [...state.playerQuadrant.newQuadrant]\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'TOGGLE_DIALOG') {\r\n\r\n        let isNewBot = false\r\n        const { oldDialogPlayerQuadrant, newQuadrant } = state.playerQuadrant\r\n        if (\r\n            oldDialogPlayerQuadrant[0] !== newQuadrant[0] ||\r\n            oldDialogPlayerQuadrant[1] !== newQuadrant[1] ||\r\n            oldDialogPlayerQuadrant[2] !== newQuadrant[2]\r\n        ) isNewBot = true\r\n\r\n\r\n\r\n\r\n        if (!isNewBot) {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    isDialog: action.isDialog,\r\n                    isButtonDialog: true,\r\n                },\r\n\r\n            })\r\n        }\r\n\r\n\r\n\r\n        const phraseIndex = 0\r\n        const botIndex = state.botIndex + 1\r\n        const isButtonDialog = false\r\n        /////////////////////////////////////////////////////\r\n\r\n\r\n        ///////////////////////////////////////////// TODO: REMOVE\r\n        // let botIndex = state.botIndex\r\n        // let phraseIndex = state.phraseIndex\r\n        // if (action.isDialog) {\r\n        //     botIndex = state.botIndex + 1\r\n        //     phraseIndex = 0\r\n        // }\r\n        // const isButtonDialog = !action.isDialog\r\n        // /////////////////////////////////////////////////\r\n\r\n\r\n        const userReplicies = state.phrasesData[botIndex] ? [state.phrasesData[botIndex].phrases[phraseIndex]] : []\r\n\r\n        return ({\r\n            ...state,\r\n\r\n            ui: {\r\n                ...state.ui,\r\n                userReplicies,\r\n                botAnswers: [],\r\n                isDialog: action.isDialog,\r\n                isButtonDialog,\r\n            },\r\n\r\n            isCanChangeBotIndex: false,\r\n            botIndex,\r\n            phraseIndex,\r\n        })\r\n    }\r\n\r\n    if (action.type === 'TOGGLE_BUTTON') {\r\n\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isDialog: false,\r\n                isButtonDialog: action.isButtonDialog,\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n    return state\r\n}\r\n\r\n\r\n\r\nconst rootReducer = combineReducers({ app })\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n\r\n","import { createDeviceResizer } from './helpers/util_deviceResizer'\r\nimport { KeyBoard } from './helpers/util_keyBoard'\r\nimport { emitter } from './helpers/util_emitter'\r\nimport { createFrameUpdater } from './helpers/util_frameUpater'\r\nimport { createActionByChangedQuadrant } from './store/actionByChangeQuadrant'\r\nimport { startPlay } from './store/actions'\r\nimport { pr } from './componentsReact/App'\r\n\r\nimport { ASSETS_TO_LOAD } from './constants/constants_elements'\r\n\r\nimport { loadAssets } from './helpers/utils_loadAssets'\r\nimport { prepareMeshesFromAssets } from './helpers/helper_prepareMeshesFromAssets'\r\n\r\nimport { createStudio } from './entities/createStudio'\r\nimport { createPlayer } from './entities/createPlayer'\r\n\r\n\r\nimport { showStartButton } from './systems/systemHtml_intro'\r\nimport { createLevel } from './systems/system_level'\r\nimport { createSystemBots } from './systems/system_bots'\r\n\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { FRAME_UPDATE } from './constants/constants_elements'\r\n\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './componentsReact/App';\r\nimport { Provider } from 'react-redux'\r\nimport { store } from './store/createStore'\r\n\r\n\r\n  \r\n\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider>,\r\n    document.getElementById('root')\r\n)\r\n\r\n\r\n\r\n\r\n\r\ncreateDeviceResizer(emitter)\r\n\r\n\r\nconst init = assets => {\r\n    createFrameUpdater(emitter)\r\n    emitter.subscribe(FRAME_UPDATE)(() => TWEEN.update())\r\n\r\n    const studio = createStudio(emitter, assets, store)\r\n\r\n    /** player */\r\n    new KeyBoard(emitter)\r\n    const player = createPlayer(emitter)\r\n    studio.setCamera(player.getCamera())\r\n    studio.addToScene(player.getObj())\r\n\r\n    /** prepare assets */\r\n    const { allMeshes,  rooms, materials } = prepareMeshesFromAssets(assets)\r\n\r\n    /** level */\r\n    const { group } = createLevel(emitter, rooms, allMeshes, store)\r\n    studio.addToScene(group)\r\n\r\n    /** bots */\r\n    const systemBots = createSystemBots(assets, materials, emitter, store)\r\n    studio.addToScene(systemBots.groupBots)\r\n\r\n\r\n    createActionByChangedQuadrant()\r\n    \r\n    setTimeout(() => player.start(), 500)\r\n\r\n\r\n    /** UI */\r\n    showStartButton(emitter)\r\n    emitter.subscribe('setLanguage')(() => {\r\n        setTimeout(startPlay(pr.dispatch).startPlay, 1000)\r\n        setTimeout(startPlay(pr.dispatch).showBackground, 3000)\r\n    })\r\n}\r\n\r\n\r\n\r\nwindow.addEventListener('load', () => loadAssets(ASSETS_TO_LOAD).then(init))\r\n","import { pr } from '../componentsReact/App'\r\nimport { clickFullScreen } from '../store/actions'\r\n\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport function createDeviceResizer (emitter) {\r\n\r\n    const appWrapper = document.querySelector('.app-wrapper')\r\n    emitter.subscribe('mouseDown')(key => {\r\n        if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n    })\r\n\r\n    /** fullscreen */\r\n    const openAppFullScreenIfMobile = () => {\r\n\r\n\r\n        if (appWrapper.requestFullscreen) {\r\n            appWrapper.requestFullscreen()\r\n        } else if (appWrapper.mozRequestFullScreen) {\r\n            appWrapper.mozRequestFullScreen()\r\n        } else if (appWrapper.webkitRequestFullscreen) {\r\n            appWrapper.webkitRequestFullscreen()\r\n        } else if (appWrapper.msRequestFullscreen) {\r\n            appWrapper.msRequestFullscreen()\r\n        }\r\n    }\r\n\r\n    /** resize */\r\n    const resize = e => {\r\n        appWrapper.style.width = window.innerWidth + 'px'\r\n        appWrapper.style.height = window.innerHeight + 'px'\r\n        appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n        if (!document.fullscreenElement) {\r\n            clickFullScreen(pr.dispatch).exitFullScreen()\r\n        }\r\n\r\n    }\r\n\r\n\r\n    window.addEventListener('resize', resize)\r\n    resize()\r\n}\r\n\r\n\r\n\r\n// const checkTouch = () =>\r\n//     navigator.maxTouchPoints || 'ontouchstart' in document.documentElement\r\n//\r\n//\r\n//\r\n// const checkIsCanOrientation = () =>\r\n//     typeof window.orientation !== 'undefined'\r\n\r\n","import * as R from 'ramda'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\n\r\n\r\n\r\nexport function createFrameUpdater (eventEmitter) {\r\n\r\n    const emitFrameUpdate = eventEmitter.emit(FRAME_UPDATE)\r\n\r\n    let data = {\r\n        time: 0,\r\n        delta: 0,\r\n        count: 0,\r\n        oldTime: 0\r\n    }\r\n\r\n    const getDataFromGlobalVar = () => data\r\n\r\n    const updateTime = data => { \r\n        data.time = Date.now()\r\n        return data\r\n    }\r\n\r\n    const updateDelta = data => { \r\n        data.delta = (data.time - data.oldTime) * 0.001\r\n        if (isNaN(data.delta) || data.delta > 1000 || data.delta === 0 ) {\r\n            data.delta = 1000/60 * 0.001;\r\n        }\r\n        return data\r\n    }\r\n\r\n    const updateCount = data => { \r\n        data.count = data.delta / (1/60)\r\n        return data\r\n    }\r\n\r\n    const emit = data => { \r\n        emitFrameUpdate(data)\r\n        return data\r\n    }\r\n\r\n    const updateOldTime = data => { \r\n        data.oldTime = data.time\r\n        return data\r\n    }\r\n\r\n    const saveDataInGlobalVar = dataFromChine => {\r\n        data = dataFromChine\r\n        return data\r\n    }\r\n\r\n    // const logger = data => {\r\n    //     console.log(data)\r\n    //     return data\r\n    // }\r\n\r\n    const update = R.pipe(\r\n        getDataFromGlobalVar,\r\n        updateTime,\r\n        updateDelta,\r\n        updateCount, \r\n        emit, \r\n        updateOldTime, \r\n        saveDataInGlobalVar\r\n    )\r\n\r\n    const animate = () => {\r\n        requestAnimationFrame(animate)\r\n        update(data)\r\n    }\r\n\r\n    animate() \r\n}\r\n\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { studioConfig } from '../constants/constants_elements'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\n\r\n\r\n\r\n\r\n\r\nexport function createStudio (emitter, assets, store) {\r\n    const { canId, rendererCon, clearColor, amb } = studioConfig\r\n\r\n    const canvas = document.getElementById(canId)\r\n    rendererCon.canvas = canvas\r\n\r\n    const renderer = new THREE.WebGLRenderer(rendererCon)\r\n    renderer.setClearColor(clearColor)\r\n    renderer.setPixelRatio(window.devicePixelRatio)\r\n    renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n    const scene = new THREE.Scene()\r\n\r\n    {\r\n        const { color, fogNear, fogFar, backgroundImgKey } = store.getState().app.sceneEnvironment\r\n        scene.background = assets[backgroundImgKey] || null\r\n        scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n    }\r\n\r\n\r\n    let lightA\r\n    {\r\n        const { color, strength } = amb\r\n        lightA = new THREE.AmbientLight( color, strength )\r\n        scene.add( lightA )\r\n    }\r\n\r\n    let camera = null\r\n\r\n\r\n    const composer = new EffectComposer(renderer)\r\n    //composer.addPass(new RenderPass(scene, camera))\r\n\r\n\r\n\r\n    const resize = () => {\r\n        const size = { width: window.innerWidth, height: window.innerHeight }\r\n        renderer.setSize(size.width, size.height)\r\n        composer.setSize(size.width, size.height)\r\n        if (camera) {\r\n            camera.aspect = size.width/size.height\r\n            camera.updateProjectionMatrix()\r\n        }\r\n    }\r\n    window.addEventListener('resize', resize)\r\n    resize()\r\n\r\n\r\n\r\n\r\n    const addToScene = scene.add.bind(scene)\r\n    //const drawFrame = () => camera && renderer.render(scene, camera)\r\n    const drawFrame = () => camera && composer.render(scene, camera)\r\n    emitter.subscribe(FRAME_UPDATE)(drawFrame)\r\n\r\n\r\n\r\n    \r\n\r\n    let\r\n        oldFogNear = scene.fog.near,\r\n        oldFogFar = scene.fog.far,\r\n        oldColor = scene.fog.color,\r\n        oldBackgroundImgKey = store.getState().app.sceneEnvironment.backgroundImgKey\r\n\r\n\r\n\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n        const { fogNear, fogFar, color, backgroundImgKey } = newState.app.sceneEnvironment\r\n\r\n        if (fogNear !== oldFogNear || fogFar !== oldFogFar || color !== oldColor ) {\r\n            let startData = {\r\n                color: scene.fog.color,\r\n                near: scene.fog.near,\r\n                far: scene.fog.far,\r\n            }\r\n            let endData = {\r\n                color: new THREE.Color(color),\r\n                near: fogNear,\r\n                far: fogFar,\r\n            }\r\n\r\n            oldFogNear = fogNear\r\n            oldFogFar = fogFar\r\n            oldColor = color\r\n\r\n            new TWEEN.Tween(startData)\r\n                .to(endData, 3000)\r\n                .onUpdate(() => {\r\n                    scene.fog.color = startData.color\r\n                    scene.fog.near = startData.near\r\n                    scene.fog.far = startData.far\r\n                    lightA.color = startData.color\r\n                    renderer.setClearColor(startData.color)\r\n                })\r\n                .start()\r\n        }\r\n\r\n\r\n        if (backgroundImgKey !== oldBackgroundImgKey) {\r\n            oldBackgroundImgKey = backgroundImgKey\r\n            scene.background = assets[backgroundImgKey] || null\r\n        }\r\n    })\r\n\r\n\r\n\r\n    return {\r\n        setCamera: cam => {\r\n\r\n            camera = cam\r\n            composer.addPass(new RenderPass(scene, cam))\r\n            composer.addPass(new ShaderPass(Saturate))\r\n\r\n        },\r\n        addToScene,\r\n    }\r\n}\r\n\r\n"],"sourceRoot":""}