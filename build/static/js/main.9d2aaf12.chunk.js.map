{"version":3,"sources":["helpers/util_emitter.js","store/actions.js","componentsReact/UserReplicies.js","componentsReact/BotAnswers.js","constants/constants_replicies.js","helpers/util_translate.js","componentsReact/App.js","helpers/util_keyBoard.js","assets/skybox/px.jpg","assets/skybox/nx.jpg","assets/skybox/py.jpg","assets/skybox/ny.jpg","assets/skybox/pz.jpg","assets/skybox/nz.jpg","assets/matIronBox/posx.jpg","assets/matIronBox/negx.jpg","assets/matIronBox/posy.jpg","assets/matIronBox/negy.jpg","assets/matIronBox/posz.jpg","assets/matIronBox/negz.jpg","assets/map-walls-bump.png","assets/level-rooms.obj","assets/floor_outer_map.jpg","assets/botMap.png","constants/constants_elements.js","assets/botAnim.glb","helpers/utils_loadAssets.js","store/actionByChangeQuadrant.js","helpers/helper_prepareMeshesFromAssets.js","shaders/saturate.js","components/component_collisionFloor.js","components/component_collisionWalls.js","components/component_checkNearItem.js","entities/createPlayer.js","systems/systemHtml_intro.js","systems/system_level.js","entities/Bot.js","helpers/util_GLTFcopy.js","systems/system_bots.js","store/createStore.js","index.js","helpers/util_deviceResizer.js","helpers/util_frameUpater.js","entities/createStudio.js","systems/systemHtml_info.js"],"names":["eventEmitter","getOrCreateArrFromObj","obj","key","emitter","storage","emit","id","data","forEach","action","subscribe","callback","push","filter","item","showAll","s","length","console","log","createEmitter","startPlay","dispatch","type","newQuadrant","environmentMode","showBackground","showMessages","toggleFinalMessage","val","mode","clickFullScreen","exitFullScreen","clickInfo","toggleDialog","changeBot","phrase","clickPhrase","r","setTimeout","levelEvent","is","isDialog","toggleButtonDialog","isButtonDialog","UserReplicies","connect","state","userReplicies","app","ui","props","className","map","onClick","q","Math","floor","random","BotAnswers","botAnswers","a","TRANSLATE_WORLDS","currentLanguage","keyLanguage","t","pr","isShowClickFullScreen","isShowButtFullScreen","isShowInfo","isShowFinalMessage","onMouseDown","onTouchStart","onMouseUp","onTouchEnd","href","target","KeyBoard","keys","keyUpdate","keyCode","isDown","document","addEventListener","event","bind","this","ASSETS_TO_LOAD","filename","levelRoomsSrc","px","pxjpg","nx","nxjpg","py","pyjpg","ny","nyjpg","pz","pzjpg","nz","nzjpg","pxjpg2","nxjpg2","pyjpg2","nyjpg2","pzjpg2","nzjpg2","botMap","mapBump","mapFloorOuter","wrap","MATERIALS_CONFIG","mat","color","emissive","specular","shininess","bumpMap","bumpScale","envMap","reflectivity","skinning","S","FRAME_UPDATE","FLOORS_CONF","fogNear","fogFar","backgroundImgKey","studioConfig","canId","rendererCon","antialias","clearColor","backgroundColor","amb","strength","playerConfig","speed","speedRot","speedDown","offsetFromFloor","offsetFromFloorFactor","offsetWallCollision","level","startRot","startPos","cameraData","fov","ratio","window","innerWidth","innerHeight","near","far","pos","frontObjPos","lightDataOne","objLoader","textureLoader","gltfLoader","cubeTextureLoader","CHANGE_LAYER_STATE","oldState","newState","oldQuadrant","emitData","emitKey","backgroundImg","counter","levelState","getEmitsByChangeQuadrant","playerOldQ","playerNewQ","i","getData","conf","createCheckerNewQuadrant","update","x","y","z","currentQuadrant","isChanged","dataToLoad","assets","index","loadAsset","load","model","checkComplete","result","createMaterials","wrapS","wrapT","THREE","mapsKeys","materials","keyMap","Saturate","uniforms","value","vertexShader","fragmentShader","FLOORS_ARRAY","setItemToFloorsCollision","removeItemFromFloorsCollision","mesh","WALLS_ARRAY","setItemToWallCollision","removeItemFromWallCollision","arrItems","createPlayer","emitterLink","camera","isButtonsDisabled","isBlocked","mainObj","position","fromArray","rotation","frontObj","add","strenth","light","checkFloors","objFromLink","offset","delta","objFrom","vec3Src","vec3Ray","isDisable","check","updateData","copy","intersectsFloor","intersectObjects","distance","count","point","start","createComponentCollisionFloors","checkWalls","objToLink","objTo","vec3Src2","vec3Ray2","getWorldPosition","sub","intersectsWalls","createComponentCollisionWalls","checkNearItem","distanceTo","userData","nearPlayer","toNear","createCheckerNearItem","oldY","countDropped","isGameComplete","translateZ","isOpen","getObj","getCamera","setToPos","set","loader","querySelector","offsetLoader","isAnimateLoader","loaderTimeOut","style","marginLeft","STANDART_ROOMS","START_ROOMS","OFFSETS","Bot","inScene","_state","_targetAngle","container","_modelGroup","PI","_objFrom","_objTo","gltf","clone","animations","scene","skinnedMeshes","traverse","node","isSkinnedMesh","name","cloneBones","cloneSkinnedMeshes","isBone","skeleton","cloneSkinnedMesh","orderedCloneBones","bones","cloneBone","boneInverses","matrixWorld","GLTFCopy","botScene","children","material","botMaterial","_animations","_mixer","_walkAction","clipAction","play","_componentCollision","_updateState","_collisionMeshes","visible","lookAt","_startRotate","abs","_startGo","arrWalls","intersectObject","appData","sceneEnvironment","playerQuadrant","isStartCorridorShow","history","botIndex","phraseIndex","phrasesData","phrases","isCanChangeBotIndex","isCanChangeBotCounter","rootReducer","combineReducers","botPhrases","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","thunk","ReactDOM","render","getElementById","appWrapper","openAppFullScreenIfMobile","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","resize","e","width","height","fontSize","max","min","fullscreenElement","createDeviceResizer","init","emitFrameUpdate","time","oldTime","R","Date","now","isNaN","dataFromChine","animate","requestAnimationFrame","createFrameUpdater","TWEEN","studio","canvas","renderer","setClearColor","setPixelRatio","devicePixelRatio","setSize","lightA","getState","background","fog","composer","EffectComposer","size","aspect","updateProjectionMatrix","addToScene","oldFogNear","oldFogFar","oldColor","oldBackgroundImgKey","startData","endData","to","onUpdate","setCamera","cam","addPass","RenderPass","ShaderPass","createStudio","player","rooms","allMeshes","collisionsBotsRooms","child","includes","geometry","wall","green","road","prepareMeshesFromAssets","group","objRooms","createRoom","kv","instanceKey","objKey","typeLevelChange","isAddBot","removeRoom","remove","isRemoveBot","startL","l","wentLevels","flagIsSpecial","initState","saveOldQuadrant","saveNewQuadrant","saveIsStartCorridorShow","keyCreateRoom","newMode","oldKv","curKv","createLevel","systemBots","iron","bot","groupBots","arrBots","setCollisionMesh","removeCollisionMesh","botWorldPos","prepareToSay","createSystemBots","checkerNewQuadrant","arrEmitData","createActionByChangedQuadrant","cont","createElement","display","classList","wrapper","appendChild","mess","innerHTML","closeButt","innerText","createInfo","startButtons","progressWrapper","dataset","lang","showStartButton","Promise","resolve","OBJLoader","GLTFLoader","then"],"mappings":"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","file":"static/js/main.9d2aaf12.chunk.js","sourcesContent":["let eventEmitter = null\r\n\r\nconst createEmitter = () => {\r\n    const storage = {}\r\n    return {\r\n        emit: id => data => getOrCreateArrFromObj(storage)(id).forEach(action => action(data)),\r\n        subscribe: id => callback => {\r\n            getOrCreateArrFromObj(storage)(id).push(callback)\r\n            return () => storage[id] = storage[id].filter(item => item !== callback)\r\n        },\r\n        showAll () {\r\n            const s = {}\r\n            for (let key in storage) {\r\n                s[key] = storage[key].length\r\n            }\r\n            console.log(s)\r\n        },\r\n    }\r\n}\r\n\r\nconst getOrCreateArrFromObj = obj => key => obj[key] = obj[key] || []\r\n\r\nexport const emitter = eventEmitter = eventEmitter || createEmitter()\r\n\r\n\r\n\r\n\r\n\r\n","import { emitter } from '../helpers/util_emitter'\r\n\r\n\r\nexport const startPlay = dispatch => ({\r\n    startPlay: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'outer',\r\n    }),\r\n    showBackground: () => dispatch({\r\n        type: 'CHANGE_ENVIRONMENT',\r\n        newQuadrant: [0, -1, -50],\r\n        environmentMode: 'back',\r\n    })\r\n})\r\n\r\n\r\nexport const showMessages = dispatch => ({\r\n    toggleFinalMessage: val => dispatch({\r\n        type: 'TOGGLE_FINAL_MESSAGE',\r\n        mode: val,\r\n    })\r\n})\r\n\r\n\r\nexport const clickFullScreen = dispatch => ({\r\n    clickFullScreen: () => {\r\n        dispatch({\r\n            type: 'CLICK_FULL_SCREEN',\r\n        })\r\n    },\r\n\r\n    exitFullScreen: () => {\r\n        dispatch({\r\n            type: 'EXIT_FULL_SCREEN',\r\n        })\r\n    },\r\n})\r\n\r\n\r\nexport const clickInfo = dispatch => {\r\n    return ({\r\n        clickInfo: val => {\r\n            dispatch({\r\n                type: 'INFO_TOGGLE',\r\n                mode: val,\r\n            })\r\n        },\r\n    })\r\n}\r\n\r\n\r\n\r\nexport const toggleDialog = dispatch => ({\r\n    changeBot: data => {\r\n        dispatch({\r\n            type: 'CHANGE_BOT',\r\n            phrase: data,\r\n        })\r\n    },\r\n\r\n    clickPhrase: r => {\r\n        dispatch({\r\n            type: 'CLICK_PHRASE',\r\n            phrase: r,\r\n        })\r\n\r\n        setTimeout(() => {\r\n            dispatch({\r\n                type: 'PHRASE_EVENT',\r\n                phrase: r,\r\n            })\r\n\r\n            r.levelEvent && emitter.emit('changeLevelMode')(r.levelEvent)\r\n        }, 1000)\r\n    },\r\n\r\n\r\n    toggleDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_DIALOG',\r\n            isDialog: is,\r\n        })\r\n    },\r\n\r\n\r\n    toggleButtonDialog: is => {\r\n        dispatch({\r\n            type: 'TOGGLE_BUTTON',\r\n            isButtonDialog: is,\r\n        })\r\n    }\r\n})\r\n","import { connect } from 'react-redux'\r\nimport { toggleDialog } from '../store/actions'\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    userReplicies: state.app.ui.userReplicies,\r\n})\r\n\r\n\r\n\r\n\r\nexport const UserReplicies = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"userReplicies\">\r\n            {props.userReplicies.map(item => (<button\r\n                    key={Math.floor(Math.random()* 100000)}\r\n                    onClick={() => {\r\n                        toggleDialog(props.dispatch).clickPhrase(item)\r\n                    }}>\r\n                    {item.q}\r\n                </button>)\r\n            )}\r\n        </div>\r\n    )\r\n})","import { connect } from 'react-redux'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    botAnswers: state.app.ui.botAnswers,\r\n})\r\n\r\n\r\n\r\n\r\nexport const BotAnswers = connect(mapStateToProps)(function (props) {\r\n    return (\r\n        <div className=\"botAnswers\">\r\n            {props.botAnswers.map(item => (<div key={Math.floor(Math.random() * 100000)}>\r\n                    <div className=\"q\">{item.q}</div>\r\n                    <div className=\"a\">{item.a}</div>\r\n                </div>)\r\n            )}\r\n        </div>\r\n    )\r\n})","export const TRANSLATE_WORLDS = {\r\n    'ru': {\r\n        'open dialog': 'начать диалог',\r\n        'close dialog': 'закончить диалог',\r\n        'The end.': 'Это конец.',\r\n        'chapter': 'глава',\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        'After a long wandering in the desert...': 'После долгого блуждания по пустоши...',\r\n        'Stranger, I threw you a terminal with a pass phrase. Remember:': 'Незнакомец, я сбросил тебе терминал с парольной фразой. Запомни:',\r\n        'And blood-black nothingness began to spin...': 'Кроваво-черное ничто пустилось вить систему клеток,',\r\n        'A system of cells interlinked within cells interlinked within cells interlinked within one stem...' : 'связанных внутри, клеток, связанных внутри, клеток в едином стебле и явственно,',\r\n        'And dreadfully distinct against the dark, a tall white fountain played.': 'до жути на фоне тьмы ввысь белым бил фонтан.',\r\n        'Officer K-D-six-dash-three-dot-seven, let\\'s begin. Ready?': 'Офицер Кей Ди 6.3.7. приступим. Готовы?',\r\n        'Yes, sir.': 'Готов',\r\n        'No.': 'Не готов',\r\n        'Recite your baseline.': 'Ваша контрольная фраза.',\r\n        'I do not remember.': 'Я забыл.',\r\n        'I\\'ll come back later.': 'Я зайду попозже.',\r\n        'Cells.': 'Клетки.',\r\n        'Have you ever been in an institution? Cells.': 'Доводилось ли вам бывать в тюрьме? Клетки.',\r\n        'Do they keep you in a cell? Cells.': 'Вас держат в клетке? Клетки.',\r\n        'When you\\'re not performing your duties do they keep you in a little box? Cells.': 'Когда вы не исполняете обязанности, вас держат в коробке? Клетки.',\r\n        'Interlinked.': 'Связаны.',\r\n        'What\\'s it like to hold the hand of someone you love? Interlinked.': 'Что вы чувствуете держа за руку того кого любите? Связаны.',\r\n        'Did they teach you how to feel finger to finger? Interlinked.': 'Вас учили приставлять палец к пальцу? Связаны.',\r\n        'Do you long for having your heart interlinked? Interlinked.': 'Вы жаждете связать с кем-нибудь сердце? Связаны.',\r\n        'Do you dream about being interlinked? Interlinked.': 'Вам снится связь с кем-либо? Связаны.',\r\n        'What\\'s it like to hold your child in your arms? Interlinked.': 'Что вы чувствуете, держа в руках своего ребенка? Связаны.',\r\n        'Do you feel that there\\'s a part of you that\\'s missing? Interlinked.': 'Вы чувствуете, что вам чего-то не хватает? Связаны.',\r\n        'Within cells interlinked.': 'Клеток связанных внутри.',\r\n        'Why don\\'t you say that three times: Within cells interlinked.': 'Повторите три раза \"клеток связанных внутри',\r\n        'We\\'re done... Constant K, you can pick up your bonus.': 'На этом все. Кей стабилен, можете пройти за бонусом.',\r\n        'Thank you, sir.': 'Спасибо, сэр.',\r\n        '...If you read it, you find dropped terminal and got top level of desert. Welcome...': '...Если ты читаешь это, ты нашел упавший терминал и добрался до верхнего уровня пустоши.',\r\n        'Who are you?': 'Кто ты?',\r\n        'It does not matter. Later. May be..': 'Это неважно. Позже. Может быть..',\r\n        'Hey...': 'Эй...',\r\n\r\n        'open': 'пуск',\r\n\r\n        'Previous part: ': 'Предыдущая часть: ',\r\n        'Author: ': 'Автор: ',\r\n        'link': 'ссылка',\r\n    }\r\n}","import { emitter } from './util_emitter'\r\nimport { TRANSLATE_WORLDS } from '../constants/constants_replicies'\r\n\r\nlet currentLanguage = 'en'\r\n\r\nemitter.subscribe('setLanguage')(keyLanguage => {\r\n    currentLanguage = keyLanguage\r\n})\r\n\r\n\r\nexport const t = val => (TRANSLATE_WORLDS[currentLanguage] && TRANSLATE_WORLDS[currentLanguage][val]) || val\r\n","import { UserReplicies } from './UserReplicies'\r\nimport { BotAnswers } from './BotAnswers'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { toggleDialog, clickFullScreen, clickInfo, showMessages } from '../store/actions'\r\nimport { emitter } from '../helpers/util_emitter'\r\nimport { t } from '../helpers/util_translate'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n    isButtonDialog: state.app.ui.isButtonDialog,\r\n    isDialog: state.app.ui.isDialog,\r\n    isShowClickFullScreen: state.app.ui.isShowButtFullScreen,\r\n    isShowInfo: state.app.ui.isShowInfo,\r\n    isShowFinalMessage: state.app.ui.isShowFinalMessage,\r\n})\r\n\r\n\r\n\r\n\r\nfunction App(props) {\r\n    !pr.dispatch && (pr.dispatch = props.dispatch)\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"ui\">\r\n            {props.isButtonDialog && (\r\n                <button\r\n                    className=\"butt-toggleDialog\"\r\n                    onClick={() => {toggleDialog(props.dispatch).toggleDialog(!props.isDialog)}}>\r\n                    {props.isDialog ? t('close dialog') : t('open dialog') }\r\n                </button>)}\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-left control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-left')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-left')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-left')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-left')}>\r\n                    &#9668;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-right control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-right')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-right')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-right')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-right')}>\r\n                    &#9658;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && (\r\n                <button\r\n                    className=\"butt-front control\"\r\n                    onMouseDown={() => emitter.emit('mouseDown')('butt-front')}\r\n                    onTouchStart={() => emitter.emit('mouseDown')('butt-front')}\r\n                    onMouseUp={() => emitter.emit('mouseUp')('butt-front')}\r\n                    onTouchEnd={() => emitter.emit('mouseUp')('butt-front')}>\r\n                    &#9650;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && props.isShowClickFullScreen && (\r\n                <button\r\n                    className=\"butt-fullscreen control\"\r\n                    onClick={() => {\r\n                        emitter.emit('mouseDown')('butt-fullscreen')\r\n                        clickFullScreen(props.dispatch).clickFullScreen()\r\n                    }}>\r\n                    &#10066;\r\n                </button>)}\r\n\r\n\r\n\r\n            {!props.isDialog && !props.isShowInfo && (\r\n                <button\r\n                    className=\"butt-info control\"\r\n                    onClick={() => clickInfo(props.dispatch).clickInfo(true)}>\r\n                    i\r\n                </button>)}\r\n\r\n\r\n\r\n\r\n            {props.isDialog && (\r\n                <div className=\"dialog\">\r\n                    <div className=\"dialog-inner\">\r\n                        <BotAnswers />\r\n                        <UserReplicies />\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n\r\n            {props.isShowFinalMessage && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner final-message\">\r\n                        <button\r\n                            className=\"control butt-infoClose\"\r\n                            onClick={() => showMessages(props.dispatch).toggleFinalMessage(false)}>\r\n                            x\r\n                        </button>\r\n                        <p>{t('The end')}</p>\r\n                    </div>\r\n                </div>)}\r\n\r\n\r\n\r\n            {props.isShowInfo && (\r\n                <div className=\"info\">\r\n                    <div className=\"info-inner\">\r\n                        <button\r\n                            className=\"control butt-infoClose\"\r\n                            onClick={() => clickInfo(props.dispatch).clickInfo(false)}>\r\n                            x\r\n                        </button>\r\n                        <p>\r\n                            {`1 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/factory/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {`2 ${t('chapter')}: `}\r\n                            <a href=\"http://js.otrisovano.ru/bridge/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {t('Author: ')}\r\n                            <a href=\"http://otrisovano.ru\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                        <p>\r\n                            {t('Github: ')}\r\n                            <a href=\"https://github.com/fire888/levels/\" target=\"blank\">{ t('link') }</a>\r\n                        </p>\r\n                    </div>\r\n                </div>)}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport const pr = { dispatch: null }\r\n\r\nexport default connect(mapStateToProps)(App);\r\n","\r\n\r\n\r\nexport function KeyBoard (emitter) {\r\n    const keys = {\r\n        'up': false,\r\n        'left': false,\r\n        'right': false,\r\n        's': false,\r\n        'm': false,\r\n        'w': false,\r\n    }\r\n\r\n\r\n    const keyUpdate = function ( keyCode, isDown ) {\r\n        switch( keyCode ) {\r\n          case 38:\r\n            keys['up'] = isDown\r\n            break\r\n          case 37:\r\n            keys['left'] = isDown\r\n            break\r\n          case 39:\r\n            keys['right'] = isDown\r\n            break\r\n          case 83:\r\n            keys['s'] = isDown\r\n            break\r\n          case 77:\r\n            keys['m'] = isDown\r\n            break\r\n          case 87:\r\n            keys['w'] = isDown\r\n            break\r\n        }\r\n        emitter.emit('keyEvent')(keys)\r\n    }\r\n\r\n\r\n\r\n    document.addEventListener( 'keydown',\r\n      function (event) { keyUpdate( event.keyCode, true )}.bind(this) )\r\n    document.addEventListener( 'keyup',\r\n      function(event) { keyUpdate( event.keyCode, false )}.bind(this) )\r\n\r\n\r\n\r\n    emitter.subscribe('mouseDown')(key => {\r\n        if (key === 'butt-left') keyUpdate(37, true)\r\n        if (key === 'butt-right') keyUpdate(39, true)\r\n        if (key === 'butt-front') keyUpdate(38, true)\r\n    })\r\n    emitter.subscribe('mouseUp')(key => {\r\n        if (key === 'butt-left') keyUpdate(37, false)\r\n        if (key === 'butt-right') keyUpdate(39, false)\r\n        if (key === 'butt-front') keyUpdate(38, false)\r\n    })\r\n}\r\n\r\n","export default __webpack_public_path__ + \"static/media/px.2be78f43.jpg\";","export default __webpack_public_path__ + \"static/media/nx.b2401269.jpg\";","export default __webpack_public_path__ + \"static/media/py.659ebc34.jpg\";","export default __webpack_public_path__ + \"static/media/ny.462f1251.jpg\";","export default __webpack_public_path__ + \"static/media/pz.8ea5ba14.jpg\";","export default __webpack_public_path__ + \"static/media/nz.7f255b96.jpg\";","export default __webpack_public_path__ + \"static/media/posx.be2d83a2.jpg\";","export default __webpack_public_path__ + \"static/media/negx.d016c8e7.jpg\";","export default __webpack_public_path__ + \"static/media/posy.01cfd221.jpg\";","export default __webpack_public_path__ + \"static/media/negy.f01f8356.jpg\";","export default __webpack_public_path__ + \"static/media/posz.ef37b8e1.jpg\";","export default __webpack_public_path__ + \"static/media/negz.f346a80a.jpg\";","export default __webpack_public_path__ + \"static/media/map-walls-bump.40f05869.png\";","export default __webpack_public_path__ + \"static/media/level-rooms.5251ade2.obj\";","export default __webpack_public_path__ + \"static/media/floor_outer_map.35e50f6e.jpg\";","export default __webpack_public_path__ + \"static/media/botMap.972e276e.png\";","import { DoubleSide } from 'three'\r\n\r\nimport pxjpg from '../assets/skybox/px.jpg'\r\nimport nxjpg from '../assets/skybox/nx.jpg'\r\nimport pyjpg from '../assets/skybox/py.jpg'\r\nimport nyjpg from '../assets/skybox/ny.jpg'\r\nimport pzjpg from '../assets/skybox/pz.jpg'\r\nimport nzjpg from '../assets/skybox/nz.jpg'\r\n\r\nimport pxjpg2 from '../assets/matIronBox/posx.jpg'\r\nimport nxjpg2 from '../assets/matIronBox/negx.jpg'\r\nimport pyjpg2 from '../assets/matIronBox/posy.jpg'\r\nimport nyjpg2 from '../assets/matIronBox/negy.jpg'\r\nimport pzjpg2 from '../assets/matIronBox/posz.jpg'\r\nimport nzjpg2 from '../assets/matIronBox/negz.jpg'\r\n\r\nimport mapBump from '../assets/map-walls-bump.png'\r\nimport levelRoomsSrc from '../assets/level-rooms.obj'\r\nimport mapFloorOuter from '../assets/floor_outer_map.jpg'\r\n\r\nimport botMap from '../assets/botMap.png'\r\nimport botSrc from '../assets/botAnim.glb'\r\n\r\n\r\n\r\nexport const ASSETS_TO_LOAD = [\r\n    {\r\n        type: 'obj',\r\n        filename: levelRoomsSrc,\r\n        key: 'level-rooms'\r\n    }, {\r\n        type: 'glb',\r\n        filename: botSrc,\r\n        key: 'bot'\r\n    }, {\r\n        type: 'cubeTextures',\r\n        filename: { px: pxjpg, nx: nxjpg, py: pyjpg, ny: nyjpg, pz: pzjpg, nz: nzjpg, },\r\n        key: 'skyBox'\r\n    }, {\r\n        type: 'cubeTextures',\r\n        filename: { px: pxjpg2, nx: nxjpg2, py: pyjpg2, ny: nyjpg2, pz: pzjpg2, nz: nzjpg2, },\r\n        key: 'ironEnv',\r\n    }, {\r\n        type: 'img',\r\n        filename: botMap,\r\n        key: 'botMap',\r\n    }, {\r\n        type: 'img',\r\n        filename: mapBump,\r\n        key: 'bumpWalls',\r\n    }, {\r\n        type: 'img',\r\n        filename: mapFloorOuter,\r\n        key: 'mapFloorOuter',\r\n        wrap: true,\r\n},]\r\n\r\n\r\n\r\n\r\nexport const MATERIALS_CONFIG = {\r\n\r\n    'iron': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xffffff,\r\n            emissive: 0x003388,\r\n            specular: 0xffffff,\r\n            shininess: 60,\r\n            bumpMap: 'botMap',\r\n            bumpScale: 0.1,\r\n            envMap: 'ironEnv',\r\n            reflectivity: 0.5,\r\n            map: 'botMap',\r\n            skinning: true,\r\n        },\r\n    },\r\n\r\n    'wall': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n            specular: 0x222222,\r\n        },\r\n    },\r\n\r\n\r\n    'green': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0x004466,\r\n            emissive: 0xffffff,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    },\r\n\r\n    'road': {\r\n        mat: 'MeshPhongMaterial',\r\n        props: {\r\n            color: 0xa1129f,\r\n            emissive: 0xa1129f,\r\n            map: 'mapFloorOuter',\r\n            bumpMap: 'mapFloorOuter',\r\n            bumpScale: 1,\r\n            envMap: 'skyBox',\r\n            reflectivity: 0.5,\r\n        },        \r\n    } \r\n}\r\n\r\n\r\n\r\n\r\n/** size element */\r\nexport const S = 175.335\r\nexport const H = 70\r\n\r\n\r\n\r\n/** emitter constants */\r\nexport const FRAME_UPDATE = 'FRAME_UPDATE'\r\n\r\n\r\n\r\n\r\nexport const FLOORS_CONF = {\r\n    '-2': {\r\n        'outer': { fogNear: -200, fogFar: 500, color: 0x18257d },\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x8805a8 },\r\n    },\r\n\r\n   \r\n\r\n    '-1': {\r\n        'start': { fogNear: 0, fogFar: 5, color: 0x18257d },\r\n        'outer': { fogNear: 20, fogFar: 500, color: 0x18257d },\r\n        'back': { fogNear: 20, fogFar: 500, color: 0x18257d, backgroundImgKey: 'skyBox' },\r\n        'firstRoomLight': { fogNear: -40, fogFar: 150, color: 0x00235e},\r\n        'corridorLight': { fogNear: -40, fogFar: 150, color: 0x6b006c },\r\n        'default': { fogNear: -40, fogFar: 150, color: 0x2e118b },\r\n    },\r\n\r\n\r\n    '0': { 'default': { fogNear: -40, fogFar: 150, color: 0x3c4900 }, },\r\n\r\n    \r\n    '1': { 'default': { fogNear: -40, fogFar: 150, color: 0x0e3e52 }, },\r\n\r\n\r\n    '2': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a1763 }, },\r\n\r\n\r\n    '3': { 'default': { fogNear: 0, fogFar: 80, color: 0x0a6340 }, },\r\n\r\n\r\n    '4': { 'default': { fogNear: 0, fogFar: 80, color: 0xac0000 }, },\r\n}\r\n\r\n\r\n\r\n\r\nexport const studioConfig = {\r\n    canId: 'webgl-canvas',\r\n    rendererCon: {\r\n        antialias: true\r\n    },\r\n    clearColor: FLOORS_CONF[-1]['outer'].color,\r\n    backgroundColor: FLOORS_CONF[-1]['outer'].color,\r\n    amb: {\r\n        color: FLOORS_CONF[-1]['outer'].color,\r\n        strength: 0.7,\r\n    },\r\n}\r\n\r\n\r\nexport const playerConfig = {\r\n    //speed: 0.35,\r\n    speed: 0.8,\r\n    speedRot: 0.02,\r\n    speedDown: -0.45,\r\n    offsetFromFloor: 10.0,\r\n    offsetFromFloorFactor: 0.5,\r\n    offsetWallCollision: 3.5,\r\n    level: -13,\r\n    startRot: [0, 0, 0],\r\n    startPos: [100, -60, 1000],\r\n    //startPos: [90, -10, 360.7140705920112], // beginPlay\r\n    cameraData: {\r\n        fov: 90,\r\n        ratio: window.innerWidth / window.innerHeight,\r\n        near: 0.1,\r\n        far: 1000,\r\n        pos: [0, 2, -0.5],\r\n    },\r\n    frontObjPos: [0, 0, -1],\r\n    lightDataOne: {\r\n        //color: 0xc2d4f3,\r\n        color: 0xffffff,\r\n        strength: 5000,\r\n        pos: [0, 50, 5],\r\n    },\r\n    // lightDataTwo: {\r\n    //     color: 0xff0000,\r\n    //     strength: 0.2,\r\n    //     pos: [0, -30, 40],\r\n    // },\r\n}\r\n","export default __webpack_public_path__ + \"static/media/botAnim.5bfca6de.glb\";","import * as THREE from 'three'\r\nimport { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader'\r\nimport { GLTFLoader } from  'three/examples/jsm/loaders/GLTFLoader'\r\n\r\n\r\n\r\nlet callback = null\r\nlet dataToLoad = null\r\nconst assets = {}\r\nlet objLoader, textureLoader, gltfLoader, cubeTextureLoader\r\nlet index = 0\r\n\r\n\r\n\r\nconst loadAsset = function (data) {\r\n    if (data.type === 'obj') {\r\n        objLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }\r\n    if (data.type === 'glb' || data.type === 'gltf') {\r\n        gltfLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }        \r\n    if (data.type === 'img') {\r\n        textureLoader.load(data.filename, model => {\r\n            assets[data.key] = model\r\n            checkComplete()        \r\n        })\r\n    }\r\n    if (data.type === 'cubeTextures') {\r\n        cubeTextureLoader.load(\r\n            [\r\n                data.filename['px'],\r\n                data.filename['nx'],\r\n                data.filename['py'],\r\n                data.filename['ny'],\r\n                data.filename['pz'],\r\n                data.filename['nz'],\r\n            ],\r\n            result => {\r\n                assets[data.key] = result\r\n                checkComplete()\r\n            }\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\nconst checkComplete = () => {\r\n    index ++\r\n    index < dataToLoad.length \r\n        ? loadAsset(dataToLoad[index])\r\n        : callback(assets)\r\n}\r\n\r\n\r\n\r\nexport const loadAssets = data => {\r\n    return new Promise(resolve => {\r\n        dataToLoad = data\r\n        callback = resolve\r\n        index = 0\r\n\r\n        objLoader = objLoader || new OBJLoader()\r\n        textureLoader = textureLoader || new THREE.TextureLoader()\r\n        gltfLoader = gltfLoader || new GLTFLoader()\r\n        cubeTextureLoader = cubeTextureLoader || new THREE.CubeTextureLoader()\r\n\r\n        loadAsset(dataToLoad[index])\r\n    })\r\n}\r\n\r\n","import { emitter } from '../helpers/util_emitter'\r\nimport { S, H } from '../constants/constants_elements'\r\nimport { pr } from '../componentsReact/App'\r\n\r\n\r\nexport const START_LAYER_STATE = 'outer'\r\n\r\n\r\n\r\n\r\n\r\nexport const CHANGE_LAYER_STATE = [\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'outer', newState: 'corridor',\r\n        oldQuadrant: [0, -2, 4], newQuadrant: [0, -2, 3],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n                backgroundImg: false\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'corridor', newState: 'outer',\r\n        oldQuadrant: [0, -2, 3], newQuadrant: [0, -2, 4],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'outer',\r\n            },\r\n        ]\r\n    },\r\n\r\n    /** ********************************************************/\r\n    {\r\n        oldState: 'corridor', newState: 'firstRoom',\r\n        oldQuadrant: [0, -1, 2], newQuadrant: [0, -1, 1],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'firstRoomLight',\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'corridor',\r\n        oldQuadrant: [0, -1, 1], newQuadrant: [0, -1, 2],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'corridorLight',\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: [0, -1, 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_MINUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        oldState: 'firstRoom', newState: 'playLevel',\r\n        oldQuadrant: [0, -1, 0], newQuadrant: ['ANY_PLUS_ONE', -1, 0],\r\n        emitData: [\r\n            {\r\n                emitKey: 'DESTROY_START_CORRIDOR'\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT'\r\n            },\r\n        ],\r\n    },\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_PLUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 0,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_MINUS_ONE', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_ENVIRONMENT',\r\n                environmentMode: 'default',\r\n            },\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: () => 100,\r\n            },\r\n        ],\r\n    },\r\n\r\n\r\n    /** ********************************************************/\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_MINUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            },\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_MINUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY_PLUS_ONE', 'ANY', 'ANY'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n    {\r\n        oldState: 'playLevel', newState: 'playLevel',\r\n        oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY', 'ANY_PLUS_ONE'],\r\n        emitData: [\r\n            {\r\n                emitKey: 'CHANGE_QUADRANT',\r\n                counter: val => ++val,\r\n            }\r\n        ],\r\n    },\r\n\r\n\r\n    /** **********************************************************/\r\n\r\n    // {\r\n    //     oldState: 'addWell', newState: 'addWell',\r\n    //     oldQuadrant: ['ANY', 'ANY', 'ANY'], newQuadrant: ['ANY', 'ANY_MINUS_ONE', 'ANY'],\r\n    //     emitData: [\r\n    //         {\r\n    //             emitKey: 'CHANGE_QUADRANT',\r\n    //             counter: val => ++val,\r\n    //         }\r\n    //     ],\r\n    // },\r\n]\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createActionByChangedQuadrant = () => {\r\n    const checkerNewQuadrant = createCheckerNewQuadrant()\r\n\r\n\r\n    emitter.subscribe('playerMove')(pos => {\r\n        const data = checkerNewQuadrant.update(pos)\r\n        const { currentQuadrant, oldQuadrant, isChanged } = data\r\n\r\n        if (!isChanged) return;\r\n\r\n        const arrEmitData = getEmitsByChangeQuadrant(oldQuadrant, currentQuadrant)\r\n\r\n        arrEmitData.length && arrEmitData.forEach(item => pr.dispatch({\r\n            ...item,\r\n            type: item.emitKey,\r\n        }))\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet levelState = START_LAYER_STATE\r\n\r\n\r\nexport const getEmitsByChangeQuadrant = (playerOldQ, playerNewQ) => {\r\n    for (let i = 0; i < CHANGE_LAYER_STATE.length; ++i) {\r\n        const data = getData(\r\n            [...playerOldQ],\r\n            [...playerNewQ],\r\n            {\r\n                ...CHANGE_LAYER_STATE[i],\r\n                oldQuadrant: [...CHANGE_LAYER_STATE[i].oldQuadrant],\r\n                newQuadrant: [...CHANGE_LAYER_STATE[i].newQuadrant],\r\n            }\r\n        )\r\n        if (data) return data;\r\n    }\r\n    return { levelState }\r\n}\r\n\r\n\r\n\r\n\r\nconst getData = (playerOldQ, playerNewQ, conf) => {\r\n    const { oldState, newState, oldQuadrant, newQuadrant, emitData } = conf\r\n\r\n    if (levelState !== oldState)\r\n        return;\r\n\r\n\r\n    if (oldQuadrant[0] === 'ANY') oldQuadrant[0] = playerOldQ[0]\r\n    if (oldQuadrant[1] === 'ANY') oldQuadrant[1] = playerOldQ[1]\r\n    if (oldQuadrant[2] === 'ANY') oldQuadrant[2] = playerOldQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY') newQuadrant[0] = playerNewQ[0]\r\n    if (newQuadrant[1] === 'ANY') newQuadrant[1] = playerNewQ[1]\r\n    if (newQuadrant[2] === 'ANY') newQuadrant[2] = playerNewQ[2]\r\n\r\n    if (newQuadrant[0] === 'ANY_PLUS_ONE') newQuadrant[0] = playerOldQ[0] + 1\r\n    if (newQuadrant[1] === 'ANY_PLUS_ONE') newQuadrant[1] = playerOldQ[1] + 1\r\n    if (newQuadrant[2] === 'ANY_PLUS_ONE') newQuadrant[2] = playerOldQ[2] + 1\r\n\r\n    if (newQuadrant[0] === 'ANY_MINUS_ONE') newQuadrant[0] = playerOldQ[0] - 1\r\n    if (newQuadrant[1] === 'ANY_MINUS_ONE') newQuadrant[1] = playerOldQ[1] - 1\r\n    if (newQuadrant[2] === 'ANY_MINUS_ONE') newQuadrant[2] = playerOldQ[2] - 1\r\n\r\n\r\n    if (\r\n        oldQuadrant[0] !== playerOldQ[0] ||\r\n        oldQuadrant[1] !== playerOldQ[1] ||\r\n        oldQuadrant[2] !== playerOldQ[2] ||\r\n        newQuadrant[0] !== playerNewQ[0] ||\r\n        newQuadrant[1] !== playerNewQ[1] ||\r\n        newQuadrant[2] !== playerNewQ[2]\r\n    ) return;\r\n\r\n\r\n    levelState = newState\r\n\r\n    return emitData.map(item => ({\r\n        ...item,\r\n        levelState,\r\n        oldQuadrant: [...oldQuadrant],\r\n        newQuadrant: [...newQuadrant],\r\n    }))\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst createCheckerNewQuadrant = function () {\r\n    let oldQuadrant = []\r\n\r\n    return {\r\n        update ({ x, y, z}) {\r\n            const currentQuadrant = [Math.floor(x / S), Math.floor(y / H), Math.floor(z / S)]\r\n\r\n            if (\r\n                currentQuadrant[0] !== oldQuadrant[0] ||\r\n                currentQuadrant[1] !== oldQuadrant[1] ||\r\n                currentQuadrant[2] !== oldQuadrant[2]\r\n            ) {\r\n                const data = {\r\n                    isChanged: true,\r\n                    currentQuadrant,\r\n                    oldQuadrant,\r\n                }\r\n                oldQuadrant = [...currentQuadrant]\r\n\r\n                return data\r\n            } else {\r\n                return { isChanged: false }\r\n            }\r\n        },\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n","import { MATERIALS_CONFIG } from '../constants/constants_elements'\r\nimport * as THREE from 'three'\r\n\r\n\r\n\r\nexport function prepareMeshesFromAssets (assets) {\r\n    const\r\n        materials = createMaterials(assets),\r\n        rooms = {},\r\n        allMeshes = {}\r\n\r\n    assets.collisionsBotsRooms = {}\r\n\r\n    assets['level-rooms'].traverse(child => {\r\n        if (child.name.includes(\"room_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            rooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"collision_\")) {\r\n            const mesh = new THREE.Mesh(child.geometry)\r\n            assets.collisionsBotsRooms[child.name] = mesh\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_walls\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.wall)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_road\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.green)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }\r\n        if (child.name.includes(\"outer_floor\")) {\r\n            const mesh = new THREE.Mesh(child.geometry, materials.road)\r\n            mesh.name = child.name\r\n            allMeshes[child.name] = mesh\r\n        }  \r\n    })\r\n\r\n    return {\r\n        rooms,\r\n        allMeshes,\r\n        materials,\r\n    }\r\n}\r\n\r\n\r\n\r\nconst createMaterials = assets => {\r\n    for (let key in assets) \r\n        assets[key].wrapS && (assets[key].wrapS = assets[key].wrapT = THREE.RepeatWrapping)\r\n\r\n    const mapsKeys = ['bumpMap', 'envMap', 'map', 'normalMap', 'lightMap', 'aoMap']\r\n    const materials = {}\r\n    for (let key in MATERIALS_CONFIG) {\r\n        materials[key] = new THREE[MATERIALS_CONFIG[key].mat]({\r\n            ...MATERIALS_CONFIG[key].props\r\n        })\r\n        mapsKeys.map(keyMap =>\r\n            MATERIALS_CONFIG[key].props[keyMap] &&\r\n                (materials[key][keyMap] = assets[MATERIALS_CONFIG[key].props[keyMap]])\r\n        )\r\n    }\r\n    return materials\r\n}\r\n","// import saturateVert from './saturate.vert'\r\n// import saturateFrag from './saturate.frag'\r\n\r\n\r\nexport const Saturate = {\r\n    uniforms: {\r\n        \"tDiffuse\": { value: null },\r\n    },\r\n\r\n    //vertexShader: saturateVert,\r\n    //fragmentShader: saturateFrag,\r\n\r\n\r\n\r\n    vertexShader: `\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n    vUv = uv;\r\n    gl_Position = projectionMatrix*modelViewMatrix*vec4( position, 1.0 );\r\n}`,\r\n    fragmentShader: `\r\n\r\nuniform sampler2D tDiffuse;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n    vec4 texel = texture2D( tDiffuse, vUv );\r\n    gl_FragColor = (texel * texel * texel) * vec4(3.);\r\n\r\n}`,\r\n}\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet FLOORS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionFloors = (objFromLink, offset, delta, speed) => {\r\n    const objFrom = objFromLink\r\n    const offsetFromFloor = offset\r\n    const offsetFromFloorFactor = delta\r\n    const speedDown = speed\r\n\r\n    const vec3Src = new THREE.Vector3()\r\n    const vec3Ray = new THREE.Vector3(0, -1, 0)\r\n\r\n    let isDisable = true\r\n\r\n    return {\r\n        check: updateData => {\r\n            if (isDisable) return;\r\n\r\n            vec3Src.copy(objFrom.position)\r\n            const raycasterDown = new THREE.Raycaster(vec3Src, vec3Ray)\r\n            const intersectsFloor = raycasterDown.intersectObjects(FLOORS_ARRAY)\r\n            if (intersectsFloor && intersectsFloor[0] && intersectsFloor[0].distance > offsetFromFloor + offsetFromFloorFactor) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            }\r\n            if (intersectsFloor && !intersectsFloor[0]) {\r\n                objFrom.position.y += speedDown * updateData.count\r\n                return;\r\n            } \r\n            objFrom.position.y = intersectsFloor[0].point.y + offsetFromFloor\r\n        },\r\n        start: () => {\r\n            isDisable = false\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport const setItemToFloorsCollision = item => FLOORS_ARRAY.push(item)\r\nexport const removeItemFromFloorsCollision = item => FLOORS_ARRAY = FLOORS_ARRAY.filter(mesh => mesh !== item) \r\n\r\n","import * as THREE from 'three'\r\n\r\n\r\n\r\nlet WALLS_ARRAY = []\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFromLink, objToLink, offset) => {\r\n    const offsetWallCollision = offset\r\n    const objFrom = objFromLink\r\n    const objTo = objToLink\r\n\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            vec3Src2.copy(objFrom.position)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2)\r\n            const intersectsWalls = raycasterWalls.intersectObjects(WALLS_ARRAY)\r\n\r\n            return intersectsWalls[0] && intersectsWalls[0].distance < offsetWallCollision\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport const setItemToWallCollision = item => WALLS_ARRAY.push(item)\r\nexport const removeItemFromWallCollision = item => WALLS_ARRAY = WALLS_ARRAY.filter(mesh => item !== mesh)\r\n","\r\n\r\nlet arrItems = []\r\n\r\n\r\n\r\nexport const addItemToNearChecker = item => arrItems.push(item)\r\n\r\n\r\n\r\nexport const removeItemByName = name => arrItems = arrItems.filter(item => item.name !== name)\r\n\r\n\r\n\r\nexport const createCheckerNearItem = (mesh, emitter) => () => {\r\n    arrItems.forEach(item => {\r\n        if (mesh.position.distanceTo(item.position) < 10 && !item.userData.nearPlayer) {\r\n            item.userData.nearPlayer = true\r\n            emitter.emit('nearMesh')({ toNear: true, mesh: item })\r\n        }\r\n        if (mesh.position.distanceTo(item.position) >= 10 && item.userData.nearPlayer) {\r\n            item.userData.nearPlayer = false\r\n            emitter.emit('nearMesh')({ toNear: false, mesh: item })\r\n        }\r\n    })\r\n}\r\n\r\n","import * as THREE from 'three'\r\n\r\nimport { playerConfig } from '../constants/constants_elements'\r\n\r\nimport { createComponentCollisionFloors } from '../components/component_collisionFloor'\r\nimport { createComponentCollisionWalls } from '../components/component_collisionWalls'\r\nimport { createCheckerNearItem } from '../components/component_checkNearItem'\r\n\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { showMessages } from '../store/actions'\r\nimport { pr } from '../componentsReact/App'\r\n\r\n\r\n\r\nexport function createPlayer (emitterLink) {\r\n    const emitter = emitterLink\r\n\r\n    const {\r\n        startPos,\r\n        startRot,\r\n        cameraData,\r\n        frontObjPos,\r\n        lightDataOne,\r\n        lightDataTwo,\r\n        speed,\r\n        offsetFromFloor,\r\n        offsetFromFloorFactor,\r\n        speedDown,\r\n        offsetWallCollision,\r\n        speedRot,\r\n    } = playerConfig\r\n\r\n\r\n    let camera\r\n    let keys = {}\r\n    let isButtonsDisabled = false\r\n    let isBlocked = true\r\n\r\n    const mainObj = new THREE.Object3D()\r\n    mainObj.position.fromArray(startPos)\r\n    mainObj.rotation.fromArray(startRot)\r\n\r\n    const frontObj = new THREE.Object3D()\r\n    frontObj.position.fromArray(frontObjPos)\r\n    mainObj.add(frontObj)\r\n  \r\n    {\r\n        const { fov, ratio, near, far, pos } = cameraData\r\n        camera = new THREE.PerspectiveCamera(fov, ratio, near, far)\r\n        camera.position.fromArray(pos)\r\n        mainObj.add(camera)\r\n    }\r\n\r\n    {\r\n        const { color, strenth, pos } = lightDataOne\r\n        const light = new THREE.PointLight(color, strenth)\r\n        light.position.fromArray(pos)\r\n        mainObj.add(light)\r\n    }\r\n\r\n    {\r\n      //const { color, strenth, pos } = lightDataTwo\r\n      //const light = new THREE.PointLight(color, strenth)\r\n      //light.position.fromArray(pos)\r\n      //mainObj.add(light)\r\n    }\r\n\r\n    const checkFloors = createComponentCollisionFloors(mainObj, offsetFromFloor, offsetFromFloorFactor, speedDown)\r\n    const checkWalls = createComponentCollisionWalls(mainObj, frontObj, offsetWallCollision)\r\n    const checkNearItem = createCheckerNearItem(mainObj, emitter)\r\n\r\n    let oldY = mainObj.position.y\r\n    let countDropped = 0\r\n    let isGameComplete = false\r\n\r\n    const update = data => {\r\n        if (isButtonsDisabled) return;\r\n        if (isBlocked) return;\r\n\r\n        checkFloors.check(data)\r\n\r\n        if (!keys) return;\r\n\r\n        if (keys['up']) {\r\n            if (checkWalls.check()) return;\r\n\r\n            mainObj.translateZ(-speed * data.count)\r\n            //console.log(mainObj.position.x,  mainObj.position.y, mainObj.position.z)\r\n            checkNearItem()\r\n            emitter.emit('playerMove')(mainObj.position)\r\n        }\r\n        keys['left'] && (mainObj.rotation.y += (speedRot * data.count))\r\n        keys['right'] && (mainObj.rotation.y -= (speedRot * data.count))\r\n\r\n\r\n        if (oldY > mainObj.position.y) {\r\n            ++countDropped\r\n        } else {\r\n            countDropped = 0\r\n        }\r\n        oldY = mainObj.position.y\r\n\r\n        if (countDropped > 800 && !isGameComplete) {\r\n            isGameComplete = true\r\n            setTimeout(() => {\r\n                showMessages(pr.dispatch).toggleFinalMessage(true)\r\n            }, 20000)\r\n        }\r\n    }\r\n\r\n\r\n    emitter.subscribe('keyEvent')(data => keys = data)\r\n    emitter.subscribe(FRAME_UPDATE)(update)\r\n    emitter.subscribe('toggleDialog')(val => isButtonsDisabled = val.isOpen)\r\n\r\n\r\n    return {\r\n        start: () => { \r\n            isBlocked = false\r\n            checkFloors.start()\r\n        },\r\n        getObj: () => mainObj,\r\n        getCamera: () => camera,\r\n        setToPos: (x, y, z) => mainObj.position.set(x, y, z)\r\n    }\r\n}\r\n\r\n","import '../stylesheets/style.css'\r\n\r\n\r\n\r\n\r\n/** ANIMATION LOADER */\r\nconst loader = document.querySelector('.progress')\r\nlet offsetLoader = -100\r\nlet isAnimateLoader = true\r\n\r\n\r\n\r\nconst loaderTimeOut = () => {\r\n      if (!isAnimateLoader) return;\r\n\r\n      setTimeout(() => {\r\n            offsetLoader ++;\r\n            offsetLoader == 0 && (offsetLoader = -100)\r\n            loader.style.marginLeft = offsetLoader + '%'\r\n            loaderTimeOut()\r\n      }, 30)\r\n}\r\n\r\n\r\n\r\nloaderTimeOut()\r\n\r\n\r\n\r\nexport const showStartButton = emitter => {\r\n    const startButtons = document.querySelector('.startbuttons-wrapper')\r\n    const progressWrapper = document.querySelector('.progress-wrapper')\r\n\r\n    const hideStartScreen = e => {\r\n        emitter.emit('setLanguage')(e.target.dataset.lang)\r\n        document.querySelector('.start-screen').style.display = 'none'\r\n    }\r\n\r\n    isAnimateLoader = false\r\n    startButtons.style.display = 'flex'\r\n    startButtons.addEventListener('click', hideStartScreen)\r\n    progressWrapper.style.display = 'none'\r\n}\r\n\r\n","import {\r\n    setItemToFloorsCollision,\r\n    removeItemFromFloorsCollision, \r\n} from '../components/component_collisionFloor'\r\nimport {\r\n    setItemToWallCollision,\r\n    removeItemFromWallCollision,\r\n} from '../components/component_collisionWalls'\r\nimport * as THREE from 'three'\r\nimport { S, H } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst STANDART_ROOMS = ['room_02', 'room_03', 'room_04', 'room_05']\r\nconst START_ROOMS = ['outer_walls', 'outer_floor', 'outer_road']\r\nconst EXIT_ROOMS = ['room_07']\r\n\r\n\r\n\r\n\r\n\r\nexport function createLevel (emitter, rooms, allMeshes, store) {\r\n    const group = new THREE.Group()\r\n    const objRooms = {}\r\n\r\n\r\n    let isBotLevel = false\r\n    //let isCanAddStairs = false\r\n    let state = 'normal' // 'addBot' || 'addStairs' || 'addWell'\r\n\r\n\r\n    const createRoom = (kv, key) => {\r\n        const instanceKey = key || STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n        \r\n        const objKey = `r_${kv[0]}_${kv[1]}_${kv[2]}` \r\n\r\n        const mesh = rooms[instanceKey].clone()\r\n        mesh.position.set(kv[0] * S, kv[1] * H, kv[2] * S)\r\n        setItemToFloorsCollision(mesh)\r\n        setItemToWallCollision(mesh)\r\n        group.add(mesh)\r\n        objRooms[objKey] = mesh\r\n\r\n\r\n        emitter.emit('levelChanged')({\r\n            typeLevelChange: 'createRoom',\r\n            instanceKey,\r\n            objKey,\r\n            kv,\r\n            isAddBot: instanceKey === 'room_01'\r\n        })    \r\n\r\n        instanceKey === 'room_06' && createRoom([kv[0], kv[1] + 1, kv[2]], 'room_dummy')\r\n    }\r\n\r\n\r\n    const removeRoom = kv => {\r\n        const objKey = `r_${ kv[0] }_${ kv[1] }_${ kv[2] }`\r\n        if (!objRooms[objKey]) return;\r\n\r\n    \r\n        const instanceKey = objRooms[objKey].name\r\n\r\n        // objRooms[objKey].children[0].geometry.dispose()\r\n        // objRooms[objKey].children[0].material.dispose()\r\n        group.remove(objRooms[objKey])\r\n        removeItemFromFloorsCollision(objRooms[objKey])\r\n        removeItemFromWallCollision(objRooms[objKey])\r\n        delete objRooms[objKey]\r\n\r\n        if (instanceKey === 'room_01') {\r\n            isBotLevel = false\r\n        }\r\n\r\n        emitter.emit('levelChanged')({\r\n            typeLevelChange: 'destroyRoom',\r\n            instanceKey,\r\n            objKey,\r\n            kv,\r\n            isRemoveBot: instanceKey === 'room_01'\r\n        })    \r\n\r\n        instanceKey === 'room_dummy' && removeRoom([kv[0], kv[1] - 1, kv[2]])\r\n        instanceKey === 'room_06' && removeRoom([kv[0], kv[1] + 1, kv[2]])\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    createRoom([0, -1, 0], 'room_02')\r\n    createRoom([0, -1, -1], 'room_02')\r\n    createRoom([-1, -1, 0], 'room_02')\r\n    createRoom([1, -1, 0], 'room_02')\r\n\r\n\r\n\r\n    /** add remove start corridors */\r\n    const startL = {}\r\n    for (let i = 0; i < START_ROOMS.length; ++i) {\r\n        const l = allMeshes[START_ROOMS[i]].clone()\r\n        setItemToFloorsCollision(l)\r\n        setItemToWallCollision(l)\r\n        group.add(l)\r\n        l.position.set(0, -1 * H, 0)\r\n        startL[START_ROOMS[i]] = l\r\n    }\r\n\r\n\r\n\r\n\r\n    let wentLevels = 0\r\n    let flagIsSpecial = false\r\n\r\n    const initState = store.getState()\r\n    let saveOldQuadrant = initState.app.playerQuadrant.oldQuadrant\r\n    let saveNewQuadrant = initState.app.playerQuadrant.newQuadrant\r\n    let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n\r\n\r\n\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n\r\n        if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n            saveIsStartCorridorShow = false\r\n            for (let key in startL) {\r\n                removeItemFromFloorsCollision(startL[key])\r\n                removeItemFromWallCollision(startL[key])\r\n                group.remove(startL[key])\r\n            }\r\n        }\r\n\r\n\r\n        const { type, levelState, oldQuadrant, newQuadrant, counter } = newState.app.playerQuadrant\r\n\r\n\r\n        if ( type !== 'CHANGE_QUADRANT' ) return;\r\n\r\n\r\n        if (\r\n            saveOldQuadrant[0] !== oldQuadrant[0] ||\r\n            saveOldQuadrant[1] !== oldQuadrant[1] ||\r\n            saveOldQuadrant[2] !== oldQuadrant[2] ||\r\n            saveNewQuadrant[0] !== newQuadrant[0] ||\r\n            saveNewQuadrant[1] !== newQuadrant[1] ||\r\n            saveNewQuadrant[2] !== newQuadrant[2]\r\n        ) {\r\n            saveOldQuadrant = [...oldQuadrant]\r\n            saveNewQuadrant = [...newQuadrant]\r\n        } else {\r\n            return;\r\n        }\r\n\r\n\r\n        //let keyCreateRoom = false\r\n        let keyCreateRoom = STANDART_ROOMS[Math.floor(Math.random() * STANDART_ROOMS.length)]\r\n        if (counter) {\r\n            wentLevels = counter(wentLevels)\r\n\r\n            if (flagIsSpecial) {\r\n                flagIsSpecial = false\r\n            } else {\r\n                if (wentLevels < 3) {\r\n                    state = 'normal'\r\n                } else if (wentLevels < 100) {\r\n                    if (state === 'normal') {\r\n                        state = 'addBot'\r\n                    }\r\n                } else {\r\n                    state = 'addStairs'\r\n                }\r\n\r\n\r\n                if (state === 'addBot') {\r\n                    keyCreateRoom = 'room_01'\r\n                    flagIsSpecial = true\r\n                }\r\n                if (state === 'addStairs') {\r\n                    keyCreateRoom = 'room_06'\r\n                    flagIsSpecial = true\r\n                }\r\n                if (state === 'addWell') {\r\n                    keyCreateRoom = 'room_07'\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        emitter.subscribe('changeLevelMode')(newMode => state = newMode)\r\n\r\n\r\n        const oldKv = oldQuadrant, curKv = newQuadrant\r\n        // move west\r\n        if (curKv[0] < oldKv[0]) {\r\n            console.log('----------- west')\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n\r\n            // set center to east\r\n            objRooms[`r_${curKv[0] + 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n            // create west\r\n            createRoom([oldKv[0] - 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create soush\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n        }\r\n\r\n        // move east\r\n        if (curKv[0] > oldKv[0]) {\r\n            console.log('----------- east')\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n\r\n            // set center to east\r\n            objRooms[`r_${curKv[0] - 1}_${curKv[1]}_${curKv[2]}`] = objRooms[`r_${oldKv[0]}_${oldKv[1]}_${oldKv[2]}`]\r\n\r\n            // create east\r\n            createRoom([oldKv[0] + 2, oldKv[1], oldKv[2]], keyCreateRoom)\r\n\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1], keyCreateRoom)\r\n\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create south\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1], keyCreateRoom)\r\n        }\r\n\r\n\r\n        // move north\r\n        if (curKv[2] < oldKv[2]) {\r\n            console.log('-----------north')\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n\r\n            // set center to south\r\n            objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] + 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n            // create north\r\n            createRoom([oldKv[0], oldKv[1], oldKv[2] - 2], keyCreateRoom)\r\n\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create west\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create east\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n        }\r\n\r\n\r\n        // move south\r\n        if (curKv[2] > oldKv[2]) {\r\n            console.log('-----------south')\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n\r\n            // set center to north\r\n            objRooms[`r_${ curKv[0] }_${ curKv[1] }_${ curKv[2] - 1 }`] = objRooms[`r_${ oldKv[0] }_${ oldKv[1] }_${ oldKv[2] }`]\r\n\r\n            // create south\r\n            createRoom([oldKv[0], oldKv[1], oldKv[2] + 2], keyCreateRoom)\r\n\r\n            // remove west\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create west\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]], keyCreateRoom)\r\n\r\n            // remove east\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create east\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]], keyCreateRoom)\r\n        }\r\n\r\n        // move top\r\n        if (curKv[1] > oldKv[1] || curKv[1] < oldKv[1]) {\r\n            console.log('-----------top')\r\n            // remove north\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] - 1])\r\n            // create north\r\n            createRoom([curKv[0], curKv[1], curKv[2] - 1])\r\n            // remove south\r\n            removeRoom([oldKv[0], oldKv[1], oldKv[2] + 1])\r\n            // create south\r\n            createRoom([curKv[0], curKv[1], curKv[2] + 1])\r\n            // remove left\r\n            removeRoom([oldKv[0] - 1, oldKv[1], oldKv[2]])\r\n            // create left\r\n            createRoom([curKv[0] - 1, curKv[1], curKv[2]])\r\n            // remove right\r\n            removeRoom([oldKv[0] + 1, oldKv[1], oldKv[2]])\r\n            // create right\r\n            createRoom([curKv[0] + 1, curKv[1], curKv[2]])\r\n        }\r\n\r\n    })\r\n\r\n    return { group }\r\n}\r\n\r\n\r\n\r\n// const geometry = mesh.geometry\r\n// const wireframe = new THREE.WireframeGeometry( geometry );\r\n// const line = new THREE.LineSegments( wireframe );\r\n// line.material.color = { r: 0.5, g: 0.5, b: 0.5}\r\n// line.material.linewidth = 50\r\n// line.material.opacity = 0.5;\r\n// line.material.transparent = true;\r\n// mesh.add( line );","import * as THREE from 'three'\r\nimport { GLTFCopy } from '../helpers/util_GLTFcopy'\r\n\r\n\r\nconst OFFSETS = {\r\n    'room_01': { x: 55, z: 75}\r\n}\r\n\r\nexport class Bot {\r\n    constructor () {\r\n        this.inScene = false\r\n\r\n        this._state = 'go' // || 'rotate' || 'say'\r\n\r\n        this._targetAngle = null\r\n\r\n\r\n        this.container = new THREE.Group()\r\n\r\n        this._modelGroup = new THREE.Group()\r\n        this._modelGroup.position.x = OFFSETS['room_01'].x\r\n        this._modelGroup.position.z = OFFSETS['room_01'].z\r\n        this._modelGroup.rotation.y = Math.random() * (2 * Math.PI)\r\n        this.container.add(this._modelGroup)\r\n\r\n        this._objFrom = new THREE.Object3D()\r\n        this._modelGroup.add(this._objFrom)\r\n\r\n\r\n        this._objTo = new THREE.Object3D()\r\n        this._objTo.position.set(0, 0, 1)\r\n        this._modelGroup.add(this._objTo)\r\n\r\n\r\n        const copy = GLTFCopy(Bot.botScene)\r\n        this.model = copy.scene.children[0]\r\n        this.model.children[1].material = Bot.botMaterial\r\n        this._animations = Bot.botScene.animations\r\n        this._mixer = new THREE.AnimationMixer(this.model.children[1])\r\n        this._walkAction = this._mixer.clipAction(this._animations[0])\r\n        this._walkAction.play()\r\n\r\n        this._modelGroup.add(this.model)\r\n    }\r\n\r\n\r\n    update (data) {\r\n        this._mixer.update(data.delta)\r\n\r\n        if (!this._componentCollision) return;\r\n\r\n        this._updateState()\r\n    }\r\n\r\n\r\n    setCollisionMesh (mesh) {\r\n        this._collisionMeshes = [mesh]\r\n        this.container.add(mesh)\r\n        mesh.material.visible = false\r\n\r\n\r\n        this._componentCollision = createComponentCollisionWalls(this._objFrom, this._objTo, 7, this._collisionMeshes)\r\n    }\r\n\r\n    removeCollisionMesh () {\r\n        this._collisionMeshes = null\r\n        this._componentCollision = null\r\n    }\r\n\r\n\r\n    prepareToSay (pos) {\r\n        this._state = 'say'\r\n\r\n        this._modelGroup.lookAt(pos.x, this.container.position.y, pos.z)\r\n    }\r\n\r\n\r\n    /** internal *****************************/\r\n\r\n    _updateState () {\r\n        if (this._state === 'go') {\r\n            const isNear = this._componentCollision.check()\r\n            if (!isNear) {\r\n                this._modelGroup.translateZ(0.1)\r\n            } else {\r\n                this._startRotate()\r\n            }\r\n        }\r\n\r\n        if (this._state === 'rotate') {\r\n            this._modelGroup.rotation.y += ((this._targetAngle - this._modelGroup.rotation.y) < 0) ? -.01 : .01\r\n            this._modelGroup.rotation.y %= 2 * Math.PI\r\n            const isComplete = Math.abs(this._modelGroup.rotation.y - this._targetAngle) < .5\r\n            isComplete && this._startGo()\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _startGo () {\r\n        this._state = 'go'\r\n    }\r\n\r\n\r\n    _startRotate() {\r\n        this._state = 'rotate'\r\n        this._targetAngle = (this._modelGroup.rotation.y + 1.5 + Math.random() * 4) % (2 * Math.PI)\r\n    }\r\n}\r\n\r\nBot.botScene = null\r\nBot.botMaterial = null\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport const createComponentCollisionWalls = (objFrom, objTo, offset, arrWalls) => {\r\n    const vec3Src2 = new THREE.Vector3()\r\n    const vec3Ray2 = new THREE.Vector3()\r\n\r\n    return {\r\n        check: () => {\r\n            objTo.getWorldPosition(vec3Ray2)\r\n            objFrom.getWorldPosition(vec3Src2)\r\n            vec3Ray2.sub(vec3Src2)\r\n\r\n            const raycasterWalls = new THREE.Raycaster(vec3Src2, vec3Ray2, 0, 20)\r\n            const intersectsWalls = raycasterWalls.intersectObject(arrWalls[0], true)\r\n\r\n            return !!intersectsWalls[0]\r\n        }\r\n    }\r\n}","import * as THREE from 'three'\r\n\r\n\r\n\r\nexport const GLTFCopy = gltf => {\r\n    const clone = {\r\n          animations: gltf.animations,\r\n          scene: gltf.scene.clone(true)\r\n    };\r\n  \r\n    const skinnedMeshes = {};\r\n  \r\n    gltf.scene.traverse(node => {\r\n        if (node.isSkinnedMesh) {\r\n            skinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    const cloneBones = {};\r\n    const cloneSkinnedMeshes = {};\r\n  \r\n    clone.scene.traverse(node => {\r\n        if (node.isBone) {\r\n            cloneBones[node.name] = node;\r\n        }\r\n  \r\n        if (node.isSkinnedMesh) {\r\n            cloneSkinnedMeshes[node.name] = node;\r\n        }\r\n    });\r\n  \r\n    for (let name in skinnedMeshes) {\r\n        const skinnedMesh = skinnedMeshes[name];\r\n        const skeleton = skinnedMesh.skeleton;\r\n        const cloneSkinnedMesh = cloneSkinnedMeshes[name];\r\n  \r\n        const orderedCloneBones = [];\r\n  \r\n        for (let i = 0; i < skeleton.bones.length; ++i) {\r\n            const cloneBone = cloneBones[skeleton.bones[i].name];\r\n            orderedCloneBones.push(cloneBone);\r\n        }\r\n  \r\n        cloneSkinnedMesh.bind(\r\n            new THREE.Skeleton(orderedCloneBones, skeleton.boneInverses),\r\n            cloneSkinnedMesh.matrixWorld);\r\n    }\r\n  \r\n    return clone;\r\n}","import * as THREE from 'three'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { MAT_IRON } from '../constants/constants_elements'\r\nimport { Bot } from '../entities/Bot'\r\nimport { pr } from '../componentsReact/App'\r\nimport { toggleDialog } from '../store/actions'\r\n\r\n\r\nconst S = 175.335\r\nconst H = 70\r\n//const H_BOT = 14.193\r\nconst H_BOT = 14\r\n\r\n\r\n\r\n\r\nexport const createSystemBots = (assets, materials, emitter, store) => {\r\n    Bot.botMaterial = materials.iron\r\n    Bot.botScene = assets.bot\r\n\r\n\r\n\r\n    const groupBots = new THREE.Group()\r\n    const arrBots = []\r\n\r\n\r\n\r\n    for (let i = 0; i < 5; ++i) {\r\n        const bot = new Bot()\r\n        groupBots.add(bot.container)\r\n        bot.container.position.set(-30 + i * 30, -92, 750)\r\n        bot.inScene = 'aaa'\r\n        bot.setCollisionMesh(assets.collisionsBotsRooms['collision_r_01'].clone())\r\n        arrBots.push(bot)\r\n    }\r\n\r\n\r\n\r\n\r\n    emitter.subscribe(FRAME_UPDATE)(data => {\r\n        for (let i = 0; i < arrBots.length; ++i) arrBots[i].inScene && arrBots[i].update(data)\r\n    })\r\n\r\n\r\n\r\n\r\n    const initState = store.getState()\r\n    let saveIsStartCorridorShow = initState.app.level.isStartCorridorShow\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n        if (saveIsStartCorridorShow && saveIsStartCorridorShow !== newState.app.level.isStartCorridorShow) {\r\n            saveIsStartCorridorShow = newState.app.level.isStartCorridorShow\r\n\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                arrBots[i].inScene = null\r\n                arrBots[i].container.position.y = -10000\r\n                arrBots[i].removeCollisionMesh()\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    emitter.subscribe('levelChanged')(({ typeLevelChange, instanceKey, objKey, kv, isAddBot, isRemoveBot }) => {\r\n        if (isAddBot) {\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                if (!arrBots[i].inScene) {\r\n                    arrBots[i].inScene = objKey\r\n                    arrBots[i].container.position.set(kv[0] * S, kv[1] * H + H_BOT, kv[2] * S)\r\n                    arrBots[i].setCollisionMesh(assets.collisionsBotsRooms['collision_r_01'].clone())\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (isRemoveBot) {\r\n            for (let i = 0; i < arrBots.length; ++i) {\r\n                if (arrBots[i].inScene === objKey) {\r\n                    arrBots[i].inScene = null\r\n                    arrBots[i].container.position.y = -10000\r\n                    arrBots[i].removeCollisionMesh()\r\n                }\r\n            } \r\n        }\r\n    })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    emitter.subscribe('playerMove')(pos => {\r\n        for (let i = 0; i < arrBots.length; ++i) {\r\n            if (!arrBots[i].inScene) continue;\r\n\r\n            const botWorldPos = new THREE.Vector3()\r\n            arrBots[i]._modelGroup.getWorldPosition(botWorldPos)\r\n            const distance = botWorldPos.distanceTo(pos)\r\n\r\n\r\n            if (arrBots[i]._state === 'say' && distance > 30) {\r\n                arrBots[i]._startRotate()\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(false)\r\n                continue;\r\n            }\r\n\r\n\r\n            if (arrBots[i]._state !== 'say' && distance < 30) {\r\n                arrBots[i].prepareToSay(pos)\r\n                toggleDialog(pr.dispatch).toggleButtonDialog(true)\r\n                continue;\r\n            }\r\n        }\r\n    })\r\n\r\n\r\n    return {\r\n        groupBots,\r\n    } \r\n}\r\n\r\n\r\n","import { createStore , applyMiddleware, compose} from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { combineReducers } from 'redux'\r\nimport { FLOORS_CONF } from '../constants/constants_elements'\r\n\r\n\r\n\r\n\r\n\r\nconst DIALOGS_DATA = [\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Привет !',\r\n                a: 'День добрый, кремниевая форма жизни.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Что это за место?',\r\n                a: 'Это вход в энтропийный гипер-лабиринт.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Что будет, если я войду в него?',\r\n                a: 'Лабиринт ждет.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Куда ведут эти коридоры ?',\r\n                a: 'Они приведут тебя к финалу.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Я пошел дальше.',\r\n                a: 'Мы еще увидимся.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n    ]\r\n}, {\r\n\r\n\r\n\r\n    phrases: [\r\n        {\r\n            q: 'Что ты здесь делаешь ?',\r\n            a: 'Собираю энергию ночи.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n        {\r\n            q: 'В какую сторону мне идти ?',\r\n            a: 'Здесь нет сторон. Здесь важна только длина пути.',\r\n            event: 'close',\r\n            //levelEvent: null,\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Я уже долго иду.',\r\n            a: 'Ты прошел достаточно для этого уровня.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },{\r\n            q: 'Что это значит?',\r\n            a: 'Тебе открыт путь на одну ступень выше.',\r\n            event: 'close',\r\n            levelEvent: 'addStairs',\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n// %%%%%%%%%%%%%%%%%%%%%%% 22222222222222222 %%%%%%%%%%%%%%%%%%%%\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Я ищу финал.',\r\n            a: 'Я помню о твоем пути.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        }, {\r\n            q: 'Вы все так похожи.',\r\n            a: 'Мы еще встретимся.',\r\n            event: 'close',\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Это снова ты?',\r\n                a: 'Да, мы все едины.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Тут все коридоры повторяются.',\r\n                a: 'Суть всего в едином.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как долго еще идти.',\r\n                a: 'Тебе будет знак, когда ты будешь готов.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            }, {\r\n                q: 'Как я узнаю этот знак.',\r\n                a: 'Я подам его.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Это одинаковый сегмент коридора с тобой.',\r\n                a: 'Ты готов к новому уровню.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n// %%%%%%%%%%%%%%%%%%%%% 33333333 %%%%%%%%%%%%%%%%%%%%%%\r\n\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Привет снова. Как выбраться. Уже надоело.',\r\n            a: 'Ты не постиг дзен.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n        {\r\n            q: 'Ты-то как выходишь на поверхность?',\r\n            a: 'У меня свой путь.',\r\n            event: 'close',\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ты все на своем пути?',\r\n                a: 'Как и ты.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Как долго ты на нем?',\r\n                a: 'Эти стены нас слышат.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Мне кажется, ты идешь в нагрузку к этому сегменту коридора.',\r\n                a: 'Тебе открыт следующий уровень.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n\r\n\r\n\r\n\r\n// %%%%%%%%%%%%%%%%%%%%% 444444444444444 %%%%%%%%%%%%%%\r\n\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Ничего не меняется.',\r\n            a: 'Меняется количество пройденных шагов.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n        {\r\n            q: 'Это место считает шаги?',\r\n            a: 'Это место ждет.',\r\n            event: 'close',\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как давно ты здесь?',\r\n                a: 'Время не имеет значения, значение имеет лишь путь.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Но ты же не идешь.',\r\n                a: 'Зато ты каждый раз проходишь мимо.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Сделай новый уровень.',\r\n                a: 'Ты готов - новый уровень ждет тебя.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n// %%%%%%%%%%%%%%%%%% 5555555 %%%%%%%%%%%%%%%%%%%\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Ты и есть это место. Ты управляешь сегментами.',\r\n            a: 'Ты почти дошел до края.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n        {\r\n            q: 'Зачем тебе это?',\r\n            a: 'Это способ свернуть пространство. Больше движения. Больше сегментов.',\r\n            event: 'close',\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Как много путников попадало сюда?',\r\n                a: 'Многие из них до сих пор тут.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Почему я их не встретил?',\r\n                a: 'У каждого своя система сегментов.',\r\n                event: 'close',\r\n                levelEvent: null,\r\n            },\r\n        ]\r\n    },\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Ты выпустишь меня?',\r\n                a: 'Все стороны света открыты тебе.',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Я хочу встретить других.',\r\n                a: 'Тебе открыт новый уровень.',\r\n                event: 'close',\r\n                levelEvent: 'addStairs',\r\n            },\r\n        ]\r\n    },\r\n\r\n// %%%%%%%%%%%%%%%%%%% 6666666666666666 %%%%%%%%%%%%%%%%%%\r\n\r\n\r\n{\r\n    phrases: [\r\n        {\r\n            q: 'Я вижу зарево?',\r\n            a: 'Это зарево просветления. Ты близок',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n        {\r\n            q: 'Все коридоры повторяются.',\r\n            a: 'Все повторяется с небольшой разницей.',\r\n            event: 'nextReply',\r\n            levelEvent: null,\r\n        },\r\n    ]\r\n},\r\n\r\n\r\n\r\n    {\r\n        phrases: [\r\n            {\r\n                q: 'Все мой путь окончен.',\r\n                a: 'Ты отказываешься идти?',\r\n                event: 'nextReply',\r\n                levelEvent: null,\r\n            },\r\n            {\r\n                q: 'Да, ты безумен.',\r\n                a: 'Я освобождаю тебя.',\r\n                event: 'close',\r\n                levelEvent: 'addWell',\r\n            },\r\n        ]\r\n    }\r\n]\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst appData = {\r\n    sceneEnvironment: {\r\n        color: FLOORS_CONF['-1']['start'].color,\r\n        fogNear: FLOORS_CONF['-1']['start'].fogNear,\r\n        fogFar: FLOORS_CONF['-1']['start'].fogFar,\r\n        //backgroundImgKey: 'skyBox',\r\n    },\r\n\r\n    // sceneEnvironment: {\r\n    //     color: FLOORS_CONF['-1']['outer'].color,\r\n    //     fogNear: FLOORS_CONF['-1']['outer'].fogNear,\r\n    //     fogFar: FLOORS_CONF['-1']['outer'].fogFar,\r\n    //     backgroundImgKey: 'skyBox',\r\n    // },\r\n\r\n    playerQuadrant: {\r\n        oldQuadrant: [0, 0, 0],\r\n        newQuadrant: [0, 0, 0],\r\n        counter: null,\r\n    },\r\n\r\n    level: {\r\n        isStartCorridorShow: true,\r\n    },\r\n\r\n    ui: {\r\n        isShowButtFullScreen: true,\r\n        isShowInfo: false,\r\n        isShowFinalMessage: false,\r\n        botAnswers: [],\r\n        userReplicies: [],\r\n        history: [],\r\n        isDialog: false,\r\n        isButtonDialog: false,\r\n    },\r\n\r\n    botIndex: -1,\r\n    phraseIndex: 0,\r\n    phrasesData: DIALOGS_DATA,\r\n    isCanChangeBotIndex: true,\r\n    isCanChangeBotCounter: 0,\r\n}\r\n\r\n\r\n\r\nconst app = function(state = appData, action) {\r\n    if (action.type === 'CLICK_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'EXIT_FULL_SCREEN') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowButtFullScreen: true,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'INFO_TOGGLE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: false,\r\n                isShowInfo: action.mode,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'TOGGLE_FINAL_MESSAGE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isShowFinalMessage: action.mode,\r\n                isShowInfo: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_ENVIRONMENT') {\r\n        const { newQuadrant, environmentMode } = action\r\n\r\n        if (!FLOORS_CONF[newQuadrant[1]]) return state;\r\n\r\n        const { fogNear, fogFar, color, backgroundImgKey } = FLOORS_CONF[newQuadrant[1]][environmentMode]\r\n\r\n        return ({\r\n            ...state,\r\n            sceneEnvironment: {\r\n                fogNear,\r\n                fogFar,\r\n                color,\r\n                backgroundImgKey,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    if (action.type === 'CHANGE_QUADRANT') {\r\n\r\n        let isCanChangeBotCounter = state.isCanChangeBotCounter + 1;\r\n        let isCanChangeBotIndex = state.isCanChangeBotIndex\r\n        if (isCanChangeBotCounter > 2) {\r\n            isCanChangeBotIndex = true\r\n            isCanChangeBotCounter = 0\r\n        }\r\n\r\n        return ({\r\n            ...state,\r\n            playerQuadrant: {\r\n                ...action,\r\n            },\r\n            isCanChangeBotIndex,\r\n            isCanChangeBotCounter,\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'DESTROY_START_CORRIDOR') {\r\n        return ({\r\n            ...state,\r\n            level: {\r\n                ...state.level,\r\n                isStartCorridorShow: false,\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n\r\n    if (action.type === 'CLICK_PHRASE') {\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                botAnswers: [\r\n                    ...state.ui.botAnswers,\r\n                    action.phrase,\r\n                ],\r\n                userReplicies: [],\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'PHRASE_EVENT') {\r\n        const { event } = action.phrase\r\n\r\n        if (event === 'nextReply') {\r\n            const botPhrases = state.phrasesData[state.botIndex]\r\n            const userReplicies = [botPhrases.phrases[state.phraseIndex + 1]]\r\n\r\n            return ({\r\n                ...state,\r\n                phraseIndex: state.phraseIndex + 1,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies,\r\n                }\r\n            })\r\n\r\n        }\r\n\r\n        if (event === 'close') {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    userReplicies: [],\r\n                    isButtonDialog: true,\r\n                },\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'CHANGE_BOT') {\r\n        return ({\r\n            ...state,\r\n            isCanChangeBotIndex: true,\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n    if (action.type === 'TOGGLE_DIALOG') {\r\n        //////////////////////////////////////////// TODO: UNCOMMENT\r\n        if (!state.isCanChangeBotIndex) {\r\n            return ({\r\n                ...state,\r\n                ui: {\r\n                    ...state.ui,\r\n                    isDialog: action.isDialog,\r\n                    isButtonDialog: true,\r\n                },\r\n\r\n            })\r\n        }\r\n        const phraseIndex = state.isCanChangeBotIndex ? 0 : state.phraseIndex\r\n        const botIndex = state.isCanChangeBotIndex ? state.botIndex + 1 : state.botIndex\r\n        const isButtonDialog = false\r\n        /////////////////////////////////////////////////////\r\n\r\n\r\n        ///////////////////////////////////////////// TODO: REMOVE\r\n        // let botIndex = state.botIndex\r\n        // let phraseIndex = state.phraseIndex\r\n        // if (action.isDialog) {\r\n        //     botIndex = state.botIndex + 1\r\n        //     phraseIndex = 0\r\n        // }\r\n        // const isButtonDialog = !action.isDialog\r\n        // /////////////////////////////////////////////////\r\n\r\n\r\n        const userReplicies = state.phrasesData[botIndex] ? [state.phrasesData[botIndex].phrases[phraseIndex]] : []\r\n\r\n        return ({\r\n            ...state,\r\n\r\n            ui: {\r\n                ...state.ui,\r\n                userReplicies,\r\n                botAnswers: [],\r\n                isDialog: action.isDialog,\r\n                isButtonDialog,\r\n            },\r\n\r\n            isCanChangeBotIndex: false,\r\n            botIndex,\r\n            phraseIndex,\r\n        })\r\n    }\r\n\r\n    if (action.type === 'TOGGLE_BUTTON') {\r\n\r\n        return ({\r\n            ...state,\r\n            ui: {\r\n                ...state.ui,\r\n                isDialog: false,\r\n                isButtonDialog: action.isButtonDialog,\r\n            },\r\n        })\r\n    }\r\n\r\n\r\n    return state\r\n}\r\n\r\n\r\n\r\nconst rootReducer = combineReducers({ app })\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\nexport const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n\r\n","import { createDeviceResizer } from './helpers/util_deviceResizer'\r\nimport { KeyBoard } from './helpers/util_keyBoard'\r\nimport { emitter } from './helpers/util_emitter'\r\nimport { createFrameUpdater } from './helpers/util_frameUpater'\r\nimport { createActionByChangedQuadrant } from './store/actionByChangeQuadrant'\r\nimport { startPlay } from './store/actions'\r\nimport { pr } from './componentsReact/App'\r\n\r\nimport { ASSETS_TO_LOAD } from './constants/constants_elements'\r\n\r\nimport { loadAssets } from './helpers/utils_loadAssets'\r\nimport { prepareMeshesFromAssets } from './helpers/helper_prepareMeshesFromAssets'\r\n\r\nimport { createStudio } from './entities/createStudio'\r\nimport { createPlayer } from './entities/createPlayer'\r\n\r\n\r\nimport { showStartButton } from './systems/systemHtml_intro'\r\nimport { createInfo } from './systems/systemHtml_info'\r\nimport { createLevel } from './systems/system_level'\r\nimport { createSystemBots } from './systems/system_bots'\r\n\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { FRAME_UPDATE } from './constants/constants_elements'\r\n\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './componentsReact/App';\r\nimport { Provider } from 'react-redux'\r\nimport { store } from './store/createStore'\r\n\r\n\r\n  \r\n\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <App />\r\n    </Provider>,\r\n    document.getElementById('root')\r\n)\r\n\r\n\r\n\r\n\r\n\r\ncreateDeviceResizer(emitter)\r\n\r\n\r\nconst init = assets => {\r\n    createFrameUpdater(emitter)\r\n    emitter.subscribe(FRAME_UPDATE)(() => TWEEN.update())\r\n\r\n    const studio = createStudio(emitter, assets, store)\r\n\r\n    /** player */\r\n    new KeyBoard(emitter)\r\n    const player = createPlayer(emitter)\r\n    studio.setCamera(player.getCamera())\r\n    studio.addToScene(player.getObj())\r\n\r\n    /** prepare assets */\r\n    const { allMeshes,  rooms, materials } = prepareMeshesFromAssets(assets)\r\n\r\n    /** level */\r\n    const { group } = createLevel(emitter, rooms, allMeshes, store)\r\n    studio.addToScene(group)\r\n\r\n    /** bots */\r\n    const systemBots = createSystemBots(assets, materials, emitter, store)\r\n    studio.addToScene(systemBots.groupBots)\r\n\r\n\r\n    createActionByChangedQuadrant()\r\n    \r\n    setTimeout(() => player.start(), 500)\r\n\r\n\r\n    /** UI */\r\n    createInfo(emitter)\r\n    showStartButton(emitter)\r\n    emitter.subscribe('setLanguage')(() => {\r\n        setTimeout(startPlay(pr.dispatch).startPlay, 1000)\r\n        setTimeout(startPlay(pr.dispatch).showBackground, 3000)\r\n    })\r\n}\r\n\r\n\r\n\r\nwindow.addEventListener('load', () => loadAssets(ASSETS_TO_LOAD).then(init))\r\n","import { pr } from '../componentsReact/App'\r\nimport { clickFullScreen } from '../store/actions'\r\n\r\n\r\n\r\nconst MAX_W = 400\r\nconst MIN_W = 350\r\n\r\n\r\n\r\nexport function createDeviceResizer (emitter) {\r\n\r\n    const appWrapper = document.querySelector('.app-wrapper')\r\n    emitter.subscribe('mouseDown')(key => {\r\n        if (key === 'butt-fullscreen') openAppFullScreenIfMobile()\r\n    })\r\n\r\n    /** fullscreen */\r\n    const openAppFullScreenIfMobile = () => {\r\n\r\n\r\n        if (appWrapper.requestFullscreen) {\r\n            appWrapper.requestFullscreen()\r\n        } else if (appWrapper.mozRequestFullScreen) {\r\n            appWrapper.mozRequestFullScreen()\r\n        } else if (appWrapper.webkitRequestFullscreen) {\r\n            appWrapper.webkitRequestFullscreen()\r\n        } else if (appWrapper.msRequestFullscreen) {\r\n            appWrapper.msRequestFullscreen()\r\n        }\r\n    }\r\n\r\n    /** resize */\r\n    const resize = e => {\r\n        appWrapper.style.width = window.innerWidth + 'px'\r\n        appWrapper.style.height = window.innerHeight + 'px'\r\n        appWrapper.style.fontSize = Math.max(Math.min(Math.min(window.innerWidth, window.innerHeight), MAX_W), MIN_W) / 50 + 'px'\r\n\r\n        if (!document.fullscreenElement) {\r\n            clickFullScreen(pr.dispatch).exitFullScreen()\r\n        }\r\n\r\n    }\r\n\r\n\r\n    window.addEventListener('resize', resize)\r\n    resize()\r\n}\r\n\r\n\r\n\r\nconst checkTouch = () => \r\n    navigator.maxTouchPoints || 'ontouchstart' in document.documentElement\r\n\r\n\r\n\r\nconst checkIsCanOrientation = () => \r\n    typeof window.orientation !== 'undefined'\r\n\r\n","import * as R from 'ramda'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\n\r\n\r\n\r\nexport function createFrameUpdater (eventEmitter) {\r\n\r\n    const emitFrameUpdate = eventEmitter.emit(FRAME_UPDATE)\r\n\r\n    let data = {\r\n        time: 0,\r\n        delta: 0,\r\n        count: 0,\r\n        oldTime: 0\r\n    }\r\n\r\n    const getDataFromGlobalVar = () => data\r\n\r\n    const updateTime = data => { \r\n        data.time = Date.now()\r\n        return data\r\n    }\r\n\r\n    const updateDelta = data => { \r\n        data.delta = (data.time - data.oldTime) * 0.001\r\n        if (isNaN(data.delta) || data.delta > 1000 || data.delta == 0 ) {\r\n            data.delta = 1000/60 * 0.001;\r\n        }\r\n        return data\r\n    }\r\n\r\n    const updateCount = data => { \r\n        data.count = data.delta / (1/60)\r\n        return data\r\n    }\r\n\r\n    const emit = data => { \r\n        emitFrameUpdate(data)\r\n        return data\r\n    }\r\n\r\n    const updateOldTime = data => { \r\n        data.oldTime = data.time\r\n        return data\r\n    }\r\n\r\n    const saveDataInGlobalVar = dataFromChine => {\r\n        data = dataFromChine\r\n        return data\r\n    }\r\n\r\n    const logger = data => {\r\n        console.log(data)\r\n        return data\r\n    } \r\n\r\n    const update = R.pipe(\r\n        getDataFromGlobalVar,\r\n        updateTime,\r\n        updateDelta,\r\n        updateCount, \r\n        emit, \r\n        updateOldTime, \r\n        saveDataInGlobalVar\r\n    )\r\n\r\n    const animate = () => {\r\n        requestAnimationFrame(animate)\r\n        update(data)\r\n    }\r\n\r\n    animate() \r\n}\r\n\r\n","import * as THREE from 'three'\r\nimport * as TWEEN from '@tweenjs/tween.js'\r\nimport { studioConfig } from '../constants/constants_elements'\r\nimport { FRAME_UPDATE } from '../constants/constants_elements'\r\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js'\r\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js'\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js'\r\nimport { Saturate } from '../shaders/saturate'\r\n\r\n\r\n\r\n\r\n\r\nexport function createStudio (emitter, assets, store) {\r\n    const { canId, rendererCon, clearColor, fogData, amb } = studioConfig\r\n\r\n    const canvas = document.getElementById(canId)\r\n    rendererCon.canvas = canvas\r\n\r\n    const renderer = new THREE.WebGLRenderer(rendererCon)\r\n    renderer.setClearColor(clearColor)\r\n    renderer.setPixelRatio(window.devicePixelRatio)\r\n    renderer.setSize(window.innerWidth, window.innerHeight)\r\n\r\n    const scene = new THREE.Scene()\r\n\r\n    {\r\n        const { color, fogNear, fogFar, backgroundImgKey } = store.getState().app.sceneEnvironment\r\n        scene.background = assets[backgroundImgKey] || null\r\n        scene.fog = new THREE.Fog(color, fogNear, fogFar)\r\n    }\r\n\r\n\r\n    let lightA\r\n    {\r\n        const { color, strength } = amb\r\n        lightA = new THREE.AmbientLight( color, strength )\r\n        scene.add( lightA )\r\n    }\r\n\r\n    let camera = null\r\n\r\n\r\n    const composer = new EffectComposer(renderer)\r\n    //composer.addPass(new RenderPass(scene, camera))\r\n\r\n\r\n\r\n    const resize = () => {\r\n        const size = { width: window.innerWidth, height: window.innerHeight }\r\n        renderer.setSize(size.width, size.height)\r\n        composer.setSize(size.width, size.height)\r\n        if (camera) {\r\n            camera.aspect = size.width/size.height\r\n            camera.updateProjectionMatrix()\r\n        }\r\n    }\r\n    window.addEventListener('resize', resize)\r\n    resize()\r\n\r\n\r\n\r\n\r\n    const addToScene = scene.add.bind(scene)\r\n    //const drawFrame = () => camera && renderer.render(scene, camera)\r\n    const drawFrame = () => camera && composer.render(scene, camera)\r\n    emitter.subscribe(FRAME_UPDATE)(drawFrame)\r\n\r\n\r\n\r\n    \r\n\r\n    let\r\n        oldFogNear = scene.fog.near,\r\n        oldFogFar = scene.fog.far,\r\n        oldColor = scene.fog.color,\r\n        oldBackgroundImgKey = store.getState().app.sceneEnvironment.backgroundImgKey\r\n\r\n\r\n\r\n\r\n    store.subscribe(() => {\r\n        const newState = store.getState()\r\n        const { fogNear, fogFar, color, backgroundImgKey } = newState.app.sceneEnvironment\r\n\r\n        if (fogNear !== oldFogNear || fogFar !== oldFogFar || color !== oldColor ) {\r\n            let startData = {\r\n                color: scene.fog.color,\r\n                near: scene.fog.near,\r\n                far: scene.fog.far,\r\n            }\r\n            let endData = {\r\n                color: new THREE.Color(color),\r\n                near: fogNear,\r\n                far: fogFar,\r\n            }\r\n\r\n            oldFogNear = fogNear\r\n            oldFogFar = fogFar\r\n            oldColor = color\r\n\r\n            new TWEEN.Tween(startData)\r\n                .to(endData, 3000)\r\n                .onUpdate(() => {\r\n                    scene.fog.color = startData.color\r\n                    scene.fog.near = startData.near\r\n                    scene.fog.far = startData.far\r\n                    lightA.color = startData.color\r\n                    renderer.setClearColor(startData.color)\r\n                })\r\n                .start()\r\n        }\r\n\r\n\r\n        if (backgroundImgKey !== oldBackgroundImgKey) {\r\n            oldBackgroundImgKey = backgroundImgKey\r\n            scene.background = assets[backgroundImgKey] || null\r\n        }\r\n    })\r\n\r\n\r\n\r\n    return {\r\n        setCamera: cam => {\r\n\r\n            camera = cam\r\n            composer.addPass(new RenderPass(scene, cam))\r\n            composer.addPass(new ShaderPass(Saturate))\r\n\r\n        },\r\n        addToScene,\r\n    }\r\n}\r\n\r\n","import { t } from '../helpers/util_translate'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function createInfo () {\r\n    const cont = document.createElement('div')\r\n    cont.style.display = 'none'\r\n    cont.classList.add('info-cont')\r\n\r\n    const wrapper = document.createElement('div')\r\n    wrapper.classList.add('info-wrap')\r\n    cont.appendChild(wrapper)\r\n\r\n    const mess = document.createElement('div')\r\n    const createInnerMess = () => {\r\n        mess.innerHTML = t('Previous part \"Factory\": ')\r\n        mess.innerHTML += `<a href=\\'http://js.otrisovano.ru${ t('/bridge') }\\' target=\"blanck\">${ t('link') }</a></br>`\r\n        mess.innerHTML += t('Author: ')\r\n        mess.innerHTML += `<a href=\\'http://otrisovano.ru\\' target=\"blanck\">${ t('link') }</a></br>`\r\n        mess.innerHTML += t('Github: ')\r\n        mess.innerHTML += `<a href=\\'https://github.com/fire888/levels\\' target=\"blanck\">${ t('link') }</a></br>`\r\n    }\r\n    createInnerMess()\r\n    wrapper.appendChild(mess)\r\n\r\n    const closeButt = document.createElement('button')\r\n    closeButt.classList.add('control')\r\n    closeButt.innerText = 'x'\r\n    closeButt.addEventListener('click', () => {\r\n        cont.style.display = 'none'\r\n    })\r\n    wrapper.appendChild(closeButt)\r\n    document.querySelector('.butt-info').addEventListener('click', () => {\r\n        cont.style.display = 'flex'\r\n    })\r\n\r\n    document.querySelector('.app-wrapper').appendChild(cont)\r\n}\r\n\r\n\r\n\r\n"],"sourceRoot":""}